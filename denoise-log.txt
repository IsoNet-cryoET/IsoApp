Command: isonet.py denoise --star_file tomograms.star --output_dir denoise --gpuID 1,2 --ncpus 16 --arch unet-medium --pretrained_model None --pretrained_model2 None --cube_size 96 --epochs 4 --input_column rlnTomoReconstructedTomogramHalf --batch_size None --acc_batches 1 --loss_func L2 --learning_rate 0.0003 --T_max 2 --learning_rate_min 0.0003 --compile_model False --mixed_precision True --CTF_mode None --isCTFflipped False --with_predict True --split_halves False --snrfalloff 0 --deconvstrength 1 --highpassnyquist 0.02
07-18 19:08:29, INFO     Port number: 59847
Total number of parameters: 23989825
Preprocess tomograms:   0%|                                                   | 0/5 [00:00<?, ?it/s]Preprocess tomograms:  20%|████████▌                                  | 1/5 [00:00<00:01,  2.34it/s]Preprocess tomograms:  40%|█████████████████▏                         | 2/5 [00:00<00:01,  2.52it/s]Preprocess tomograms:  60%|█████████████████████████▊                 | 3/5 [00:01<00:00,  2.58it/s]Preprocess tomograms:  80%|██████████████████████████████████▍        | 4/5 [00:01<00:00,  2.60it/s]Preprocess tomograms: 100%|███████████████████████████████████████████| 5/5 [00:01<00:00,  2.57it/s]Preprocess tomograms: 100%|███████████████████████████████████████████| 5/5 [00:01<00:00,  2.56it/s]
training tomograms for 2 epochs, remaining epochs 4
Epoch 1:   0%|                                       | 0/13 [00:00<?, ?batch/s]Epoch 1:   0%| | 0/13 [00:19<?, ?batch/s, Loss: 1.6821 | in_mw_loss: 1.6821 | oEpoch 1:   8%| | 1/13 [00:19<03:50, 19.23s/batch, Loss: 1.6821 | in_mw_loss: 1.Epoch 1:   8%| | 1/13 [00:19<03:50, 19.23s/batch, Loss: 1.6087 | in_mw_loss: 1.Epoch 1:  15%|▏| 2/13 [00:19<01:28,  8.02s/batch, Loss: 1.6087 | in_mw_loss: 1.Epoch 1:  15%|▏| 2/13 [00:19<01:28,  8.02s/batch, Loss: 1.3491 | in_mw_loss: 1.Epoch 1:  23%|▏| 3/13 [00:19<00:44,  4.42s/batch, Loss: 1.3491 | in_mw_loss: 1.Epoch 1:  23%|▏| 3/13 [00:19<00:44,  4.42s/batch, Loss: 1.2650 | in_mw_loss: 1.Epoch 1:  31%|▎| 4/13 [00:19<00:24,  2.74s/batch, Loss: 1.2650 | in_mw_loss: 1.Epoch 1:  31%|▎| 4/13 [00:20<00:24,  2.74s/batch, Loss: 1.2480 | in_mw_loss: 1.Epoch 1:  38%|▍| 5/13 [00:20<00:14,  1.87s/batch, Loss: 1.2480 | in_mw_loss: 1.Epoch 1:  38%|▍| 5/13 [00:20<00:14,  1.87s/batch, Loss: 1.1623 | in_mw_loss: 1.Epoch 1:  46%|▍| 6/13 [00:20<00:08,  1.28s/batch, Loss: 1.1623 | in_mw_loss: 1.Epoch 1:  46%|▍| 6/13 [00:20<00:08,  1.28s/batch, Loss: 1.1673 | in_mw_loss: 1.Epoch 1:  54%|▌| 7/13 [00:20<00:05,  1.09batch/s, Loss: 1.1673 | in_mw_loss: 1.Epoch 1:  54%|▌| 7/13 [00:20<00:05,  1.09batch/s, Loss: 1.1890 | in_mw_loss: 1.Epoch 1:  62%|▌| 8/13 [00:20<00:03,  1.49batch/s, Loss: 1.1890 | in_mw_loss: 1.Epoch 1:  62%|▌| 8/13 [00:20<00:03,  1.49batch/s, Loss: 1.1462 | in_mw_loss: 1.Epoch 1:  69%|▋| 9/13 [00:20<00:02,  1.99batch/s, Loss: 1.1462 | in_mw_loss: 1.Epoch 1:  69%|▋| 9/13 [00:20<00:02,  1.99batch/s, Loss: 1.1352 | in_mw_loss: 1.Epoch 1:  77%|▊| 10/13 [00:20<00:01,  2.35batch/s, Loss: 1.1352 | in_mw_loss: 1Epoch 1:  77%|▊| 10/13 [00:21<00:01,  2.35batch/s, Loss: 1.1548 | in_mw_loss: 1Epoch 1:  85%|▊| 11/13 [00:21<00:00,  2.69batch/s, Loss: 1.1548 | in_mw_loss: 1Epoch 1:  85%|▊| 11/13 [00:21<00:00,  2.69batch/s, Loss: 1.0121 | in_mw_loss: 1Epoch 1:  92%|▉| 12/13 [00:21<00:00,  3.26batch/s, Loss: 1.0121 | in_mw_loss: 1Epoch 1:  92%|▉| 12/13 [00:21<00:00,  3.26batch/s, Loss: 1.0873 | in_mw_loss: 1Epoch 1: 100%|█| 13/13 [00:21<00:00,  3.98batch/s, Loss: 1.0873 | in_mw_loss: 1Epoch 1: 100%|█| 13/13 [00:21<00:00,  1.65s/batch, Loss: 1.0873 | in_mw_loss: 1
Epoch [  1/  2], Loss: 1.2576, in_mw_loss: 1.2576, out_mw_loss: 1.2576, learning_rate: 3.0000e-04
Epoch 2:   0%|                                       | 0/13 [00:00<?, ?batch/s]Epoch 2:   0%| | 0/13 [00:00<?, ?batch/s, Loss: 1.1227 | in_mw_loss: 1.1227 | oEpoch 2:   8%| | 1/13 [00:00<00:04,  2.95batch/s, Loss: 1.1227 | in_mw_loss: 1.Epoch 2:   8%| | 1/13 [00:00<00:04,  2.95batch/s, Loss: 1.0188 | in_mw_loss: 1.Epoch 2:  15%|▏| 2/13 [00:00<00:02,  4.50batch/s, Loss: 1.0188 | in_mw_loss: 1.Epoch 2:  15%|▏| 2/13 [00:00<00:02,  4.50batch/s, Loss: 1.1824 | in_mw_loss: 1.Epoch 2:  23%|▏| 3/13 [00:00<00:01,  5.29batch/s, Loss: 1.1824 | in_mw_loss: 1.Epoch 2:  23%|▏| 3/13 [00:00<00:01,  5.29batch/s, Loss: 1.0552 | in_mw_loss: 1.Epoch 2:  31%|▎| 4/13 [00:00<00:01,  5.76batch/s, Loss: 1.0552 | in_mw_loss: 1.Epoch 2:  31%|▎| 4/13 [00:01<00:01,  5.76batch/s, Loss: 1.0461 | in_mw_loss: 1.Epoch 2:  38%|▍| 5/13 [00:01<00:01,  4.71batch/s, Loss: 1.0461 | in_mw_loss: 1.Epoch 2:  38%|▍| 5/13 [00:01<00:01,  4.71batch/s, Loss: 1.1032 | in_mw_loss: 1.Epoch 2:  46%|▍| 6/13 [00:01<00:01,  4.66batch/s, Loss: 1.1032 | in_mw_loss: 1.Epoch 2:  46%|▍| 6/13 [00:01<00:01,  4.66batch/s, Loss: 1.0704 | in_mw_loss: 1.Epoch 2:  54%|▌| 7/13 [00:01<00:01,  5.21batch/s, Loss: 1.0704 | in_mw_loss: 1.Epoch 2:  54%|▌| 7/13 [00:01<00:01,  5.21batch/s, Loss: 1.0633 | in_mw_loss: 1.Epoch 2:  62%|▌| 8/13 [00:01<00:00,  5.63batch/s, Loss: 1.0633 | in_mw_loss: 1.Epoch 2:  62%|▌| 8/13 [00:01<00:00,  5.63batch/s, Loss: 0.9925 | in_mw_loss: 0.Epoch 2:  69%|▋| 9/13 [00:01<00:00,  6.11batch/s, Loss: 0.9925 | in_mw_loss: 0.Epoch 2:  69%|▋| 9/13 [00:01<00:00,  6.11batch/s, Loss: 1.0659 | in_mw_loss: 1.Epoch 2:  77%|▊| 10/13 [00:01<00:00,  4.91batch/s, Loss: 1.0659 | in_mw_loss: 1Epoch 2:  77%|▊| 10/13 [00:02<00:00,  4.91batch/s, Loss: 1.0431 | in_mw_loss: 1Epoch 2:  85%|▊| 11/13 [00:02<00:00,  5.00batch/s, Loss: 1.0431 | in_mw_loss: 1Epoch 2:  85%|▊| 11/13 [00:02<00:00,  5.00batch/s, Loss: 1.1292 | in_mw_loss: 1Epoch 2:  92%|▉| 12/13 [00:02<00:00,  5.33batch/s, Loss: 1.1292 | in_mw_loss: 1Epoch 2:  92%|▉| 12/13 [00:02<00:00,  5.33batch/s, Loss: 1.0162 | in_mw_loss: 1Epoch 2: 100%|█| 13/13 [00:02<00:00,  5.33batch/s, Loss: 1.0162 | in_mw_loss: 1
Epoch [  2/  2], Loss: 1.0534, in_mw_loss: 1.0534, out_mw_loss: 1.0534, learning_rate: 3.0000e-04
data_shape torch.Size([320, 1, 96, 96, 96])
predict:   0%|                                         | 0/160 [00:00<?, ?it/s]predict:   1%|▏                                | 1/160 [00:00<00:27,  5.78it/s]predict:   3%|█                                | 5/160 [00:00<00:08, 19.09it/s]predict:   6%|█▊                               | 9/160 [00:00<00:06, 24.86it/s]predict:   8%|██▍                             | 12/160 [00:00<00:05, 25.32it/s]predict:   9%|███                             | 15/160 [00:00<00:06, 22.23it/s]predict:  11%|███▌                            | 18/160 [00:00<00:06, 20.67it/s]predict:  13%|████▏                           | 21/160 [00:00<00:06, 22.40it/s]predict:  16%|█████                           | 25/160 [00:01<00:05, 26.56it/s]predict:  18%|█████▊                          | 29/160 [00:01<00:04, 29.51it/s]predict:  21%|██████▌                         | 33/160 [00:01<00:04, 31.62it/s]predict:  23%|███████▍                        | 37/160 [00:01<00:04, 30.05it/s]predict:  26%|████████▏                       | 41/160 [00:01<00:04, 24.39it/s]predict:  28%|█████████                       | 45/160 [00:01<00:04, 26.96it/s]predict:  30%|█████████▌                      | 48/160 [00:01<00:04, 26.23it/s]predict:  32%|██████████▍                     | 52/160 [00:02<00:03, 28.48it/s]predict:  35%|███████████▏                    | 56/160 [00:02<00:03, 27.71it/s]predict:  37%|███████████▊                    | 59/160 [00:02<00:04, 24.18it/s]predict:  39%|████████████▍                   | 62/160 [00:02<00:04, 21.93it/s]predict:  41%|█████████████▏                  | 66/160 [00:02<00:03, 24.74it/s]predict:  44%|██████████████                  | 70/160 [00:02<00:03, 27.77it/s]predict:  46%|██████████████▊                 | 74/160 [00:02<00:02, 30.24it/s]predict:  49%|███████████████▌                | 78/160 [00:02<00:02, 31.68it/s]predict:  51%|████████████████▍               | 82/160 [00:03<00:02, 27.45it/s]predict:  53%|█████████████████               | 85/160 [00:03<00:03, 24.00it/s]predict:  56%|█████████████████▊              | 89/160 [00:03<00:02, 26.83it/s]predict:  57%|██████████████████▍             | 92/160 [00:03<00:02, 26.08it/s]predict:  60%|███████████████████▏            | 96/160 [00:03<00:02, 28.34it/s]predict:  62%|███████████████████▍           | 100/160 [00:03<00:02, 29.49it/s]predict:  65%|████████████████████▏          | 104/160 [00:04<00:02, 24.47it/s]predict:  67%|████████████████████▋          | 107/160 [00:04<00:02, 22.35it/s]predict:  69%|█████████████████████▎         | 110/160 [00:04<00:02, 23.46it/s]predict:  71%|██████████████████████         | 114/160 [00:04<00:01, 26.68it/s]predict:  74%|██████████████████████▊        | 118/160 [00:04<00:01, 29.44it/s]predict:  76%|███████████████████████▋       | 122/160 [00:04<00:01, 31.53it/s]predict:  79%|████████████████████████▍      | 126/160 [00:04<00:01, 29.86it/s]predict:  81%|█████████████████████████▏     | 130/160 [00:05<00:01, 24.38it/s]predict:  84%|█████████████████████████▉     | 134/160 [00:05<00:00, 27.14it/s]predict:  86%|██████████████████████████▌    | 137/160 [00:05<00:00, 26.23it/s]predict:  88%|███████████████████████████▎   | 141/160 [00:05<00:00, 28.53it/s]predict:  91%|████████████████████████████   | 145/160 [00:05<00:00, 30.08it/s]predict:  93%|████████████████████████████▊  | 149/160 [00:05<00:00, 25.98it/s]predict:  95%|█████████████████████████████▍ | 152/160 [00:05<00:00, 22.98it/s]predict:  97%|██████████████████████████████ | 155/160 [00:05<00:00, 23.58it/s]predict:  99%|██████████████████████████████▊| 159/160 [00:06<00:00, 26.49it/s]predict: 100%|███████████████████████████████| 160/160 [00:06<00:00, 26.12it/s]
size restored (330, 522, 522)
Saved all slices and square power spectrum for epoch 2 to 'denoise'
training tomograms for 2 epochs, remaining epochs 2
Epoch 1:   0%|                                       | 0/13 [00:00<?, ?batch/s]Epoch 1:   0%| | 0/13 [00:19<?, ?batch/s, Loss: 1.6830 | in_mw_loss: 1.6830 | oEpoch 1:   8%| | 1/13 [00:19<03:53, 19.45s/batch, Loss: 1.6830 | in_mw_loss: 1.Epoch 1:   8%| | 1/13 [00:19<03:53, 19.45s/batch, Loss: 1.6075 | in_mw_loss: 1.Epoch 1:  15%|▏| 2/13 [00:19<01:29,  8.11s/batch, Loss: 1.6075 | in_mw_loss: 1.Epoch 1:  15%|▏| 2/13 [00:19<01:29,  8.11s/batch, Loss: 1.3491 | in_mw_loss: 1.Epoch 1:  23%|▏| 3/13 [00:19<00:45,  4.55s/batch, Loss: 1.3491 | in_mw_loss: 1.Epoch 1:  23%|▏| 3/13 [00:20<00:45,  4.55s/batch, Loss: 1.2651 | in_mw_loss: 1.Epoch 1:  31%|▎| 4/13 [00:20<00:25,  2.81s/batch, Loss: 1.2651 | in_mw_loss: 1.Epoch 1:  31%|▎| 4/13 [00:20<00:25,  2.81s/batch, Loss: 1.2479 | in_mw_loss: 1.Epoch 1:  38%|▍| 5/13 [00:20<00:14,  1.85s/batch, Loss: 1.2479 | in_mw_loss: 1.Epoch 1:  38%|▍| 5/13 [00:20<00:14,  1.85s/batch, Loss: 1.1626 | in_mw_loss: 1.Epoch 1:  46%|▍| 6/13 [00:20<00:08,  1.27s/batch, Loss: 1.1626 | in_mw_loss: 1.Epoch 1:  46%|▍| 6/13 [00:20<00:08,  1.27s/batch, Loss: 1.1682 | in_mw_loss: 1.Epoch 1:  54%|▌| 7/13 [00:20<00:05,  1.03batch/s, Loss: 1.1682 | in_mw_loss: 1.Epoch 1:  54%|▌| 7/13 [00:20<00:05,  1.03batch/s, Loss: 1.1893 | in_mw_loss: 1.Epoch 1:  62%|▌| 8/13 [00:20<00:03,  1.40batch/s, Loss: 1.1893 | in_mw_loss: 1.Epoch 1:  62%|▌| 8/13 [00:21<00:03,  1.40batch/s, Loss: 1.1464 | in_mw_loss: 1.Epoch 1:  69%|▋| 9/13 [00:21<00:02,  1.87batch/s, Loss: 1.1464 | in_mw_loss: 1.Epoch 1:  69%|▋| 9/13 [00:21<00:02,  1.87batch/s, Loss: 1.1362 | in_mw_loss: 1.Epoch 1:  77%|▊| 10/13 [00:21<00:01,  2.08batch/s, Loss: 1.1362 | in_mw_loss: 1Epoch 1:  77%|▊| 10/13 [00:21<00:01,  2.08batch/s, Loss: 1.1554 | in_mw_loss: 1Epoch 1:  85%|▊| 11/13 [00:21<00:00,  2.66batch/s, Loss: 1.1554 | in_mw_loss: 1Epoch 1:  85%|▊| 11/13 [00:21<00:00,  2.66batch/s, Loss: 1.0168 | in_mw_loss: 1Epoch 1:  92%|▉| 12/13 [00:21<00:00,  3.23batch/s, Loss: 1.0168 | in_mw_loss: 1Epoch 1:  92%|▉| 12/13 [00:21<00:00,  3.23batch/s, Loss: 1.0847 | in_mw_loss: 1Epoch 1: 100%|█| 13/13 [00:21<00:00,  3.67batch/s, Loss: 1.0847 | in_mw_loss: 1Epoch 1: 100%|█| 13/13 [00:21<00:00,  1.68s/batch, Loss: 1.0847 | in_mw_loss: 1
Epoch [  1/  2], Loss: 1.2581, in_mw_loss: 1.2581, out_mw_loss: 1.2581, learning_rate: 3.0000e-04
Epoch 2:   0%|                                       | 0/13 [00:00<?, ?batch/s]Epoch 2:   0%| | 0/13 [00:00<?, ?batch/s, Loss: 1.1247 | in_mw_loss: 1.1247 | oEpoch 2:   8%| | 1/13 [00:00<00:03,  3.40batch/s, Loss: 1.1247 | in_mw_loss: 1.Epoch 2:   8%| | 1/13 [00:00<00:03,  3.40batch/s, Loss: 1.0183 | in_mw_loss: 1.Epoch 2:  15%|▏| 2/13 [00:00<00:02,  4.99batch/s, Loss: 1.0183 | in_mw_loss: 1.Epoch 2:  15%|▏| 2/13 [00:00<00:02,  4.99batch/s, Loss: 1.1792 | in_mw_loss: 1.Epoch 2:  23%|▏| 3/13 [00:00<00:01,  5.45batch/s, Loss: 1.1792 | in_mw_loss: 1.Epoch 2:  23%|▏| 3/13 [00:00<00:01,  5.45batch/s, Loss: 1.0534 | in_mw_loss: 1.Epoch 2:  31%|▎| 4/13 [00:00<00:01,  6.10batch/s, Loss: 1.0534 | in_mw_loss: 1.Epoch 2:  31%|▎| 4/13 [00:00<00:01,  6.10batch/s, Loss: 1.0453 | in_mw_loss: 1.Epoch 2:  38%|▍| 5/13 [00:00<00:01,  6.51batch/s, Loss: 1.0453 | in_mw_loss: 1.Epoch 2:  38%|▍| 5/13 [00:00<00:01,  6.51batch/s, Loss: 1.1047 | in_mw_loss: 1.Epoch 2:  46%|▍| 6/13 [00:00<00:01,  6.79batch/s, Loss: 1.1047 | in_mw_loss: 1.Epoch 2:  46%|▍| 6/13 [00:01<00:01,  6.79batch/s, Loss: 1.0704 | in_mw_loss: 1.Epoch 2:  54%|▌| 7/13 [00:01<00:00,  6.98batch/s, Loss: 1.0704 | in_mw_loss: 1.Epoch 2:  54%|▌| 7/13 [00:01<00:00,  6.98batch/s, Loss: 1.0637 | in_mw_loss: 1.Epoch 2:  62%|▌| 8/13 [00:01<00:00,  7.11batch/s, Loss: 1.0637 | in_mw_loss: 1.Epoch 2:  62%|▌| 8/13 [00:01<00:00,  7.11batch/s, Loss: 0.9928 | in_mw_loss: 0.Epoch 2:  69%|▋| 9/13 [00:01<00:00,  7.21batch/s, Loss: 0.9928 | in_mw_loss: 0.Epoch 2:  69%|▋| 9/13 [00:01<00:00,  7.21batch/s, Loss: 1.0659 | in_mw_loss: 1.Epoch 2:  77%|▊| 10/13 [00:01<00:00,  7.26batch/s, Loss: 1.0659 | in_mw_loss: 1Epoch 2:  77%|▊| 10/13 [00:01<00:00,  7.26batch/s, Loss: 1.0434 | in_mw_loss: 1Epoch 2:  85%|▊| 11/13 [00:01<00:00,  7.33batch/s, Loss: 1.0434 | in_mw_loss: 1Epoch 2:  85%|▊| 11/13 [00:01<00:00,  7.33batch/s, Loss: 1.1266 | in_mw_loss: 1Epoch 2:  92%|▉| 12/13 [00:01<00:00,  7.33batch/s, Loss: 1.1266 | in_mw_loss: 1Epoch 2:  92%|▉| 12/13 [00:01<00:00,  7.33batch/s, Loss: 1.0162 | in_mw_loss: 1Epoch 2: 100%|█| 13/13 [00:01<00:00,  6.83batch/s, Loss: 1.0162 | in_mw_loss: 1
Epoch [  2/  2], Loss: 1.0528, in_mw_loss: 1.0528, out_mw_loss: 1.0528, learning_rate: 3.0000e-04
data_shape torch.Size([320, 1, 96, 96, 96])
predict:   0%|                                         | 0/160 [00:00<?, ?it/s]predict:   1%|▏                                | 1/160 [00:00<00:25,  6.12it/s]predict:   2%|▊                                | 4/160 [00:00<00:10, 14.45it/s]predict:   4%|█▏                               | 6/160 [00:00<00:09, 15.89it/s]predict:   5%|█▋                               | 8/160 [00:00<00:09, 16.77it/s]predict:   7%|██▏                             | 11/160 [00:00<00:07, 20.11it/s]predict:   9%|███                             | 15/160 [00:00<00:05, 25.81it/s]predict:  12%|███▊                            | 19/160 [00:00<00:05, 27.65it/s]predict:  14%|████▌                           | 23/160 [00:00<00:04, 30.20it/s]predict:  17%|█████▍                          | 27/160 [00:01<00:04, 32.10it/s]predict:  19%|██████▏                         | 31/160 [00:01<00:04, 27.85it/s]predict:  21%|██████▊                         | 34/160 [00:01<00:04, 26.86it/s]predict:  23%|███████▍                        | 37/160 [00:01<00:05, 23.93it/s]predict:  26%|████████▏                       | 41/160 [00:01<00:04, 27.40it/s]predict:  28%|█████████                       | 45/160 [00:01<00:03, 30.27it/s]predict:  31%|█████████▊                      | 49/160 [00:01<00:03, 30.84it/s]predict:  33%|██████████▌                     | 53/160 [00:02<00:03, 32.15it/s]predict:  36%|███████████▍                    | 57/160 [00:02<00:03, 33.67it/s]predict:  38%|████████████▏                   | 61/160 [00:02<00:03, 30.07it/s]predict:  41%|█████████████                   | 65/160 [00:02<00:03, 24.94it/s]predict:  42%|█████████████▌                  | 68/160 [00:02<00:03, 25.61it/s]predict:  45%|██████████████▍                 | 72/160 [00:02<00:03, 28.44it/s]predict:  48%|███████████████▏                | 76/160 [00:02<00:02, 30.10it/s]predict:  50%|████████████████                | 80/160 [00:02<00:02, 31.44it/s]predict:  52%|████████████████▊               | 84/160 [00:03<00:02, 32.42it/s]predict:  55%|█████████████████▌              | 88/160 [00:03<00:02, 31.39it/s]predict:  57%|██████████████████▍             | 92/160 [00:03<00:02, 25.91it/s]predict:  59%|███████████████████             | 95/160 [00:03<00:02, 24.30it/s]predict:  62%|███████████████████▊            | 99/160 [00:03<00:02, 27.58it/s]predict:  64%|███████████████████▉           | 103/160 [00:03<00:01, 29.42it/s]predict:  67%|████████████████████▋          | 107/160 [00:03<00:01, 30.74it/s]predict:  69%|█████████████████████▌         | 111/160 [00:04<00:01, 32.28it/s]predict:  72%|██████████████████████▎        | 115/160 [00:04<00:01, 30.28it/s]predict:  74%|███████████████████████        | 119/160 [00:04<00:01, 25.39it/s]predict:  76%|███████████████████████▋       | 122/160 [00:04<00:01, 24.74it/s]predict:  79%|████████████████████████▍      | 126/160 [00:04<00:01, 27.88it/s]predict:  81%|█████████████████████████▏     | 130/160 [00:04<00:00, 30.49it/s]predict:  84%|█████████████████████████▉     | 134/160 [00:04<00:00, 30.58it/s]predict:  86%|██████████████████████████▋    | 138/160 [00:04<00:00, 32.42it/s]predict:  89%|███████████████████████████▌   | 142/160 [00:05<00:00, 33.83it/s]predict:  91%|████████████████████████████▎  | 146/160 [00:05<00:00, 32.39it/s]Traceback (most recent call last):
  File "/home/cii/software/IsoNet2/IsoNet/bin/isonet.py", line 1080, in <module>
    exit(main())
         ~~~~^^
  File "/home/cii/software/IsoNet2/IsoNet/bin/isonet.py", line 1076, in main
    fire.Fire(ISONET)
    ~~~~~~~~~^^^^^^^^
  File "/home/cii/anaconda3/envs/torch_cuda12.6_glados_py3.13/lib/python3.13/site-packages/fire/core.py", line 135, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/home/cii/anaconda3/envs/torch_cuda12.6_glados_py3.13/lib/python3.13/site-packages/fire/core.py", line 468, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
                                ~~~~~~~~~~~~~~~~~~~^
        component,
        ^^^^^^^^^^
    ...<2 lines>...
        treatment='class' if is_class else 'routine',
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        target=component.__name__)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/cii/anaconda3/envs/torch_cuda12.6_glados_py3.13/lib/python3.13/site-packages/fire/core.py", line 684, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "/home/cii/software/IsoNet2/IsoNet/bin/isonet.py", line 604, in denoise
    network.train(training_params) #train based on init model and save new one as model_iter{num_iter}.h5
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/cii/software/IsoNet2/IsoNet/models/network.py", line 257, in train
    tmp_out = self.predict_map(tomo_vol,output_dir=f"{training_params['output_dir']}", F_mask=F_mask).astype(np.float32) * -1
              ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/cii/software/IsoNet2/IsoNet/models/network.py", line 315, in predict_map
    outData = self.predict(data, tmp_data_path=tmp_data_path, F_mask=F_mask)
  File "/home/cii/software/IsoNet2/IsoNet/models/network.py", line 294, in predict
    mp.spawn(ddp_predict, args=(self.world_size, self.port_number, self.model, data, tmp_data_path,\
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                 F_mask), nprocs=self.world_size)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/cii/anaconda3/envs/torch_cuda12.6_glados_py3.13/lib/python3.13/site-packages/torch/multiprocessing/spawn.py", line 340, in spawn
    return start_processes(fn, args, nprocs, join, daemon, start_method="spawn")
  File "/home/cii/anaconda3/envs/torch_cuda12.6_glados_py3.13/lib/python3.13/site-packages/torch/multiprocessing/spawn.py", line 296, in start_processes
    while not context.join():
              ~~~~~~~~~~~~^^
  File "/home/cii/anaconda3/envs/torch_cuda12.6_glados_py3.13/lib/python3.13/site-packages/torch/multiprocessing/spawn.py", line 144, in join
    ready = multiprocessing.connection.wait(
        self.sentinels.keys(),
        timeout=timeout,
    )
  File "/home/cii/anaconda3/envs/torch_cuda12.6_glados_py3.13/lib/python3.13/multiprocessing/connection.py", line 1148, in wait
    ready = selector.select(timeout)
  File "/home/cii/anaconda3/envs/torch_cuda12.6_glados_py3.13/lib/python3.13/selectors.py", line 398, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt
predict:  93%|████████████████████████████▊  | 149/160 [00:05<00:00, 27.51it/s]
[rank0]:[W718 19:10:14.974669767 ProcessGroupNCCL.cpp:1496] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
Exception ignored in atexit callback <function _exit_function at 0x7efd5344de40>:
Traceback (most recent call last):
  File "/home/cii/anaconda3/envs/torch_cuda12.6_glados_py3.13/lib/python3.13/multiprocessing/util.py", line 349, in _exit_function
    p.join()
  File "/home/cii/anaconda3/envs/torch_cuda12.6_glados_py3.13/lib/python3.13/multiprocessing/process.py", line 149, in join
    res = self._popen.wait(timeout)
  File "/home/cii/anaconda3/envs/torch_cuda12.6_glados_py3.13/lib/python3.13/multiprocessing/popen_fork.py", line 44, in wait
    return self.poll(os.WNOHANG if timeout == 0.0 else 0)
  File "/home/cii/anaconda3/envs/torch_cuda12.6_glados_py3.13/lib/python3.13/multiprocessing/popen_fork.py", line 28, in poll
    pid, sts = os.waitpid(self.pid, flag)
KeyboardInterrupt: 
Command: isonet.py denoise --star_file tomograms.star --output_dir denoise --gpuID 0,1 --ncpus 16 --arch unet-medium --pretrained_model None --pretrained_model2 None --cube_size 96 --epochs 6 --input_column rlnTomoReconstructedTomogramHalf --batch_size None --acc_batches 1 --loss_func L2 --learning_rate 0.0003 --T_max 2 --learning_rate_min 0.0003 --compile_model False --mixed_precision True --CTF_mode None --isCTFflipped False --with_predict True --split_halves False --snrfalloff 0 --deconvstrength 1 --highpassnyquist 0.02
07-18 20:11:18, INFO     The denoise folder already exists, outputs will write into this folder
07-18 20:11:18, INFO     Port number: 52099
Total number of parameters: 23989825
Preprocess tomograms:   0%|                                                   | 0/5 [00:00<?, ?it/s]Preprocess tomograms:  20%|████████▌                                  | 1/5 [00:00<00:01,  2.65it/s]Preprocess tomograms:  40%|█████████████████▏                         | 2/5 [00:00<00:01,  2.68it/s]Preprocess tomograms:  60%|█████████████████████████▊                 | 3/5 [00:01<00:00,  2.68it/s]Preprocess tomograms:  80%|██████████████████████████████████▍        | 4/5 [00:01<00:00,  2.68it/s]Preprocess tomograms: 100%|███████████████████████████████████████████| 5/5 [00:01<00:00,  2.71it/s]Preprocess tomograms: 100%|███████████████████████████████████████████| 5/5 [00:01<00:00,  2.69it/s]
training tomograms for 2 epochs, remaining epochs 6
Epoch 1:   0%|                                       | 0/13 [00:00<?, ?batch/s]Epoch 1:   0%| | 0/13 [00:19<?, ?batch/s, Loss: 1.7158 | in_mw_loss: 1.7158 | oEpoch 1:   8%| | 1/13 [00:19<03:52, 19.38s/batch, Loss: 1.7158 | in_mw_loss: 1.Epoch 1:   8%| | 1/13 [00:19<03:52, 19.38s/batch, Loss: 1.5928 | in_mw_loss: 1.Epoch 1:  15%|▏| 2/13 [00:19<01:29,  8.17s/batch, Loss: 1.5928 | in_mw_loss: 1.Epoch 1:  15%|▏| 2/13 [00:19<01:29,  8.17s/batch, Loss: 1.3917 | in_mw_loss: 1.Epoch 1:  23%|▏| 3/13 [00:19<00:45,  4.51s/batch, Loss: 1.3917 | in_mw_loss: 1.Epoch 1:  23%|▏| 3/13 [00:20<00:45,  4.51s/batch, Loss: 1.3107 | in_mw_loss: 1.Epoch 1:  31%|▎| 4/13 [00:20<00:25,  2.80s/batch, Loss: 1.3107 | in_mw_loss: 1.Epoch 1:  31%|▎| 4/13 [00:20<00:25,  2.80s/batch, Loss: 1.1391 | in_mw_loss: 1.Epoch 1:  38%|▍| 5/13 [00:20<00:14,  1.85s/batch, Loss: 1.1391 | in_mw_loss: 1.Epoch 1:  38%|▍| 5/13 [00:20<00:14,  1.85s/batch, Loss: 1.2693 | in_mw_loss: 1.Epoch 1:  46%|▍| 6/13 [00:20<00:09,  1.32s/batch, Loss: 1.2693 | in_mw_loss: 1.Epoch 1:  46%|▍| 6/13 [00:20<00:09,  1.32s/batch, Loss: 1.1310 | in_mw_loss: 1.Epoch 1:  54%|▌| 7/13 [00:20<00:05,  1.05batch/s, Loss: 1.1310 | in_mw_loss: 1.Epoch 1:  54%|▌| 7/13 [00:20<00:05,  1.05batch/s, Loss: 1.1562 | in_mw_loss: 1.Epoch 1:  62%|▌| 8/13 [00:20<00:03,  1.39batch/s, Loss: 1.1562 | in_mw_loss: 1.Epoch 1:  62%|▌| 8/13 [00:21<00:03,  1.39batch/s, Loss: 1.1498 | in_mw_loss: 1.Epoch 1:  69%|▋| 9/13 [00:21<00:02,  1.75batch/s, Loss: 1.1498 | in_mw_loss: 1.Epoch 1:  69%|▋| 9/13 [00:21<00:02,  1.75batch/s, Loss: 1.1429 | in_mw_loss: 1.Epoch 1:  77%|▊| 10/13 [00:21<00:01,  2.23batch/s, Loss: 1.1429 | in_mw_loss: 1Epoch 1:  77%|▊| 10/13 [00:21<00:01,  2.23batch/s, Loss: 1.1406 | in_mw_loss: 1Epoch 1:  85%|▊| 11/13 [00:21<00:00,  2.54batch/s, Loss: 1.1406 | in_mw_loss: 1Epoch 1:  85%|▊| 11/13 [00:21<00:00,  2.54batch/s, Loss: 1.1562 | in_mw_loss: 1Epoch 1:  92%|▉| 12/13 [00:21<00:00,  2.93batch/s, Loss: 1.1562 | in_mw_loss: 1Epoch 1:  92%|▉| 12/13 [00:21<00:00,  2.93batch/s, Loss: 1.1159 | in_mw_loss: 1Epoch 1: 100%|█| 13/13 [00:21<00:00,  3.52batch/s, Loss: 1.1159 | in_mw_loss: 1Epoch 1: 100%|█| 13/13 [00:21<00:00,  1.69s/batch, Loss: 1.1159 | in_mw_loss: 1
Epoch [  1/  2], Loss: 1.2667, in_mw_loss: 1.2667, out_mw_loss: 1.2667, learning_rate: 3.0000e-04
Epoch 2:   0%|                                       | 0/13 [00:00<?, ?batch/s]Epoch 2:   0%| | 0/13 [00:00<?, ?batch/s, Loss: 1.1081 | in_mw_loss: 1.1081 | oEpoch 2:   8%| | 1/13 [00:00<00:02,  4.32batch/s, Loss: 1.1081 | in_mw_loss: 1.Epoch 2:   8%| | 1/13 [00:00<00:02,  4.32batch/s, Loss: 1.1153 | in_mw_loss: 1.Epoch 2:  15%|▏| 2/13 [00:00<00:02,  5.01batch/s, Loss: 1.1153 | in_mw_loss: 1.Epoch 2:  15%|▏| 2/13 [00:00<00:02,  5.01batch/s, Loss: 1.0760 | in_mw_loss: 1.Epoch 2:  23%|▏| 3/13 [00:00<00:02,  4.28batch/s, Loss: 1.0760 | in_mw_loss: 1.Epoch 2:  23%|▏| 3/13 [00:00<00:02,  4.28batch/s, Loss: 1.1439 | in_mw_loss: 1.Epoch 2:  31%|▎| 4/13 [00:00<00:02,  4.44batch/s, Loss: 1.1439 | in_mw_loss: 1.Epoch 2:  31%|▎| 4/13 [00:01<00:02,  4.44batch/s, Loss: 1.0597 | in_mw_loss: 1.Epoch 2:  38%|▍| 5/13 [00:01<00:01,  4.71batch/s, Loss: 1.0597 | in_mw_loss: 1.Epoch 2:  38%|▍| 5/13 [00:01<00:01,  4.71batch/s, Loss: 1.0445 | in_mw_loss: 1.Epoch 2:  46%|▍| 6/13 [00:01<00:01,  4.20batch/s, Loss: 1.0445 | in_mw_loss: 1.Epoch 2:  46%|▍| 6/13 [00:01<00:01,  4.20batch/s, Loss: 1.0248 | in_mw_loss: 1.Epoch 2:  54%|▌| 7/13 [00:01<00:01,  4.42batch/s, Loss: 1.0248 | in_mw_loss: 1.Epoch 2:  54%|▌| 7/13 [00:01<00:01,  4.42batch/s, Loss: 1.0420 | in_mw_loss: 1.Epoch 2:  62%|▌| 8/13 [00:01<00:01,  4.72batch/s, Loss: 1.0420 | in_mw_loss: 1.Epoch 2:  62%|▌| 8/13 [00:02<00:01,  4.72batch/s, Loss: 1.0674 | in_mw_loss: 1.Epoch 2:  69%|▋| 9/13 [00:02<00:00,  4.34batch/s, Loss: 1.0674 | in_mw_loss: 1.Epoch 2:  69%|▋| 9/13 [00:02<00:00,  4.34batch/s, Loss: 0.9844 | in_mw_loss: 0.Epoch 2:  77%|▊| 10/13 [00:02<00:00,  4.46batch/s, Loss: 0.9844 | in_mw_loss: 0Epoch 2:  77%|▊| 10/13 [00:02<00:00,  4.46batch/s, Loss: 0.9326 | in_mw_loss: 0Epoch 2:  85%|▊| 11/13 [00:02<00:00,  4.72batch/s, Loss: 0.9326 | in_mw_loss: 0Epoch 2:  85%|▊| 11/13 [00:02<00:00,  4.72batch/s, Loss: 1.0522 | in_mw_loss: 1Epoch 2:  92%|▉| 12/13 [00:02<00:00,  4.41batch/s, Loss: 1.0522 | in_mw_loss: 1Epoch 2:  92%|▉| 12/13 [00:02<00:00,  4.41batch/s, Loss: 1.0255 | in_mw_loss: 1Epoch 2: 100%|█| 13/13 [00:02<00:00,  4.71batch/s, Loss: 1.0255 | in_mw_loss: 1Epoch 2: 100%|█| 13/13 [00:02<00:00,  4.55batch/s, Loss: 1.0255 | in_mw_loss: 1
Epoch [  2/  2], Loss: 1.0603, in_mw_loss: 1.0603, out_mw_loss: 1.0603, learning_rate: 3.0000e-04
data_shape torch.Size([320, 1, 96, 96, 96])
predict:   0%|                                         | 0/160 [00:00<?, ?it/s]predict:   1%|▏                                | 1/160 [00:00<00:24,  6.51it/s]predict:   3%|█                                | 5/160 [00:00<00:07, 21.88it/s]predict:   6%|█▊                               | 9/160 [00:00<00:05, 28.33it/s]predict:   8%|██▌                             | 13/160 [00:00<00:04, 31.70it/s]predict:  11%|███▍                            | 17/160 [00:00<00:04, 33.74it/s]predict:  13%|████▏                           | 21/160 [00:00<00:03, 34.91it/s]predict:  16%|█████                           | 25/160 [00:00<00:03, 35.62it/s]predict:  18%|█████▊                          | 29/160 [00:00<00:03, 36.01it/s]predict:  21%|██████▌                         | 33/160 [00:01<00:03, 36.43it/s]predict:  23%|███████▍                        | 37/160 [00:01<00:03, 36.65it/s]predict:  26%|████████▏                       | 41/160 [00:01<00:03, 36.90it/s]predict:  28%|█████████                       | 45/160 [00:01<00:03, 37.51it/s]predict:  31%|█████████▊                      | 49/160 [00:01<00:02, 37.71it/s]predict:  33%|██████████▌                     | 53/160 [00:01<00:02, 37.31it/s]predict:  36%|███████████▍                    | 57/160 [00:01<00:02, 37.52it/s]predict:  38%|████████████▏                   | 61/160 [00:01<00:02, 37.77it/s]predict:  41%|█████████████                   | 65/160 [00:01<00:02, 37.80it/s]predict:  43%|█████████████▊                  | 69/160 [00:01<00:02, 38.11it/s]predict:  46%|██████████████▌                 | 73/160 [00:02<00:02, 38.15it/s]predict:  48%|███████████████▍                | 77/160 [00:02<00:02, 37.88it/s]predict:  51%|████████████████▏               | 81/160 [00:02<00:02, 37.73it/s]predict:  53%|█████████████████               | 85/160 [00:02<00:02, 37.48it/s]predict:  56%|█████████████████▊              | 89/160 [00:02<00:01, 37.45it/s]predict:  58%|██████████████████▌             | 93/160 [00:02<00:01, 37.37it/s]predict:  61%|███████████████████▍            | 97/160 [00:02<00:01, 37.61it/s]predict:  63%|███████████████████▌           | 101/160 [00:02<00:01, 37.60it/s]predict:  66%|████████████████████▎          | 105/160 [00:02<00:01, 37.79it/s]predict:  68%|█████████████████████          | 109/160 [00:03<00:01, 37.68it/s]predict:  71%|█████████████████████▉         | 113/160 [00:03<00:01, 37.42it/s]predict:  73%|██████████████████████▋        | 117/160 [00:03<00:01, 37.34it/s]predict:  76%|███████████████████████▍       | 121/160 [00:03<00:01, 37.38it/s]predict:  78%|████████████████████████▏      | 125/160 [00:03<00:00, 37.51it/s]predict:  81%|████████████████████████▉      | 129/160 [00:03<00:00, 37.63it/s]predict:  83%|█████████████████████████▊     | 133/160 [00:03<00:00, 37.62it/s]predict:  86%|██████████████████████████▌    | 137/160 [00:03<00:00, 37.44it/s]predict:  88%|███████████████████████████▎   | 141/160 [00:03<00:00, 37.25it/s]predict:  91%|████████████████████████████   | 145/160 [00:03<00:00, 36.85it/s]predict:  93%|████████████████████████████▊  | 149/160 [00:04<00:00, 36.95it/s]predict:  96%|█████████████████████████████▋ | 153/160 [00:04<00:00, 37.05it/s]predict:  98%|██████████████████████████████▍| 157/160 [00:04<00:00, 37.15it/s]predict: 100%|███████████████████████████████| 160/160 [00:04<00:00, 36.39it/s]
size restored (330, 522, 522)
Saved slices and power spectrum for epoch 2 to 'denoise'
training tomograms for 2 epochs, remaining epochs 4
Epoch 1:   0%|                                       | 0/13 [00:00<?, ?batch/s]Epoch 1:   0%| | 0/13 [00:19<?, ?batch/s, Loss: 1.7161 | in_mw_loss: 1.7161 | oEpoch 1:   8%| | 1/13 [00:19<03:51, 19.29s/batch, Loss: 1.7161 | in_mw_loss: 1.Epoch 1:   8%| | 1/13 [00:19<03:51, 19.29s/batch, Loss: 1.5927 | in_mw_loss: 1.Epoch 1:  15%|▏| 2/13 [00:19<01:28,  8.08s/batch, Loss: 1.5927 | in_mw_loss: 1.Epoch 1:  15%|▏| 2/13 [00:19<01:28,  8.08s/batch, Loss: 1.3913 | in_mw_loss: 1.Epoch 1:  23%|▏| 3/13 [00:19<00:44,  4.47s/batch, Loss: 1.3913 | in_mw_loss: 1.Epoch 1:  23%|▏| 3/13 [00:19<00:44,  4.47s/batch, Loss: 1.3110 | in_mw_loss: 1.Epoch 1:  31%|▎| 4/13 [00:19<00:25,  2.81s/batch, Loss: 1.3110 | in_mw_loss: 1.Epoch 1:  31%|▎| 4/13 [00:20<00:25,  2.81s/batch, Loss: 1.1394 | in_mw_loss: 1.Epoch 1:  38%|▍| 5/13 [00:20<00:14,  1.86s/batch, Loss: 1.1394 | in_mw_loss: 1.Epoch 1:  38%|▍| 5/13 [00:20<00:14,  1.86s/batch, Loss: 1.2695 | in_mw_loss: 1.Epoch 1:  46%|▍| 6/13 [00:20<00:09,  1.31s/batch, Loss: 1.2695 | in_mw_loss: 1.Epoch 1:  46%|▍| 6/13 [00:20<00:09,  1.31s/batch, Loss: 1.1306 | in_mw_loss: 1.Epoch 1:  54%|▌| 7/13 [00:20<00:05,  1.07batch/s, Loss: 1.1306 | in_mw_loss: 1.Epoch 1:  54%|▌| 7/13 [00:20<00:05,  1.07batch/s, Loss: 1.1547 | in_mw_loss: 1.Epoch 1:  62%|▌| 8/13 [00:20<00:03,  1.43batch/s, Loss: 1.1547 | in_mw_loss: 1.Epoch 1:  62%|▌| 8/13 [00:20<00:03,  1.43batch/s, Loss: 1.1501 | in_mw_loss: 1.Epoch 1:  69%|▋| 9/13 [00:20<00:02,  1.78batch/s, Loss: 1.1501 | in_mw_loss: 1.Epoch 1:  69%|▋| 9/13 [00:21<00:02,  1.78batch/s, Loss: 1.1432 | in_mw_loss: 1.Epoch 1:  77%|▊| 10/13 [00:21<00:01,  2.34batch/s, Loss: 1.1432 | in_mw_loss: 1Epoch 1:  77%|▊| 10/13 [00:21<00:01,  2.34batch/s, Loss: 1.1407 | in_mw_loss: 1Epoch 1:  85%|▊| 11/13 [00:21<00:00,  2.98batch/s, Loss: 1.1407 | in_mw_loss: 1Epoch 1:  85%|▊| 11/13 [00:21<00:00,  2.98batch/s, Loss: 1.1564 | in_mw_loss: 1Epoch 1:  92%|▉| 12/13 [00:21<00:00,  3.52batch/s, Loss: 1.1564 | in_mw_loss: 1Epoch 1:  92%|▉| 12/13 [00:21<00:00,  3.52batch/s, Loss: 1.1155 | in_mw_loss: 1Epoch 1: 100%|█| 13/13 [00:21<00:00,  4.03batch/s, Loss: 1.1155 | in_mw_loss: 1Epoch 1: 100%|█| 13/13 [00:21<00:00,  1.66s/batch, Loss: 1.1155 | in_mw_loss: 1
Epoch [  1/  2], Loss: 1.2668, in_mw_loss: 1.2668, out_mw_loss: 1.2668, learning_rate: 3.0000e-04
Epoch 2:   0%|                                       | 0/13 [00:00<?, ?batch/s]Epoch 2:   0%| | 0/13 [00:00<?, ?batch/s, Loss: 1.1075 | in_mw_loss: 1.1075 | oEpoch 2:   8%| | 1/13 [00:00<00:02,  4.25batch/s, Loss: 1.1075 | in_mw_loss: 1.Epoch 2:   8%| | 1/13 [00:00<00:02,  4.25batch/s, Loss: 1.1159 | in_mw_loss: 1.Epoch 2:  15%|▏| 2/13 [00:00<00:01,  5.81batch/s, Loss: 1.1159 | in_mw_loss: 1.Epoch 2:  15%|▏| 2/13 [00:00<00:01,  5.81batch/s, Loss: 1.0803 | in_mw_loss: 1.Epoch 2:  23%|▏| 3/13 [00:00<00:01,  6.51batch/s, Loss: 1.0803 | in_mw_loss: 1.Epoch 2:  23%|▏| 3/13 [00:00<00:01,  6.51batch/s, Loss: 1.1428 | in_mw_loss: 1.Epoch 2:  31%|▎| 4/13 [00:00<00:01,  6.87batch/s, Loss: 1.1428 | in_mw_loss: 1.Epoch 2:  31%|▎| 4/13 [00:00<00:01,  6.87batch/s, Loss: 1.0596 | in_mw_loss: 1.Epoch 2:  38%|▍| 5/13 [00:00<00:01,  7.13batch/s, Loss: 1.0596 | in_mw_loss: 1.Epoch 2:  38%|▍| 5/13 [00:00<00:01,  7.13batch/s, Loss: 1.0473 | in_mw_loss: 1.Epoch 2:  46%|▍| 6/13 [00:00<00:00,  7.02batch/s, Loss: 1.0473 | in_mw_loss: 1.Epoch 2:  46%|▍| 6/13 [00:01<00:00,  7.02batch/s, Loss: 1.0248 | in_mw_loss: 1.Epoch 2:  54%|▌| 7/13 [00:01<00:00,  7.02batch/s, Loss: 1.0248 | in_mw_loss: 1.Epoch 2:  54%|▌| 7/13 [00:01<00:00,  7.02batch/s, Loss: 1.0403 | in_mw_loss: 1.Epoch 2:  62%|▌| 8/13 [00:01<00:00,  7.18batch/s, Loss: 1.0403 | in_mw_loss: 1.Epoch 2:  62%|▌| 8/13 [00:01<00:00,  7.18batch/s, Loss: 1.0679 | in_mw_loss: 1.Epoch 2:  69%|▋| 9/13 [00:01<00:00,  7.36batch/s, Loss: 1.0679 | in_mw_loss: 1.Epoch 2:  69%|▋| 9/13 [00:01<00:00,  7.36batch/s, Loss: 0.9835 | in_mw_loss: 0.Epoch 2:  77%|▊| 10/13 [00:01<00:00,  7.42batch/s, Loss: 0.9835 | in_mw_loss: 0Epoch 2:  77%|▊| 10/13 [00:01<00:00,  7.42batch/s, Loss: 0.9323 | in_mw_loss: 0Epoch 2:  85%|▊| 11/13 [00:01<00:00,  7.51batch/s, Loss: 0.9323 | in_mw_loss: 0Epoch 2:  85%|▊| 11/13 [00:01<00:00,  7.51batch/s, Loss: 1.0543 | in_mw_loss: 1Epoch 2:  92%|▉| 12/13 [00:01<00:00,  6.90batch/s, Loss: 1.0543 | in_mw_loss: 1Epoch 2:  92%|▉| 12/13 [00:01<00:00,  6.90batch/s, Loss: 1.0276 | in_mw_loss: 1Epoch 2: 100%|█| 13/13 [00:01<00:00,  6.66batch/s, Loss: 1.0276 | in_mw_loss: 1Epoch 2: 100%|█| 13/13 [00:01<00:00,  6.82batch/s, Loss: 1.0276 | in_mw_loss: 1
Epoch [  2/  2], Loss: 1.0603, in_mw_loss: 1.0603, out_mw_loss: 1.0603, learning_rate: 3.0000e-04
data_shape torch.Size([320, 1, 96, 96, 96])
predict:   0%|                                         | 0/160 [00:00<?, ?it/s]predict:   1%|▏                                | 1/160 [00:00<00:25,  6.35it/s]predict:   3%|█                                | 5/160 [00:00<00:07, 21.58it/s]predict:   6%|█▊                               | 9/160 [00:00<00:05, 28.13it/s]predict:   8%|██▌                             | 13/160 [00:00<00:04, 31.54it/s]predict:  11%|███▍                            | 17/160 [00:00<00:04, 33.75it/s]predict:  13%|████▏                           | 21/160 [00:00<00:03, 35.23it/s]predict:  16%|█████                           | 25/160 [00:00<00:03, 35.99it/s]predict:  18%|█████▊                          | 29/160 [00:00<00:03, 36.74it/s]predict:  21%|██████▌                         | 33/160 [00:01<00:03, 37.33it/s]predict:  23%|███████▍                        | 37/160 [00:01<00:03, 37.66it/s]predict:  26%|████████▏                       | 41/160 [00:01<00:03, 37.62it/s]predict:  28%|█████████                       | 45/160 [00:01<00:03, 37.68it/s]predict:  31%|█████████▊                      | 49/160 [00:01<00:02, 37.86it/s]predict:  33%|██████████▌                     | 53/160 [00:01<00:02, 37.76it/s]predict:  36%|███████████▍                    | 57/160 [00:01<00:02, 37.95it/s]predict:  38%|████████████▏                   | 61/160 [00:01<00:02, 38.17it/s]predict:  41%|█████████████                   | 65/160 [00:01<00:02, 37.98it/s]predict:  43%|█████████████▊                  | 69/160 [00:01<00:02, 37.64it/s]predict:  46%|██████████████▌                 | 73/160 [00:02<00:02, 37.96it/s]predict:  48%|███████████████▍                | 77/160 [00:02<00:02, 37.88it/s]predict:  51%|████████████████▏               | 81/160 [00:02<00:02, 37.98it/s]predict:  53%|█████████████████               | 85/160 [00:02<00:01, 38.19it/s]predict:  56%|█████████████████▊              | 89/160 [00:02<00:01, 37.90it/s]predict:  58%|██████████████████▌             | 93/160 [00:02<00:01, 37.91it/s]predict:  61%|███████████████████▍            | 97/160 [00:02<00:01, 37.85it/s]predict:  63%|███████████████████▌           | 101/160 [00:02<00:01, 38.13it/s]predict:  66%|████████████████████▎          | 105/160 [00:02<00:01, 38.29it/s]predict:  68%|█████████████████████          | 109/160 [00:03<00:01, 37.90it/s]predict:  71%|█████████████████████▉         | 113/160 [00:03<00:01, 37.99it/s]predict:  73%|██████████████████████▋        | 117/160 [00:03<00:01, 38.22it/s]predict:  76%|███████████████████████▍       | 121/160 [00:03<00:01, 38.41it/s]predict:  78%|████████████████████████▏      | 125/160 [00:03<00:00, 38.45it/s]predict:  81%|████████████████████████▉      | 129/160 [00:03<00:00, 38.02it/s]predict:  83%|█████████████████████████▊     | 133/160 [00:03<00:00, 37.92it/s]predict:  86%|██████████████████████████▌    | 137/160 [00:03<00:00, 38.16it/s]predict:  88%|███████████████████████████▎   | 141/160 [00:03<00:00, 38.26it/s]predict:  91%|████████████████████████████   | 145/160 [00:03<00:00, 38.20it/s]predict:  93%|████████████████████████████▊  | 149/160 [00:04<00:00, 38.26it/s]predict:  96%|█████████████████████████████▋ | 153/160 [00:04<00:00, 38.30it/s]predict:  98%|██████████████████████████████▍| 157/160 [00:04<00:00, 38.42it/s]predict: 100%|███████████████████████████████| 160/160 [00:04<00:00, 36.91it/s]
size restored (330, 522, 522)
Saved slices and power spectrum for epoch 4 to 'denoise'
training tomograms for 2 epochs, remaining epochs 2
Epoch 1:   0%|                                       | 0/13 [00:00<?, ?batch/s]Epoch 1:   0%| | 0/13 [00:19<?, ?batch/s, Loss: 1.7159 | in_mw_loss: 1.7159 | oEpoch 1:   8%| | 1/13 [00:19<03:50, 19.21s/batch, Loss: 1.7159 | in_mw_loss: 1.Epoch 1:   8%| | 1/13 [00:19<03:50, 19.21s/batch, Loss: 1.5927 | in_mw_loss: 1.Epoch 1:  15%|▏| 2/13 [00:19<01:27,  7.99s/batch, Loss: 1.5927 | in_mw_loss: 1.Epoch 1:  15%|▏| 2/13 [00:19<01:27,  7.99s/batch, Loss: 1.3917 | in_mw_loss: 1.Epoch 1:  23%|▏| 3/13 [00:19<00:44,  4.48s/batch, Loss: 1.3917 | in_mw_loss: 1.Epoch 1:  23%|▏| 3/13 [00:19<00:44,  4.48s/batch, Loss: 1.3114 | in_mw_loss: 1.Epoch 1:  31%|▎| 4/13 [00:19<00:25,  2.79s/batch, Loss: 1.3114 | in_mw_loss: 1.Epoch 1:  31%|▎| 4/13 [00:20<00:25,  2.79s/batch, Loss: 1.1417 | in_mw_loss: 1.Epoch 1:  38%|▍| 5/13 [00:20<00:14,  1.84s/batch, Loss: 1.1417 | in_mw_loss: 1.Epoch 1:  38%|▍| 5/13 [00:20<00:14,  1.84s/batch, Loss: 1.2696 | in_mw_loss: 1.Epoch 1:  46%|▍| 6/13 [00:20<00:09,  1.31s/batch, Loss: 1.2696 | in_mw_loss: 1.Epoch 1:  46%|▍| 6/13 [00:20<00:09,  1.31s/batch, Loss: 1.1315 | in_mw_loss: 1.Epoch 1:  54%|▌| 7/13 [00:20<00:05,  1.04batch/s, Loss: 1.1315 | in_mw_loss: 1.Epoch 1:  54%|▌| 7/13 [00:20<00:05,  1.04batch/s, Loss: 1.1566 | in_mw_loss: 1.Epoch 1:  62%|▌| 8/13 [00:20<00:03,  1.43batch/s, Loss: 1.1566 | in_mw_loss: 1.Epoch 1:  62%|▌| 8/13 [00:20<00:03,  1.43batch/s, Loss: 1.1489 | in_mw_loss: 1.Epoch 1:  69%|▋| 9/13 [00:20<00:02,  1.91batch/s, Loss: 1.1489 | in_mw_loss: 1.Epoch 1:  69%|▋| 9/13 [00:20<00:02,  1.91batch/s, Loss: 1.1422 | in_mw_loss: 1.Epoch 1:  77%|▊| 10/13 [00:20<00:01,  2.46batch/s, Loss: 1.1422 | in_mw_loss: 1Epoch 1:  77%|▊| 10/13 [00:21<00:01,  2.46batch/s, Loss: 1.1441 | in_mw_loss: 1Epoch 1:  85%|▊| 11/13 [00:21<00:00,  2.69batch/s, Loss: 1.1441 | in_mw_loss: 1Epoch 1:  85%|▊| 11/13 [00:21<00:00,  2.69batch/s, Loss: 1.1565 | in_mw_loss: 1Epoch 1:  92%|▉| 12/13 [00:21<00:00,  3.12batch/s, Loss: 1.1565 | in_mw_loss: 1Epoch 1:  92%|▉| 12/13 [00:21<00:00,  3.12batch/s, Loss: 1.1183 | in_mw_loss: 1Epoch 1: 100%|█| 13/13 [00:21<00:00,  3.82batch/s, Loss: 1.1183 | in_mw_loss: 1Epoch 1: 100%|█| 13/13 [00:21<00:00,  1.66s/batch, Loss: 1.1183 | in_mw_loss: 1
Epoch [  1/  2], Loss: 1.2673, in_mw_loss: 1.2673, out_mw_loss: 1.2673, learning_rate: 3.0000e-04
Epoch 2:   0%|                                       | 0/13 [00:00<?, ?batch/s]Epoch 2:   0%| | 0/13 [00:00<?, ?batch/s, Loss: 1.1075 | in_mw_loss: 1.1075 | oEpoch 2:   8%| | 1/13 [00:00<00:03,  3.95batch/s, Loss: 1.1075 | in_mw_loss: 1.Epoch 2:   8%| | 1/13 [00:00<00:03,  3.95batch/s, Loss: 1.1159 | in_mw_loss: 1.Epoch 2:  15%|▏| 2/13 [00:00<00:02,  5.04batch/s, Loss: 1.1159 | in_mw_loss: 1.Epoch 2:  15%|▏| 2/13 [00:00<00:02,  5.04batch/s, Loss: 1.0795 | in_mw_loss: 1.Epoch 2:  23%|▏| 3/13 [00:00<00:01,  5.20batch/s, Loss: 1.0795 | in_mw_loss: 1.Epoch 2:  23%|▏| 3/13 [00:00<00:01,  5.20batch/s, Loss: 1.1438 | in_mw_loss: 1.Epoch 2:  31%|▎| 4/13 [00:00<00:01,  4.59batch/s, Loss: 1.1438 | in_mw_loss: 1.Epoch 2:  31%|▎| 4/13 [00:01<00:01,  4.59batch/s, Loss: 1.0603 | in_mw_loss: 1.Epoch 2:  38%|▍| 5/13 [00:01<00:01,  4.60batch/s, Loss: 1.0603 | in_mw_loss: 1.Epoch 2:  38%|▍| 5/13 [00:01<00:01,  4.60batch/s, Loss: 1.0465 | in_mw_loss: 1.Epoch 2:  46%|▍| 6/13 [00:01<00:01,  4.66batch/s, Loss: 1.0465 | in_mw_loss: 1.Epoch 2:  46%|▍| 6/13 [00:01<00:01,  4.66batch/s, Loss: 1.0253 | in_mw_loss: 1.Epoch 2:  54%|▌| 7/13 [00:01<00:01,  4.40batch/s, Loss: 1.0253 | in_mw_loss: 1.Epoch 2:  54%|▌| 7/13 [00:01<00:01,  4.40batch/s, Loss: 1.0425 | in_mw_loss: 1.Epoch 2:  62%|▌| 8/13 [00:01<00:01,  4.87batch/s, Loss: 1.0425 | in_mw_loss: 1.Epoch 2:  62%|▌| 8/13 [00:01<00:01,  4.87batch/s, Loss: 1.0648 | in_mw_loss: 1.Epoch 2:  69%|▋| 9/13 [00:01<00:00,  4.95batch/s, Loss: 1.0648 | in_mw_loss: 1.Epoch 2:  69%|▋| 9/13 [00:02<00:00,  4.95batch/s, Loss: 0.9840 | in_mw_loss: 0.Epoch 2:  77%|▊| 10/13 [00:02<00:00,  4.50batch/s, Loss: 0.9840 | in_mw_loss: 0Epoch 2:  77%|▊| 10/13 [00:02<00:00,  4.50batch/s, Loss: 0.9353 | in_mw_loss: 0Epoch 2:  85%|▊| 11/13 [00:02<00:00,  4.41batch/s, Loss: 0.9353 | in_mw_loss: 0Epoch 2:  85%|▊| 11/13 [00:02<00:00,  4.41batch/s, Loss: 1.0551 | in_mw_loss: 1Epoch 2:  92%|▉| 12/13 [00:02<00:00,  4.61batch/s, Loss: 1.0551 | in_mw_loss: 1Epoch 2:  92%|▉| 12/13 [00:02<00:00,  4.61batch/s, Loss: 1.0277 | in_mw_loss: 1Epoch 2: 100%|█| 13/13 [00:02<00:00,  4.84batch/s, Loss: 1.0277 | in_mw_loss: 1Epoch 2: 100%|█| 13/13 [00:02<00:00,  4.69batch/s, Loss: 1.0277 | in_mw_loss: 1
Epoch [  2/  2], Loss: 1.0605, in_mw_loss: 1.0605, out_mw_loss: 1.0605, learning_rate: 3.0000e-04
data_shape torch.Size([320, 1, 96, 96, 96])
W0718 20:13:49.709000 1543617 site-packages/torch/multiprocessing/spawn.py:169] Terminating process 1552271 via signal SIGTERM
Traceback (most recent call last):
  File "/home/cii/software/IsoNet2/IsoNet/bin/isonet.py", line 1080, in <module>
    exit(main())
         ~~~~^^
  File "/home/cii/software/IsoNet2/IsoNet/bin/isonet.py", line 1076, in main
    fire.Fire(ISONET)
    ~~~~~~~~~^^^^^^^^
  File "/home/cii/anaconda3/envs/torch_cuda12.6_glados_py3.13/lib/python3.13/site-packages/fire/core.py", line 135, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/home/cii/anaconda3/envs/torch_cuda12.6_glados_py3.13/lib/python3.13/site-packages/fire/core.py", line 468, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
                                ~~~~~~~~~~~~~~~~~~~^
        component,
        ^^^^^^^^^^
    ...<2 lines>...
        treatment='class' if is_class else 'routine',
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        target=component.__name__)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/cii/anaconda3/envs/torch_cuda12.6_glados_py3.13/lib/python3.13/site-packages/fire/core.py", line 684, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "/home/cii/software/IsoNet2/IsoNet/bin/isonet.py", line 604, in denoise
    network.train(training_params) #train based on init model and save new one as model_iter{num_iter}.h5
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/cii/software/IsoNet2/IsoNet/models/network.py", line 265, in train
    tmp_out = self.predict_map(tomo_vol,output_dir=f"{training_params['output_dir']}", F_mask=F_mask).astype(np.float32) * -1
              ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/cii/software/IsoNet2/IsoNet/models/network.py", line 323, in predict_map
    outData = self.predict(data, tmp_data_path=tmp_data_path, F_mask=F_mask)
  File "/home/cii/software/IsoNet2/IsoNet/models/network.py", line 302, in predict
    mp.spawn(ddp_predict, args=(self.world_size, self.port_number, self.model, data, tmp_data_path,\
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                                 F_mask), nprocs=self.world_size)
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/cii/anaconda3/envs/torch_cuda12.6_glados_py3.13/lib/python3.13/site-packages/torch/multiprocessing/spawn.py", line 340, in spawn
    return start_processes(fn, args, nprocs, join, daemon, start_method="spawn")
  File "/home/cii/anaconda3/envs/torch_cuda12.6_glados_py3.13/lib/python3.13/site-packages/torch/multiprocessing/spawn.py", line 296, in start_processes
    while not context.join():
              ~~~~~~~~~~~~^^
  File "/home/cii/anaconda3/envs/torch_cuda12.6_glados_py3.13/lib/python3.13/site-packages/torch/multiprocessing/spawn.py", line 196, in join
    raise ProcessExitedException(
    ...<5 lines>...
    )
torch.multiprocessing.spawn.ProcessExitedException: process 0 terminated with signal SIGSEGV
Process exited with code 1
Command: isonet.py denoise --star_file tomograms.star --output_dir denoise --gpuID 0,1 --ncpus 16 --arch unet-medium --pretrained_model None --pretrained_model2 None --cube_size 96 --epochs 6 --input_column rlnTomoReconstructedTomogramHalf --batch_size None --acc_batches 1 --loss_func L2 --learning_rate 0.0003 --T_max 2 --learning_rate_min 0.0003 --compile_model False --mixed_precision True --CTF_mode None --isCTFflipped False --with_predict True --split_halves False --snrfalloff 0 --deconvstrength 1 --highpassnyquist 0.02
07-18 21:48:50, INFO     The denoise folder already exists, outputs will write into this folder
07-18 21:48:50, INFO     Port number: 57611
Total number of parameters: 23989825
Preprocess tomograms:   0%|                                                   | 0/5 [00:00<?, ?it/s]Preprocess tomograms:  20%|████████▌                                  | 1/5 [00:00<00:01,  2.71it/s]Preprocess tomograms:  40%|█████████████████▏                         | 2/5 [00:00<00:01,  2.65it/s]Preprocess tomograms:  60%|█████████████████████████▊                 | 3/5 [00:01<00:00,  2.66it/s]Preprocess tomograms:  80%|██████████████████████████████████▍        | 4/5 [00:01<00:00,  2.69it/s]Preprocess tomograms: 100%|███████████████████████████████████████████| 5/5 [00:01<00:00,  2.71it/s]Preprocess tomograms: 100%|███████████████████████████████████████████| 5/5 [00:01<00:00,  2.69it/s]
training tomograms for 2 epochs, remaining epochs 6
Epoch 1:   0%|                                       | 0/13 [00:00<?, ?batch/s]Epoch 1:   0%| | 0/13 [00:18<?, ?batch/s, Loss: 1.7473 | in_mw_loss: 1.7473 | oEpoch 1:   8%| | 1/13 [00:18<03:45, 18.81s/batch, Loss: 1.7473 | in_mw_loss: 1.Epoch 1:   8%| | 1/13 [00:18<03:45, 18.81s/batch, Loss: 1.6410 | in_mw_loss: 1.Epoch 1:  15%|▏| 2/13 [00:18<01:26,  7.82s/batch, Loss: 1.6410 | in_mw_loss: 1.Epoch 1:  15%|▏| 2/13 [00:19<01:26,  7.82s/batch, Loss: 1.3047 | in_mw_loss: 1.Epoch 1:  23%|▏| 3/13 [00:19<00:43,  4.31s/batch, Loss: 1.3047 | in_mw_loss: 1.Epoch 1:  23%|▏| 3/13 [00:19<00:43,  4.31s/batch, Loss: 1.2958 | in_mw_loss: 1.Epoch 1:  31%|▎| 4/13 [00:19<00:23,  2.66s/batch, Loss: 1.2958 | in_mw_loss: 1.Epoch 1:  31%|▎| 4/13 [00:19<00:23,  2.66s/batch, Loss: 1.1852 | in_mw_loss: 1.Epoch 1:  38%|▍| 5/13 [00:19<00:14,  1.75s/batch, Loss: 1.1852 | in_mw_loss: 1.Epoch 1:  38%|▍| 5/13 [00:19<00:14,  1.75s/batch, Loss: 1.1890 | in_mw_loss: 1.Epoch 1:  46%|▍| 6/13 [00:19<00:08,  1.20s/batch, Loss: 1.1890 | in_mw_loss: 1.Epoch 1:  46%|▍| 6/13 [00:19<00:08,  1.20s/batch, Loss: 1.2098 | in_mw_loss: 1.Epoch 1:  54%|▌| 7/13 [00:19<00:05,  1.17batch/s, Loss: 1.2098 | in_mw_loss: 1.Epoch 1:  54%|▌| 7/13 [00:19<00:05,  1.17batch/s, Loss: 1.1506 | in_mw_loss: 1.Epoch 1:  62%|▌| 8/13 [00:19<00:03,  1.60batch/s, Loss: 1.1506 | in_mw_loss: 1.Epoch 1:  62%|▌| 8/13 [00:19<00:03,  1.60batch/s, Loss: 1.1751 | in_mw_loss: 1.Epoch 1:  69%|▋| 9/13 [00:19<00:01,  2.13batch/s, Loss: 1.1751 | in_mw_loss: 1.Epoch 1:  69%|▋| 9/13 [00:20<00:01,  2.13batch/s, Loss: 1.1621 | in_mw_loss: 1.Epoch 1:  77%|▊| 10/13 [00:20<00:01,  2.73batch/s, Loss: 1.1621 | in_mw_loss: 1Epoch 1:  77%|▊| 10/13 [00:20<00:01,  2.73batch/s, Loss: 1.1363 | in_mw_loss: 1Epoch 1:  85%|▊| 11/13 [00:20<00:00,  3.40batch/s, Loss: 1.1363 | in_mw_loss: 1Epoch 1:  85%|▊| 11/13 [00:20<00:00,  3.40batch/s, Loss: 1.0706 | in_mw_loss: 1Epoch 1:  92%|▉| 12/13 [00:20<00:00,  4.09batch/s, Loss: 1.0706 | in_mw_loss: 1Epoch 1:  92%|▉| 12/13 [00:20<00:00,  4.09batch/s, Loss: 1.0996 | in_mw_loss: 1Epoch 1: 100%|█| 13/13 [00:20<00:00,  4.89batch/s, Loss: 1.0996 | in_mw_loss: 1Epoch 1: 100%|█| 13/13 [00:20<00:00,  1.57s/batch, Loss: 1.0996 | in_mw_loss: 1
Epoch [  1/  2], Loss: 1.2596, in_mw_loss: 1.2596, out_mw_loss: 1.2596, learning_rate: 3.0000e-04
Epoch 2:   0%|                                       | 0/13 [00:00<?, ?batch/s]Epoch 2:   0%| | 0/13 [00:00<?, ?batch/s, Loss: 1.1072 | in_mw_loss: 1.1072 | oEpoch 2:   8%| | 1/13 [00:00<00:02,  4.47batch/s, Loss: 1.1072 | in_mw_loss: 1.Epoch 2:   8%| | 1/13 [00:00<00:02,  4.47batch/s, Loss: 1.0607 | in_mw_loss: 1.Epoch 2:  15%|▏| 2/13 [00:00<00:01,  5.98batch/s, Loss: 1.0607 | in_mw_loss: 1.Epoch 2:  15%|▏| 2/13 [00:00<00:01,  5.98batch/s, Loss: 1.1178 | in_mw_loss: 1.Epoch 2:  23%|▏| 3/13 [00:00<00:01,  6.60batch/s, Loss: 1.1178 | in_mw_loss: 1.Epoch 2:  23%|▏| 3/13 [00:00<00:01,  6.60batch/s, Loss: 1.1119 | in_mw_loss: 1.Epoch 2:  31%|▎| 4/13 [00:00<00:01,  7.06batch/s, Loss: 1.1119 | in_mw_loss: 1.Epoch 2:  31%|▎| 4/13 [00:00<00:01,  7.06batch/s, Loss: 1.0528 | in_mw_loss: 1.Epoch 2:  38%|▍| 5/13 [00:00<00:01,  7.24batch/s, Loss: 1.0528 | in_mw_loss: 1.Epoch 2:  38%|▍| 5/13 [00:00<00:01,  7.24batch/s, Loss: 1.1216 | in_mw_loss: 1.Epoch 2:  46%|▍| 6/13 [00:00<00:00,  7.38batch/s, Loss: 1.1216 | in_mw_loss: 1.Epoch 2:  46%|▍| 6/13 [00:01<00:00,  7.38batch/s, Loss: 1.1154 | in_mw_loss: 1.Epoch 2:  54%|▌| 7/13 [00:01<00:00,  7.53batch/s, Loss: 1.1154 | in_mw_loss: 1.Epoch 2:  54%|▌| 7/13 [00:01<00:00,  7.53batch/s, Loss: 1.0746 | in_mw_loss: 1.Epoch 2:  62%|▌| 8/13 [00:01<00:00,  7.60batch/s, Loss: 1.0746 | in_mw_loss: 1.Epoch 2:  62%|▌| 8/13 [00:01<00:00,  7.60batch/s, Loss: 1.0176 | in_mw_loss: 1.Epoch 2:  69%|▋| 9/13 [00:01<00:00,  7.66batch/s, Loss: 1.0176 | in_mw_loss: 1.Epoch 2:  69%|▋| 9/13 [00:01<00:00,  7.66batch/s, Loss: 0.9518 | in_mw_loss: 0.Epoch 2:  77%|▊| 10/13 [00:01<00:00,  7.65batch/s, Loss: 0.9518 | in_mw_loss: 0Epoch 2:  77%|▊| 10/13 [00:01<00:00,  7.65batch/s, Loss: 0.9839 | in_mw_loss: 0Epoch 2:  85%|▊| 11/13 [00:01<00:00,  7.55batch/s, Loss: 0.9839 | in_mw_loss: 0Epoch 2:  85%|▊| 11/13 [00:01<00:00,  7.55batch/s, Loss: 1.0620 | in_mw_loss: 1Epoch 2:  92%|▉| 12/13 [00:01<00:00,  7.52batch/s, Loss: 1.0620 | in_mw_loss: 1Epoch 2:  92%|▉| 12/13 [00:01<00:00,  7.52batch/s, Loss: 0.9851 | in_mw_loss: 0Epoch 2: 100%|█| 13/13 [00:01<00:00,  7.45batch/s, Loss: 0.9851 | in_mw_loss: 0
Epoch [  2/  2], Loss: 1.0562, in_mw_loss: 1.0562, out_mw_loss: 1.0562, learning_rate: 3.0000e-04
data_shape torch.Size([320, 1, 96, 96, 96])
predict:   0%|                                         | 0/160 [00:00<?, ?it/s]predict:   1%|▏                                | 1/160 [00:00<00:27,  5.87it/s]predict:   3%|█                                | 5/160 [00:00<00:07, 20.95it/s]predict:   6%|█▊                               | 9/160 [00:00<00:05, 27.78it/s]predict:   8%|██▌                             | 13/160 [00:00<00:04, 31.66it/s]predict:  11%|███▍                            | 17/160 [00:00<00:04, 33.73it/s]predict:  13%|████▏                           | 21/160 [00:00<00:03, 35.37it/s]predict:  16%|█████                           | 25/160 [00:00<00:03, 36.15it/s]predict:  18%|█████▊                          | 29/160 [00:00<00:03, 36.70it/s]predict:  21%|██████▌                         | 33/160 [00:01<00:03, 37.31it/s]predict:  23%|███████▍                        | 37/160 [00:01<00:03, 37.38it/s]predict:  26%|████████▏                       | 41/160 [00:01<00:03, 37.31it/s]predict:  28%|█████████                       | 45/160 [00:01<00:03, 37.50it/s]predict:  31%|█████████▊                      | 49/160 [00:01<00:02, 37.89it/s]predict:  33%|██████████▌                     | 53/160 [00:01<00:02, 38.18it/s]predict:  36%|███████████▍                    | 57/160 [00:01<00:02, 38.10it/s]predict:  38%|████████████▏                   | 61/160 [00:01<00:02, 38.12it/s]predict:  41%|█████████████                   | 65/160 [00:01<00:02, 38.13it/s]predict:  43%|█████████████▊                  | 69/160 [00:01<00:02, 38.27it/s]predict:  46%|██████████████▌                 | 73/160 [00:02<00:02, 38.12it/s]predict:  48%|███████████████▍                | 77/160 [00:02<00:02, 38.12it/s]predict:  51%|████████████████▏               | 81/160 [00:02<00:02, 38.34it/s]predict:  53%|█████████████████               | 85/160 [00:02<00:01, 38.43it/s]predict:  56%|█████████████████▊              | 89/160 [00:02<00:01, 38.57it/s]predict:  58%|██████████████████▌             | 93/160 [00:02<00:01, 38.46it/s]predict:  61%|███████████████████▍            | 97/160 [00:02<00:01, 38.16it/s]predict:  63%|███████████████████▌           | 101/160 [00:02<00:01, 37.87it/s]predict:  66%|████████████████████▎          | 105/160 [00:02<00:01, 37.95it/s]predict:  68%|█████████████████████          | 109/160 [00:02<00:01, 38.30it/s]predict:  71%|█████████████████████▉         | 113/160 [00:03<00:01, 38.33it/s]predict:  73%|██████████████████████▋        | 117/160 [00:03<00:01, 38.43it/s]predict:  76%|███████████████████████▍       | 121/160 [00:03<00:01, 38.45it/s]predict:  78%|████████████████████████▏      | 125/160 [00:03<00:00, 38.06it/s]predict:  81%|████████████████████████▉      | 129/160 [00:03<00:00, 37.95it/s]predict:  83%|█████████████████████████▊     | 133/160 [00:03<00:00, 38.09it/s]predict:  86%|██████████████████████████▌    | 137/160 [00:03<00:00, 37.98it/s]predict:  88%|███████████████████████████▎   | 141/160 [00:03<00:00, 37.83it/s]predict:  91%|████████████████████████████   | 145/160 [00:03<00:00, 37.81it/s]predict:  93%|████████████████████████████▊  | 149/160 [00:04<00:00, 38.04it/s]predict:  96%|█████████████████████████████▋ | 153/160 [00:04<00:00, 37.66it/s]predict:  98%|██████████████████████████████▍| 157/160 [00:04<00:00, 37.55it/s]predict: 100%|███████████████████████████████| 160/160 [00:04<00:00, 36.80it/s]
size restored (330, 522, 522)
Saved slices and power spectrum for epoch 2 to 'denoise'
training tomograms for 2 epochs, remaining epochs 4
Epoch 1:   0%|                                       | 0/13 [00:00<?, ?batch/s]Epoch 1:   0%|                                       | 0/13 [00:12<?, ?batch/s]
Exception ignored in: <function _MultiProcessingDataLoaderIter.__del__ at 0x7fed1dac5580>
Traceback (most recent call last):
  File "/home/cii/anaconda3/envs/torch_cuda12.6_glados_py3.13/lib/python3.13/site-packages/torch/utils/data/dataloader.py", line 1618, in __del__
Traceback (most recent call last):
  File "/home/cii/software/IsoNet2/IsoNet/bin/isonet.py", line 1080, in <module>
    exit(main())
         ~~~~^^
  File "/home/cii/software/IsoNet2/IsoNet/bin/isonet.py", line 1076, in main
    fire.Fire(ISONET)
    ~~~~~~~~~^^^^^^^^
  File "/home/cii/anaconda3/envs/torch_cuda12.6_glados_py3.13/lib/python3.13/site-packages/fire/core.py", line 135, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/home/cii/anaconda3/envs/torch_cuda12.6_glados_py3.13/lib/python3.13/site-packages/fire/core.py", line 468, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
                                ~~~~~~~~~~~~~~~~~~~^
        component,
        ^^^^^^^^^^
    ...<2 lines>...
        treatment='class' if is_class else 'routine',
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        target=component.__name__)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/cii/anaconda3/envs/torch_cuda12.6_glados_py3.13/lib/python3.13/site-packages/fire/core.py", line 684, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "/home/cii/software/IsoNet2/IsoNet/bin/isonet.py", line 604, in denoise
    network.train(training_params) #train based on init model and save new one as model_iter{num_iter}.h5
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/cii/software/IsoNet2/IsoNet/models/network.py", line 259, in train
    mp.spawn(ddp_train, args=(self.world_size, self.port_number, self.model, train_dataset, training_params), nprocs=self.world_size)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/cii/anaconda3/envs/torch_cuda12.6_glados_py3.13/lib/python3.13/site-packages/torch/multiprocessing/spawn.py", line 340, in spawn
    return start_processes(fn, args, nprocs, join, daemon, start_method="spawn")
  File "/home/cii/anaconda3/envs/torch_cuda12.6_glados_py3.13/lib/python3.13/site-packages/torch/multiprocessing/spawn.py", line 296, in start_processes
    while not context.join():
              ~~~~~~~~~~~~^^
  File "/home/cii/anaconda3/envs/torch_cuda12.6_glados_py3.13/lib/python3.13/site-packages/torch/multiprocessing/spawn.py", line 144, in join
    ready = multiprocessing.connection.wait(
        self.sentinels.keys(),
        timeout=timeout,
    )
  File "/home/cii/anaconda3/envs/torch_cuda12.6_glados_py3.13/lib/python3.13/multiprocessing/connection.py", line 1148, in wait
    ready = selector.select(timeout)
  File "/home/cii/anaconda3/envs/torch_cuda12.6_glados_py3.13/lib/python3.13/selectors.py", line 398, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt
Exception ignored in: <function _MultiProcessingDataLoaderIter.__del__ at 0x7f4c2f1c1580>
Traceback (most recent call last):
  File "/home/cii/anaconda3/envs/torch_cuda12.6_glados_py3.13/lib/python3.13/site-packages/torch/utils/data/dataloader.py", line 1618, in __del__
    self._shutdown_workers()
    self._shutdown_workers()
  File "/home/cii/anaconda3/envs/torch_cuda12.6_glados_py3.13/lib/python3.13/site-packages/torch/utils/data/dataloader.py", line 1577, in _shutdown_workers
  File "/home/cii/anaconda3/envs/torch_cuda12.6_glados_py3.13/lib/python3.13/site-packages/torch/utils/data/dataloader.py", line 1577, in _shutdown_workers
    self._mark_worker_as_unavailable(worker_id, shutdown=True)
  File "/home/cii/anaconda3/envs/torch_cuda12.6_glados_py3.13/lib/python3.13/site-packages/torch/utils/data/dataloader.py", line 1513, in _mark_worker_as_unavailable
    self._mark_worker_as_unavailable(worker_id, shutdown=True)
  File "/home/cii/anaconda3/envs/torch_cuda12.6_glados_py3.13/lib/python3.13/site-packages/torch/utils/data/dataloader.py", line 1513, in _mark_worker_as_unavailable
    assert self._workers_status[worker_id] or (
AttributeError: '_MultiProcessingDataLoaderIter' object has no attribute '_workers_status'
    assert self._workers_status[worker_id] or (
AttributeError: '_MultiProcessingDataLoaderIter' object has no attribute '_workers_status'
Traceback (most recent call last):
  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(tracker_fd=29, pipe_handle=41)
                                                  ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/cii/anaconda3/envs/torch_cuda12.6_glados_py3.13/lib/python3.13/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
  File "/home/cii/anaconda3/envs/torch_cuda12.6_glados_py3.13/lib/python3.13/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
    ~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/cii/anaconda3/envs/torch_cuda12.6_glados_py3.13/lib/python3.13/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/cii/anaconda3/envs/torch_cuda12.6_glados_py3.13/lib/python3.13/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                                  run_name="__mp_main__")
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/cii/software/IsoNet2/IsoNet/bin/isonet.py", line 22, in <module>
    from IsoNet.models.network import Net, DuoNet
  File "/home/cii/software/IsoNet2/IsoNet/models/network.py", line 2, in <module>
    import torch
  File "/home/cii/anaconda3/envs/torch_cuda12.6_glados_py3.13/lib/python3.13/site-packages/torch/__init__.py", line 1795, in <module>
    from torch._tensor import Tensor  # usort: skip
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/cii/anaconda3/envs/torch_cuda12.6_glados_py3.13/lib/python3.13/site-packages/torch/_tensor.py", line 21, in <module>
    from torch.overrides import (
    ...<5 lines>...
    )
  File "/home/cii/anaconda3/envs/torch_cuda12.6_glados_py3.13/lib/python3.13/site-packages/torch/overrides.py", line 1998, in <module>
    class TorchFunctionMode:
    ...<52 lines>...
            return instance
KeyboardInterrupt
Traceback (most recent call last):
  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(tracker_fd=29, pipe_handle=41)
                                                  ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/cii/anaconda3/envs/torch_cuda12.6_glados_py3.13/lib/python3.13/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
  File "/home/cii/anaconda3/envs/torch_cuda12.6_glados_py3.13/lib/python3.13/multiprocessing/spawn.py", line 131, in _main
    prepare(preparation_data)
    ~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/cii/anaconda3/envs/torch_cuda12.6_glados_py3.13/lib/python3.13/multiprocessing/spawn.py", line 246, in prepare
    _fixup_main_from_path(data['init_main_from_path'])
    ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/cii/anaconda3/envs/torch_cuda12.6_glados_py3.13/lib/python3.13/multiprocessing/spawn.py", line 297, in _fixup_main_from_path
    main_content = runpy.run_path(main_path,
                                  run_name="__mp_main__")
  File "<frozen runpy>", line 287, in run_path
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/home/cii/software/IsoNet2/IsoNet/bin/isonet.py", line 22, in <module>
    from IsoNet.models.network import Net, DuoNet
  File "/home/cii/software/IsoNet2/IsoNet/models/network.py", line 2, in <module>
    import torch
  File "/home/cii/anaconda3/envs/torch_cuda12.6_glados_py3.13/lib/python3.13/site-packages/torch/__init__.py", line 405, in <module>
    from torch._C import *  # noqa: F403
    ^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 463, in _lock_unlock_module
KeyboardInterrupt
[rank0]:[W718 21:50:00.449561530 ProcessGroupNCCL.cpp:1496] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
Process exited with code null
Command: isonet.py denoise --star_file tomograms.star --output_dir denoise --gpuID 0,1 --ncpus 16 --arch unet-medium --pretrained_model None --pretrained_model2 None --cube_size 96 --epochs 6 --input_column rlnTomoReconstructedTomogramHalf --batch_size None --acc_batches 1 --loss_func L2 --learning_rate 0.0003 --T_max 2 --learning_rate_min 0.0003 --compile_model False --mixed_precision True --CTF_mode None --isCTFflipped False --with_predict True --split_halves False --snrfalloff 0 --deconvstrength 1 --highpassnyquist 0.02
07-18 21:53:14, INFO     The denoise folder already exists, outputs will write into this folder
07-18 21:53:14, INFO     Port number: 52777
Total number of parameters: 23989825
Preprocess tomograms:   0%|                                                   | 0/5 [00:00<?, ?it/s]Preprocess tomograms:  20%|████████▌                                  | 1/5 [00:00<00:01,  2.74it/s]Preprocess tomograms:  40%|█████████████████▏                         | 2/5 [00:00<00:01,  2.75it/s]Preprocess tomograms:  60%|█████████████████████████▊                 | 3/5 [00:01<00:00,  2.76it/s]Preprocess tomograms:  80%|██████████████████████████████████▍        | 4/5 [00:01<00:00,  2.78it/s]Preprocess tomograms: 100%|███████████████████████████████████████████| 5/5 [00:01<00:00,  2.78it/s]Preprocess tomograms: 100%|███████████████████████████████████████████| 5/5 [00:01<00:00,  2.77it/s]
training tomograms for 2 epochs, remaining epochs 6
Epoch 1:   0%|                                       | 0/13 [00:00<?, ?batch/s]Epoch 1:   0%| | 0/13 [00:18<?, ?batch/s, Loss: 1.8307 | in_mw_loss: 1.8307 | oEpoch 1:   8%| | 1/13 [00:18<03:46, 18.84s/batch, Loss: 1.8307 | in_mw_loss: 1.Epoch 1:   8%| | 1/13 [00:18<03:46, 18.84s/batch, Loss: 1.6306 | in_mw_loss: 1.Epoch 1:  15%|▏| 2/13 [00:18<01:26,  7.84s/batch, Loss: 1.6306 | in_mw_loss: 1.Epoch 1:  15%|▏| 2/13 [00:19<01:26,  7.84s/batch, Loss: 1.3561 | in_mw_loss: 1.Epoch 1:  23%|▏| 3/13 [00:19<00:43,  4.32s/batch, Loss: 1.3561 | in_mw_loss: 1.Epoch 1:  23%|▏| 3/13 [00:19<00:43,  4.32s/batch, Loss: 1.3153 | in_mw_loss: 1.Epoch 1:  31%|▎| 4/13 [00:19<00:23,  2.67s/batch, Loss: 1.3153 | in_mw_loss: 1.Epoch 1:  31%|▎| 4/13 [00:19<00:23,  2.67s/batch, Loss: 1.1735 | in_mw_loss: 1.Epoch 1:  38%|▍| 5/13 [00:19<00:14,  1.75s/batch, Loss: 1.1735 | in_mw_loss: 1.Epoch 1:  38%|▍| 5/13 [00:19<00:14,  1.75s/batch, Loss: 1.1461 | in_mw_loss: 1.Epoch 1:  46%|▍| 6/13 [00:19<00:08,  1.20s/batch, Loss: 1.1461 | in_mw_loss: 1.Epoch 1:  46%|▍| 6/13 [00:19<00:08,  1.20s/batch, Loss: 1.2069 | in_mw_loss: 1.Epoch 1:  54%|▌| 7/13 [00:19<00:05,  1.17batch/s, Loss: 1.2069 | in_mw_loss: 1.Epoch 1:  54%|▌| 7/13 [00:19<00:05,  1.17batch/s, Loss: 1.1253 | in_mw_loss: 1.Epoch 1:  62%|▌| 8/13 [00:19<00:03,  1.61batch/s, Loss: 1.1253 | in_mw_loss: 1.Epoch 1:  62%|▌| 8/13 [00:19<00:03,  1.61batch/s, Loss: 1.1890 | in_mw_loss: 1.Epoch 1:  69%|▋| 9/13 [00:19<00:01,  2.14batch/s, Loss: 1.1890 | in_mw_loss: 1.Epoch 1:  69%|▋| 9/13 [00:20<00:01,  2.14batch/s, Loss: 1.0802 | in_mw_loss: 1.Epoch 1:  77%|▊| 10/13 [00:20<00:01,  2.75batch/s, Loss: 1.0802 | in_mw_loss: 1Epoch 1:  77%|▊| 10/13 [00:20<00:01,  2.75batch/s, Loss: 1.1272 | in_mw_loss: 1Epoch 1:  85%|▊| 11/13 [00:20<00:00,  3.44batch/s, Loss: 1.1272 | in_mw_loss: 1Epoch 1:  85%|▊| 11/13 [00:20<00:00,  3.44batch/s, Loss: 1.0633 | in_mw_loss: 1Epoch 1:  92%|▉| 12/13 [00:20<00:00,  4.12batch/s, Loss: 1.0633 | in_mw_loss: 1Epoch 1:  92%|▉| 12/13 [00:20<00:00,  4.12batch/s, Loss: 1.0932 | in_mw_loss: 1Epoch 1: 100%|█| 13/13 [00:20<00:00,  4.91batch/s, Loss: 1.0932 | in_mw_loss: 1Epoch 1: 100%|█| 13/13 [00:20<00:00,  1.57s/batch, Loss: 1.0932 | in_mw_loss: 1
Epoch [  1/  2], Loss: 1.2575, in_mw_loss: 1.2575, out_mw_loss: 1.2575, learning_rate: 3.0000e-04
Epoch 2:   0%|                                       | 0/13 [00:00<?, ?batch/s]Epoch 2:   0%| | 0/13 [00:00<?, ?batch/s, Loss: 1.0761 | in_mw_loss: 1.0761 | oEpoch 2:   8%| | 1/13 [00:00<00:02,  4.83batch/s, Loss: 1.0761 | in_mw_loss: 1.Epoch 2:   8%| | 1/13 [00:00<00:02,  4.83batch/s, Loss: 1.0337 | in_mw_loss: 1.Epoch 2:  15%|▏| 2/13 [00:00<00:01,  6.16batch/s, Loss: 1.0337 | in_mw_loss: 1.Epoch 2:  15%|▏| 2/13 [00:00<00:01,  6.16batch/s, Loss: 1.1458 | in_mw_loss: 1.Epoch 2:  23%|▏| 3/13 [00:00<00:01,  6.82batch/s, Loss: 1.1458 | in_mw_loss: 1.Epoch 2:  23%|▏| 3/13 [00:00<00:01,  6.82batch/s, Loss: 1.1012 | in_mw_loss: 1.Epoch 2:  31%|▎| 4/13 [00:00<00:01,  7.14batch/s, Loss: 1.1012 | in_mw_loss: 1.Epoch 2:  31%|▎| 4/13 [00:00<00:01,  7.14batch/s, Loss: 1.0417 | in_mw_loss: 1.Epoch 2:  38%|▍| 5/13 [00:00<00:01,  7.33batch/s, Loss: 1.0417 | in_mw_loss: 1.Epoch 2:  38%|▍| 5/13 [00:00<00:01,  7.33batch/s, Loss: 1.0649 | in_mw_loss: 1.Epoch 2:  46%|▍| 6/13 [00:00<00:00,  7.47batch/s, Loss: 1.0649 | in_mw_loss: 1.Epoch 2:  46%|▍| 6/13 [00:00<00:00,  7.47batch/s, Loss: 1.0730 | in_mw_loss: 1.Epoch 2:  54%|▌| 7/13 [00:00<00:00,  7.56batch/s, Loss: 1.0730 | in_mw_loss: 1.Epoch 2:  54%|▌| 7/13 [00:01<00:00,  7.56batch/s, Loss: 1.0736 | in_mw_loss: 1.Epoch 2:  62%|▌| 8/13 [00:01<00:00,  7.62batch/s, Loss: 1.0736 | in_mw_loss: 1.Epoch 2:  62%|▌| 8/13 [00:01<00:00,  7.62batch/s, Loss: 0.9173 | in_mw_loss: 0.Epoch 2:  69%|▋| 9/13 [00:01<00:00,  7.65batch/s, Loss: 0.9173 | in_mw_loss: 0.Epoch 2:  69%|▋| 9/13 [00:01<00:00,  7.65batch/s, Loss: 1.0140 | in_mw_loss: 1.Epoch 2:  77%|▊| 10/13 [00:01<00:00,  7.68batch/s, Loss: 1.0140 | in_mw_loss: 1Epoch 2:  77%|▊| 10/13 [00:01<00:00,  7.68batch/s, Loss: 0.9663 | in_mw_loss: 0Epoch 2:  85%|▊| 11/13 [00:01<00:00,  7.71batch/s, Loss: 0.9663 | in_mw_loss: 0Epoch 2:  85%|▊| 11/13 [00:01<00:00,  7.71batch/s, Loss: 1.0202 | in_mw_loss: 1Epoch 2:  92%|▉| 12/13 [00:01<00:00,  7.70batch/s, Loss: 1.0202 | in_mw_loss: 1Epoch 2:  92%|▉| 12/13 [00:01<00:00,  7.70batch/s, Loss: 0.9668 | in_mw_loss: 0Epoch 2: 100%|█| 13/13 [00:01<00:00,  7.58batch/s, Loss: 0.9668 | in_mw_loss: 0
Epoch [  2/  2], Loss: 1.0450, in_mw_loss: 1.0450, out_mw_loss: 1.0450, learning_rate: 3.0000e-04
data_shape torch.Size([320, 1, 96, 96, 96])
predict:   0%|                                         | 0/160 [00:00<?, ?it/s]predict:   1%|▏                                | 1/160 [00:00<00:25,  6.27it/s]predict:   3%|█                                | 5/160 [00:00<00:07, 21.57it/s]predict:   6%|█▊                               | 9/160 [00:00<00:05, 28.41it/s]predict:   8%|██▌                             | 13/160 [00:00<00:04, 31.78it/s]predict:  11%|███▍                            | 17/160 [00:00<00:04, 33.89it/s]predict:  13%|████▏                           | 21/160 [00:00<00:03, 35.33it/s]predict:  16%|█████                           | 25/160 [00:00<00:03, 36.37it/s]predict:  18%|█████▊                          | 29/160 [00:00<00:03, 36.90it/s]predict:  21%|██████▌                         | 33/160 [00:00<00:03, 37.51it/s]predict:  23%|███████▍                        | 37/160 [00:01<00:03, 37.40it/s]predict:  26%|████████▏                       | 41/160 [00:01<00:03, 37.30it/s]predict:  28%|█████████                       | 45/160 [00:01<00:03, 37.47it/s]predict:  31%|█████████▊                      | 49/160 [00:01<00:02, 37.77it/s]predict:  33%|██████████▌                     | 53/160 [00:01<00:02, 37.95it/s]predict:  36%|███████████▍                    | 57/160 [00:01<00:02, 38.16it/s]predict:  38%|████████████▏                   | 61/160 [00:01<00:02, 38.25it/s]predict:  41%|█████████████                   | 65/160 [00:01<00:02, 38.18it/s]predict:  43%|█████████████▊                  | 69/160 [00:01<00:02, 37.67it/s]predict:  46%|██████████████▌                 | 73/160 [00:02<00:02, 37.80it/s]predict:  48%|███████████████▍                | 77/160 [00:02<00:02, 38.12it/s]predict:  51%|████████████████▏               | 81/160 [00:02<00:02, 37.89it/s]predict:  53%|█████████████████               | 85/160 [00:02<00:01, 37.66it/s]predict:  56%|█████████████████▊              | 89/160 [00:02<00:01, 37.49it/s]predict:  58%|██████████████████▌             | 93/160 [00:02<00:01, 37.50it/s]predict:  61%|███████████████████▍            | 97/160 [00:02<00:01, 37.60it/s]predict:  63%|███████████████████▌           | 101/160 [00:02<00:01, 37.87it/s]predict:  66%|████████████████████▎          | 105/160 [00:02<00:01, 37.88it/s]predict:  68%|█████████████████████          | 109/160 [00:03<00:01, 37.75it/s]predict:  71%|█████████████████████▉         | 113/160 [00:03<00:01, 37.63it/s]predict:  73%|██████████████████████▋        | 117/160 [00:03<00:01, 37.98it/s]predict:  76%|███████████████████████▍       | 121/160 [00:03<00:01, 37.91it/s]predict:  78%|████████████████████████▏      | 125/160 [00:03<00:00, 38.20it/s]predict:  81%|████████████████████████▉      | 129/160 [00:03<00:00, 38.01it/s]predict:  83%|█████████████████████████▊     | 133/160 [00:03<00:00, 37.49it/s]predict:  86%|██████████████████████████▌    | 137/160 [00:03<00:00, 37.23it/s]predict:  88%|███████████████████████████▎   | 141/160 [00:03<00:00, 37.34it/s]predict:  91%|████████████████████████████   | 145/160 [00:03<00:00, 37.36it/s]predict:  93%|████████████████████████████▊  | 149/160 [00:04<00:00, 37.50it/s]predict:  96%|█████████████████████████████▋ | 153/160 [00:04<00:00, 37.82it/s]predict:  98%|██████████████████████████████▍| 157/160 [00:04<00:00, 38.19it/s]predict: 100%|███████████████████████████████| 160/160 [00:04<00:00, 36.73it/s]
size restored (330, 522, 522)
Saved slices and power spectrum for epoch 2 to 'denoise'
training tomograms for 2 epochs, remaining epochs 4
Epoch 1:   0%|                                       | 0/13 [00:00<?, ?batch/s]Epoch 1:   0%| | 0/13 [00:19<?, ?batch/s, Loss: 1.8305 | in_mw_loss: 1.8305 | oEpoch 1:   8%| | 1/13 [00:19<03:49, 19.14s/batch, Loss: 1.8305 | in_mw_loss: 1.Epoch 1:   8%| | 1/13 [00:19<03:49, 19.14s/batch, Loss: 1.6318 | in_mw_loss: 1.Epoch 1:  15%|▏| 2/13 [00:19<01:27,  7.96s/batch, Loss: 1.6318 | in_mw_loss: 1.Epoch 1:  15%|▏| 2/13 [00:19<01:27,  7.96s/batch, Loss: 1.3541 | in_mw_loss: 1.Epoch 1:  23%|▏| 3/13 [00:19<00:43,  4.39s/batch, Loss: 1.3541 | in_mw_loss: 1.Epoch 1:  23%|▏| 3/13 [00:19<00:43,  4.39s/batch, Loss: 1.3157 | in_mw_loss: 1.Epoch 1:  31%|▎| 4/13 [00:19<00:24,  2.71s/batch, Loss: 1.3157 | in_mw_loss: 1.Epoch 1:  31%|▎| 4/13 [00:19<00:24,  2.71s/batch, Loss: 1.1737 | in_mw_loss: 1.Epoch 1:  38%|▍| 5/13 [00:19<00:14,  1.78s/batch, Loss: 1.1737 | in_mw_loss: 1.Epoch 1:  38%|▍| 5/13 [00:19<00:14,  1.78s/batch, Loss: 1.1472 | in_mw_loss: 1.Epoch 1:  46%|▍| 6/13 [00:19<00:08,  1.22s/batch, Loss: 1.1472 | in_mw_loss: 1.Epoch 1:  46%|▍| 6/13 [00:19<00:08,  1.22s/batch, Loss: 1.2052 | in_mw_loss: 1.Epoch 1:  54%|▌| 7/13 [00:19<00:05,  1.16batch/s, Loss: 1.2052 | in_mw_loss: 1.Epoch 1:  54%|▌| 7/13 [00:20<00:05,  1.16batch/s, Loss: 1.1254 | in_mw_loss: 1.Epoch 1:  62%|▌| 8/13 [00:20<00:03,  1.58batch/s, Loss: 1.1254 | in_mw_loss: 1.Epoch 1:  62%|▌| 8/13 [00:20<00:03,  1.58batch/s, Loss: 1.1891 | in_mw_loss: 1.Epoch 1:  69%|▋| 9/13 [00:20<00:01,  2.10batch/s, Loss: 1.1891 | in_mw_loss: 1.Epoch 1:  69%|▋| 9/13 [00:20<00:01,  2.10batch/s, Loss: 1.0800 | in_mw_loss: 1.Epoch 1:  77%|▊| 10/13 [00:20<00:01,  2.71batch/s, Loss: 1.0800 | in_mw_loss: 1Epoch 1:  77%|▊| 10/13 [00:20<00:01,  2.71batch/s, Loss: 1.1271 | in_mw_loss: 1Epoch 1:  85%|▊| 11/13 [00:20<00:00,  3.38batch/s, Loss: 1.1271 | in_mw_loss: 1Epoch 1:  85%|▊| 11/13 [00:20<00:00,  3.38batch/s, Loss: 1.0642 | in_mw_loss: 1Epoch 1:  92%|▉| 12/13 [00:20<00:00,  4.05batch/s, Loss: 1.0642 | in_mw_loss: 1Epoch 1:  92%|▉| 12/13 [00:20<00:00,  4.05batch/s, Loss: 1.0934 | in_mw_loss: 1Epoch 1: 100%|█| 13/13 [00:20<00:00,  4.82batch/s, Loss: 1.0934 | in_mw_loss: 1Epoch 1: 100%|█| 13/13 [00:20<00:00,  1.59s/batch, Loss: 1.0934 | in_mw_loss: 1
Epoch [  1/  2], Loss: 1.2575, in_mw_loss: 1.2575, out_mw_loss: 1.2575, learning_rate: 3.0000e-04
Epoch 2:   0%|                                       | 0/13 [00:00<?, ?batch/s]Epoch 2:   0%| | 0/13 [00:00<?, ?batch/s, Loss: 1.0755 | in_mw_loss: 1.0755 | oEpoch 2:   8%| | 1/13 [00:00<00:03,  3.71batch/s, Loss: 1.0755 | in_mw_loss: 1.Epoch 2:   8%| | 1/13 [00:00<00:03,  3.71batch/s, Loss: 1.0381 | in_mw_loss: 1.Epoch 2:  15%|▏| 2/13 [00:00<00:02,  5.31batch/s, Loss: 1.0381 | in_mw_loss: 1.Epoch 2:  15%|▏| 2/13 [00:00<00:02,  5.31batch/s, Loss: 1.1452 | in_mw_loss: 1.Epoch 2:  23%|▏| 3/13 [00:00<00:01,  6.18batch/s, Loss: 1.1452 | in_mw_loss: 1.Epoch 2:  23%|▏| 3/13 [00:00<00:01,  6.18batch/s, Loss: 1.1017 | in_mw_loss: 1.Epoch 2:  31%|▎| 4/13 [00:00<00:01,  6.66batch/s, Loss: 1.1017 | in_mw_loss: 1.Epoch 2:  31%|▎| 4/13 [00:00<00:01,  6.66batch/s, Loss: 1.0416 | in_mw_loss: 1.Epoch 2:  38%|▍| 5/13 [00:00<00:01,  6.96batch/s, Loss: 1.0416 | in_mw_loss: 1.Epoch 2:  38%|▍| 5/13 [00:00<00:01,  6.96batch/s, Loss: 1.0642 | in_mw_loss: 1.Epoch 2:  46%|▍| 6/13 [00:00<00:00,  7.14batch/s, Loss: 1.0642 | in_mw_loss: 1.Epoch 2:  46%|▍| 6/13 [00:01<00:00,  7.14batch/s, Loss: 1.0733 | in_mw_loss: 1.Epoch 2:  54%|▌| 7/13 [00:01<00:00,  7.29batch/s, Loss: 1.0733 | in_mw_loss: 1.Epoch 2:  54%|▌| 7/13 [00:01<00:00,  7.29batch/s, Loss: 1.0732 | in_mw_loss: 1.Epoch 2:  62%|▌| 8/13 [00:01<00:00,  7.46batch/s, Loss: 1.0732 | in_mw_loss: 1.Epoch 2:  62%|▌| 8/13 [00:01<00:00,  7.46batch/s, Loss: 0.9180 | in_mw_loss: 0.Epoch 2:  69%|▋| 9/13 [00:01<00:00,  7.48batch/s, Loss: 0.9180 | in_mw_loss: 0.Epoch 2:  69%|▋| 9/13 [00:01<00:00,  7.48batch/s, Loss: 1.0141 | in_mw_loss: 1.Epoch 2:  77%|▊| 10/13 [00:01<00:00,  7.50batch/s, Loss: 1.0141 | in_mw_loss: 1Epoch 2:  77%|▊| 10/13 [00:01<00:00,  7.50batch/s, Loss: 0.9636 | in_mw_loss: 0Epoch 2:  85%|▊| 11/13 [00:01<00:00,  7.55batch/s, Loss: 0.9636 | in_mw_loss: 0Epoch 2:  85%|▊| 11/13 [00:01<00:00,  7.55batch/s, Loss: 1.0193 | in_mw_loss: 1Epoch 2:  92%|▉| 12/13 [00:01<00:00,  7.63batch/s, Loss: 1.0193 | in_mw_loss: 1Epoch 2:  92%|▉| 12/13 [00:01<00:00,  7.63batch/s, Loss: 0.9701 | in_mw_loss: 0Epoch 2: 100%|█| 13/13 [00:01<00:00,  7.23batch/s, Loss: 0.9701 | in_mw_loss: 0
Epoch [  2/  2], Loss: 1.0451, in_mw_loss: 1.0451, out_mw_loss: 1.0451, learning_rate: 3.0000e-04
data_shape torch.Size([320, 1, 96, 96, 96])
predict:   0%|                                         | 0/160 [00:00<?, ?it/s]predict:   1%|▏                                | 1/160 [00:00<00:25,  6.31it/s]predict:   3%|█                                | 5/160 [00:00<00:07, 21.85it/s]predict:   6%|█▊                               | 9/160 [00:00<00:05, 28.64it/s]predict:   8%|██▌                             | 13/160 [00:00<00:04, 32.44it/s]predict:  11%|███▍                            | 17/160 [00:00<00:04, 34.60it/s]predict:  13%|████▏                           | 21/160 [00:00<00:03, 35.83it/s]predict:  16%|█████                           | 25/160 [00:00<00:03, 36.71it/s]predict:  18%|█████▊                          | 29/160 [00:00<00:03, 37.08it/s]predict:  21%|██████▌                         | 33/160 [00:00<00:03, 37.56it/s]predict:  23%|███████▍                        | 37/160 [00:01<00:03, 37.96it/s]predict:  26%|████████▏                       | 41/160 [00:01<00:03, 38.25it/s]predict:  28%|█████████                       | 45/160 [00:01<00:02, 38.37it/s]predict:  31%|█████████▊                      | 49/160 [00:01<00:02, 38.37it/s]predict:  33%|██████████▌                     | 53/160 [00:01<00:02, 38.57it/s]predict:  36%|███████████▍                    | 57/160 [00:01<00:02, 38.41it/s]predict:  38%|████████████▏                   | 61/160 [00:01<00:02, 38.41it/s]predict:  41%|█████████████                   | 65/160 [00:01<00:02, 38.56it/s]predict:  43%|█████████████▊                  | 69/160 [00:01<00:02, 38.55it/s]predict:  46%|██████████████▌                 | 73/160 [00:02<00:02, 38.62it/s]predict:  48%|███████████████▍                | 77/160 [00:02<00:02, 38.69it/s]predict:  51%|████████████████▏               | 81/160 [00:02<00:02, 38.66it/s]predict:  53%|█████████████████               | 85/160 [00:02<00:01, 38.32it/s]predict:  56%|█████████████████▊              | 89/160 [00:02<00:01, 38.44it/s]predict:  58%|██████████████████▌             | 93/160 [00:02<00:01, 38.68it/s]predict:  61%|███████████████████▍            | 97/160 [00:02<00:01, 38.70it/s]predict:  63%|███████████████████▌           | 101/160 [00:02<00:01, 38.66it/s]predict:  66%|████████████████████▎          | 105/160 [00:02<00:01, 38.77it/s]predict:  68%|█████████████████████          | 109/160 [00:02<00:01, 38.87it/s]predict:  71%|█████████████████████▉         | 113/160 [00:03<00:01, 38.96it/s]predict:  73%|██████████████████████▋        | 117/160 [00:03<00:01, 39.03it/s]predict:  76%|███████████████████████▍       | 121/160 [00:03<00:00, 39.04it/s]predict:  78%|████████████████████████▏      | 125/160 [00:03<00:00, 38.87it/s]predict:  81%|████████████████████████▉      | 129/160 [00:03<00:00, 38.91it/s]predict:  83%|█████████████████████████▊     | 133/160 [00:03<00:00, 39.00it/s]predict:  86%|██████████████████████████▌    | 137/160 [00:03<00:00, 38.85it/s]predict:  88%|███████████████████████████▎   | 141/160 [00:03<00:00, 38.83it/s]predict:  91%|████████████████████████████   | 145/160 [00:03<00:00, 38.90it/s]predict:  93%|████████████████████████████▊  | 149/160 [00:03<00:00, 38.91it/s]predict:  96%|█████████████████████████████▋ | 153/160 [00:04<00:00, 38.77it/s]predict:  98%|██████████████████████████████▍| 157/160 [00:04<00:00, 38.30it/s]predict: 100%|███████████████████████████████| 160/160 [00:04<00:00, 37.46it/s]
size restored (330, 522, 522)
Saved slices and power spectrum for epoch 4 to 'denoise'
training tomograms for 2 epochs, remaining epochs 2
Epoch 1:   0%|                                       | 0/13 [00:00<?, ?batch/s]Epoch 1:   0%| | 0/13 [00:19<?, ?batch/s, Loss: 1.8296 | in_mw_loss: 1.8296 | oEpoch 1:   8%| | 1/13 [00:19<03:54, 19.57s/batch, Loss: 1.8296 | in_mw_loss: 1.Epoch 1:   8%| | 1/13 [00:19<03:54, 19.57s/batch, Loss: 1.6297 | in_mw_loss: 1.Epoch 1:  15%|▏| 2/13 [00:19<01:29,  8.14s/batch, Loss: 1.6297 | in_mw_loss: 1.Epoch 1:  15%|▏| 2/13 [00:19<01:29,  8.14s/batch, Loss: 1.3540 | in_mw_loss: 1.Epoch 1:  23%|▏| 3/13 [00:19<00:44,  4.48s/batch, Loss: 1.3540 | in_mw_loss: 1.Epoch 1:  23%|▏| 3/13 [00:19<00:44,  4.48s/batch, Loss: 1.3139 | in_mw_loss: 1.Epoch 1:  31%|▎| 4/13 [00:19<00:24,  2.76s/batch, Loss: 1.3139 | in_mw_loss: 1.Epoch 1:  31%|▎| 4/13 [00:20<00:24,  2.76s/batch, Loss: 1.1733 | in_mw_loss: 1.Epoch 1:  38%|▍| 5/13 [00:20<00:14,  1.81s/batch, Loss: 1.1733 | in_mw_loss: 1.Epoch 1:  38%|▍| 5/13 [00:20<00:14,  1.81s/batch, Loss: 1.1449 | in_mw_loss: 1.Epoch 1:  46%|▍| 6/13 [00:20<00:08,  1.24s/batch, Loss: 1.1449 | in_mw_loss: 1.Epoch 1:  46%|▍| 6/13 [00:20<00:08,  1.24s/batch, Loss: 1.2040 | in_mw_loss: 1.Epoch 1:  54%|▌| 7/13 [00:20<00:05,  1.14batch/s, Loss: 1.2040 | in_mw_loss: 1.Epoch 1:  54%|▌| 7/13 [00:20<00:05,  1.14batch/s, Loss: 1.1269 | in_mw_loss: 1.Epoch 1:  62%|▌| 8/13 [00:20<00:03,  1.56batch/s, Loss: 1.1269 | in_mw_loss: 1.Epoch 1:  62%|▌| 8/13 [00:20<00:03,  1.56batch/s, Loss: 1.1850 | in_mw_loss: 1.Epoch 1:  69%|▋| 9/13 [00:20<00:01,  2.08batch/s, Loss: 1.1850 | in_mw_loss: 1.Epoch 1:  69%|▋| 9/13 [00:20<00:01,  2.08batch/s, Loss: 1.0795 | in_mw_loss: 1.Epoch 1:  77%|▊| 10/13 [00:20<00:01,  2.68batch/s, Loss: 1.0795 | in_mw_loss: 1Epoch 1:  77%|▊| 10/13 [00:20<00:01,  2.68batch/s, Loss: 1.1280 | in_mw_loss: 1Epoch 1:  85%|▊| 11/13 [00:20<00:00,  3.36batch/s, Loss: 1.1280 | in_mw_loss: 1Epoch 1:  85%|▊| 11/13 [00:21<00:00,  3.36batch/s, Loss: 1.0627 | in_mw_loss: 1Epoch 1:  92%|▉| 12/13 [00:21<00:00,  4.07batch/s, Loss: 1.0627 | in_mw_loss: 1Epoch 1:  92%|▉| 12/13 [00:21<00:00,  4.07batch/s, Loss: 1.0925 | in_mw_loss: 1Epoch 1: 100%|█| 13/13 [00:21<00:00,  4.89batch/s, Loss: 1.0925 | in_mw_loss: 1Epoch 1: 100%|█| 13/13 [00:21<00:00,  1.62s/batch, Loss: 1.0925 | in_mw_loss: 1
Epoch [  1/  2], Loss: 1.2565, in_mw_loss: 1.2565, out_mw_loss: 1.2565, learning_rate: 3.0000e-04
Epoch 2:   0%|                                       | 0/13 [00:00<?, ?batch/s]Epoch 2:   0%| | 0/13 [00:00<?, ?batch/s, Loss: 1.0746 | in_mw_loss: 1.0746 | oEpoch 2:   8%| | 1/13 [00:00<00:03,  3.66batch/s, Loss: 1.0746 | in_mw_loss: 1.Epoch 2:   8%| | 1/13 [00:00<00:03,  3.66batch/s, Loss: 1.0349 | in_mw_loss: 1.Epoch 2:  15%|▏| 2/13 [00:00<00:02,  5.25batch/s, Loss: 1.0349 | in_mw_loss: 1.Epoch 2:  15%|▏| 2/13 [00:00<00:02,  5.25batch/s, Loss: 1.1449 | in_mw_loss: 1.Epoch 2:  23%|▏| 3/13 [00:00<00:01,  6.18batch/s, Loss: 1.1449 | in_mw_loss: 1.Epoch 2:  23%|▏| 3/13 [00:00<00:01,  6.18batch/s, Loss: 1.1022 | in_mw_loss: 1.Epoch 2:  31%|▎| 4/13 [00:00<00:01,  6.71batch/s, Loss: 1.1022 | in_mw_loss: 1.Epoch 2:  31%|▎| 4/13 [00:00<00:01,  6.71batch/s, Loss: 1.0413 | in_mw_loss: 1.Epoch 2:  38%|▍| 5/13 [00:00<00:01,  7.10batch/s, Loss: 1.0413 | in_mw_loss: 1.Epoch 2:  38%|▍| 5/13 [00:00<00:01,  7.10batch/s, Loss: 1.0664 | in_mw_loss: 1.Epoch 2:  46%|▍| 6/13 [00:00<00:00,  7.34batch/s, Loss: 1.0664 | in_mw_loss: 1.Epoch 2:  46%|▍| 6/13 [00:01<00:00,  7.34batch/s, Loss: 1.0724 | in_mw_loss: 1.Epoch 2:  54%|▌| 7/13 [00:01<00:00,  7.50batch/s, Loss: 1.0724 | in_mw_loss: 1.Epoch 2:  54%|▌| 7/13 [00:01<00:00,  7.50batch/s, Loss: 1.0724 | in_mw_loss: 1.Epoch 2:  62%|▌| 8/13 [00:01<00:00,  7.63batch/s, Loss: 1.0724 | in_mw_loss: 1.Epoch 2:  62%|▌| 8/13 [00:01<00:00,  7.63batch/s, Loss: 0.9166 | in_mw_loss: 0.Epoch 2:  69%|▋| 9/13 [00:01<00:00,  7.72batch/s, Loss: 0.9166 | in_mw_loss: 0.Epoch 2:  69%|▋| 9/13 [00:01<00:00,  7.72batch/s, Loss: 1.0138 | in_mw_loss: 1.Epoch 2:  77%|▊| 10/13 [00:01<00:00,  7.68batch/s, Loss: 1.0138 | in_mw_loss: 1Epoch 2:  77%|▊| 10/13 [00:01<00:00,  7.68batch/s, Loss: 0.9647 | in_mw_loss: 0Epoch 2:  85%|▊| 11/13 [00:01<00:00,  7.60batch/s, Loss: 0.9647 | in_mw_loss: 0Epoch 2:  85%|▊| 11/13 [00:01<00:00,  7.60batch/s, Loss: 1.0197 | in_mw_loss: 1Epoch 2:  92%|▉| 12/13 [00:01<00:00,  7.59batch/s, Loss: 1.0197 | in_mw_loss: 1Epoch 2:  92%|▉| 12/13 [00:01<00:00,  7.59batch/s, Loss: 0.9663 | in_mw_loss: 0Epoch 2: 100%|█| 13/13 [00:01<00:00,  7.29batch/s, Loss: 0.9663 | in_mw_loss: 0
Epoch [  2/  2], Loss: 1.0445, in_mw_loss: 1.0445, out_mw_loss: 1.0445, learning_rate: 3.0000e-04
data_shape torch.Size([320, 1, 96, 96, 96])
predict:   0%|                                         | 0/160 [00:00<?, ?it/s]predict:   1%|▏                                | 1/160 [00:00<00:25,  6.36it/s]predict:   3%|█                                | 5/160 [00:00<00:07, 21.77it/s]predict:   6%|█▊                               | 9/160 [00:00<00:05, 28.65it/s]predict:   8%|██▌                             | 13/160 [00:00<00:04, 32.46it/s]predict:  11%|███▍                            | 17/160 [00:00<00:04, 34.64it/s]predict:  13%|████▏                           | 21/160 [00:00<00:03, 35.70it/s]predict:  16%|█████                           | 25/160 [00:00<00:03, 36.49it/s]predict:  18%|█████▊                          | 29/160 [00:00<00:03, 37.18it/s]predict:  21%|██████▌                         | 33/160 [00:00<00:03, 37.70it/s]predict:  23%|███████▍                        | 37/160 [00:01<00:03, 37.78it/s]predict:  26%|████████▏                       | 41/160 [00:01<00:03, 38.01it/s]predict:  28%|█████████                       | 45/160 [00:01<00:03, 37.78it/s]predict:  31%|█████████▊                      | 49/160 [00:01<00:02, 38.04it/s]predict:  33%|██████████▌                     | 53/160 [00:01<00:02, 38.35it/s]predict:  36%|███████████▍                    | 57/160 [00:01<00:02, 38.48it/s]predict:  38%|████████████▏                   | 61/160 [00:01<00:02, 38.52it/s]predict:  41%|█████████████                   | 65/160 [00:01<00:02, 38.53it/s]predict:  43%|█████████████▊                  | 69/160 [00:01<00:02, 38.60it/s]predict:  46%|██████████████▌                 | 73/160 [00:02<00:02, 38.65it/s]predict:  48%|███████████████▍                | 77/160 [00:02<00:02, 38.78it/s]predict:  51%|████████████████▏               | 81/160 [00:02<00:02, 38.76it/s]predict:  53%|█████████████████               | 85/160 [00:02<00:01, 38.62it/s]predict:  56%|█████████████████▊              | 89/160 [00:02<00:01, 38.69it/s]predict:  58%|██████████████████▌             | 93/160 [00:02<00:01, 38.82it/s]predict:  61%|███████████████████▍            | 97/160 [00:02<00:01, 38.74it/s]predict:  63%|███████████████████▌           | 101/160 [00:02<00:01, 38.44it/s]predict:  66%|████████████████████▎          | 105/160 [00:02<00:01, 38.30it/s]predict:  68%|█████████████████████          | 109/160 [00:02<00:01, 38.47it/s]predict:  71%|█████████████████████▉         | 113/160 [00:03<00:01, 38.66it/s]predict:  73%|██████████████████████▋        | 117/160 [00:03<00:01, 38.77it/s]predict:  76%|███████████████████████▍       | 121/160 [00:03<00:01, 38.69it/s]predict:  78%|████████████████████████▏      | 125/160 [00:03<00:00, 38.35it/s]predict:  81%|████████████████████████▉      | 129/160 [00:03<00:00, 38.49it/s]predict:  83%|█████████████████████████▊     | 133/160 [00:03<00:00, 38.65it/s]predict:  86%|██████████████████████████▌    | 137/160 [00:03<00:00, 38.66it/s]predict:  88%|███████████████████████████▎   | 141/160 [00:03<00:00, 38.67it/s]predict:  91%|████████████████████████████   | 145/160 [00:03<00:00, 38.76it/s]predict:  93%|████████████████████████████▊  | 149/160 [00:03<00:00, 38.79it/s]predict:  96%|█████████████████████████████▋ | 153/160 [00:04<00:00, 38.80it/s]predict:  98%|██████████████████████████████▍| 157/160 [00:04<00:00, 38.62it/s]predict: 100%|███████████████████████████████| 160/160 [00:04<00:00, 37.36it/s]
07-18 21:55:44, INFO     Port number: 43421
07-18 21:55:45, INFO     Port number: 40971
size restored (330, 522, 522)
Saved slices and power spectrum for epoch 6 to 'denoise'
denoise/network_n2n_unet-medium_96_full.pt
Total number of parameters: 23989825
denoise/network_n2n_unet-medium_96_full.pt
Total number of parameters: 23989825
Predict:   0%|          | 0/5 [00:00<?, ?it/s]/home/cii/software/IsoApp/tomograms_wbp/EVN/TS_01_EVN_wbp-b2.mrc
data_shape torch.Size([320, 1, 96, 96, 96])
predict:   0%|                                         | 0/160 [00:00<?, ?it/s]predict:   1%|▏                                | 1/160 [00:00<00:28,  5.60it/s]predict:   3%|█                                | 5/160 [00:00<00:07, 20.58it/s]predict:   6%|█▊                               | 9/160 [00:00<00:05, 27.77it/s]predict:   8%|██▌                             | 13/160 [00:00<00:04, 31.83it/s]predict:  11%|███▍                            | 17/160 [00:00<00:04, 34.05it/s]predict:  13%|████▏                           | 21/160 [00:00<00:03, 34.92it/s]predict:  16%|█████                           | 25/160 [00:00<00:03, 35.76it/s]predict:  18%|█████▊                          | 29/160 [00:00<00:03, 36.41it/s]predict:  21%|██████▌                         | 33/160 [00:01<00:03, 37.12it/s]predict:  23%|███████▍                        | 37/160 [00:01<00:03, 37.73it/s]predict:  26%|████████▏                       | 41/160 [00:01<00:03, 38.11it/s]predict:  28%|█████████                       | 45/160 [00:01<00:03, 38.05it/s]predict:  31%|█████████▊                      | 49/160 [00:01<00:02, 38.16it/s]predict:  33%|██████████▌                     | 53/160 [00:01<00:02, 38.29it/s]predict:  36%|███████████▍                    | 57/160 [00:01<00:02, 38.14it/s]predict:  38%|████████████▏                   | 61/160 [00:01<00:02, 38.31it/s]predict:  41%|█████████████                   | 65/160 [00:01<00:02, 38.55it/s]predict:  43%|█████████████▊                  | 69/160 [00:01<00:02, 38.57it/s]predict:  46%|██████████████▌                 | 73/160 [00:02<00:02, 38.69it/s]predict:  48%|███████████████▍                | 77/160 [00:02<00:02, 38.59it/s]predict:  51%|████████████████▏               | 81/160 [00:02<00:02, 38.18it/s]predict:  53%|█████████████████               | 85/160 [00:02<00:01, 38.14it/s]predict:  56%|█████████████████▊              | 89/160 [00:02<00:01, 38.34it/s]predict:  58%|██████████████████▌             | 93/160 [00:02<00:01, 38.59it/s]predict:  61%|███████████████████▍            | 97/160 [00:02<00:01, 38.66it/s]predict:  63%|███████████████████▌           | 101/160 [00:02<00:01, 38.73it/s]predict:  66%|████████████████████▎          | 105/160 [00:02<00:01, 38.69it/s]predict:  68%|█████████████████████          | 109/160 [00:02<00:01, 38.67it/s]predict:  71%|█████████████████████▉         | 113/160 [00:03<00:01, 38.74it/s]predict:  73%|██████████████████████▋        | 117/160 [00:03<00:01, 38.87it/s]predict:  76%|███████████████████████▍       | 121/160 [00:03<00:01, 38.91it/s]predict:  78%|████████████████████████▏      | 125/160 [00:03<00:00, 38.35it/s]predict:  81%|████████████████████████▉      | 129/160 [00:03<00:00, 38.35it/s]predict:  83%|█████████████████████████▊     | 133/160 [00:03<00:00, 38.59it/s]predict:  86%|██████████████████████████▌    | 137/160 [00:03<00:00, 38.66it/s]predict:  88%|███████████████████████████▎   | 141/160 [00:03<00:00, 38.68it/s]predict:  91%|████████████████████████████   | 145/160 [00:03<00:00, 38.71it/s]predict:  93%|████████████████████████████▊  | 149/160 [00:04<00:00, 38.60it/s]predict:  96%|█████████████████████████████▋ | 153/160 [00:04<00:00, 38.60it/s]predict:  98%|██████████████████████████████▍| 157/160 [00:04<00:00, 38.64it/s]predict: 100%|███████████████████████████████| 160/160 [00:04<00:00, 37.15it/s]
size restored (330, 522, 522)
/home/cii/software/IsoApp/tomograms_wbp/ODD/TS_01_ODD_wbp-b2.mrc
data_shape torch.Size([320, 1, 96, 96, 96])
predict:   0%|                                         | 0/160 [00:00<?, ?it/s]predict:   1%|▏                                | 1/160 [00:00<00:26,  5.97it/s]predict:   3%|█                                | 5/160 [00:00<00:07, 20.73it/s]predict:   6%|█▊                               | 9/160 [00:00<00:05, 27.47it/s]predict:   8%|██▌                             | 13/160 [00:00<00:04, 30.73it/s]predict:  11%|███▍                            | 17/160 [00:00<00:04, 32.55it/s]predict:  13%|████▏                           | 21/160 [00:00<00:04, 33.88it/s]predict:  16%|█████                           | 25/160 [00:00<00:03, 34.84it/s]predict:  18%|█████▊                          | 29/160 [00:00<00:03, 35.47it/s]predict:  21%|██████▌                         | 33/160 [00:01<00:03, 36.25it/s]predict:  23%|███████▍                        | 37/160 [00:01<00:03, 36.46it/s]predict:  26%|████████▏                       | 41/160 [00:01<00:03, 36.40it/s]predict:  28%|█████████                       | 45/160 [00:01<00:03, 37.00it/s]predict:  31%|█████████▊                      | 49/160 [00:01<00:02, 37.31it/s]predict:  33%|██████████▌                     | 53/160 [00:01<00:02, 37.23it/s]predict:  36%|███████████▍                    | 57/160 [00:01<00:02, 37.63it/s]predict:  38%|████████████▏                   | 61/160 [00:01<00:02, 37.66it/s]predict:  41%|█████████████                   | 65/160 [00:01<00:02, 37.84it/s]predict:  43%|█████████████▊                  | 69/160 [00:01<00:02, 38.10it/s]predict:  46%|██████████████▌                 | 73/160 [00:02<00:02, 38.06it/s]predict:  48%|███████████████▍                | 77/160 [00:02<00:02, 37.89it/s]predict:  51%|████████████████▏               | 81/160 [00:02<00:02, 37.78it/s]predict:  53%|█████████████████               | 85/160 [00:02<00:01, 37.71it/s]predict:  56%|█████████████████▊              | 89/160 [00:02<00:01, 38.07it/s]predict:  58%|██████████████████▌             | 93/160 [00:02<00:01, 37.95it/s]predict:  61%|███████████████████▍            | 97/160 [00:02<00:01, 38.16it/s]predict:  63%|███████████████████▌           | 101/160 [00:02<00:01, 38.04it/s]predict:  66%|████████████████████▎          | 105/160 [00:02<00:01, 37.76it/s]predict:  68%|█████████████████████          | 109/160 [00:03<00:01, 37.82it/s]predict:  71%|█████████████████████▉         | 113/160 [00:03<00:01, 38.06it/s]predict:  73%|██████████████████████▋        | 117/160 [00:03<00:01, 38.06it/s]predict:  76%|███████████████████████▍       | 121/160 [00:03<00:01, 37.67it/s]predict:  78%|████████████████████████▏      | 125/160 [00:03<00:00, 37.70it/s]predict:  81%|████████████████████████▉      | 129/160 [00:03<00:00, 37.61it/s]predict:  83%|█████████████████████████▊     | 133/160 [00:03<00:00, 37.42it/s]predict:  86%|██████████████████████████▌    | 137/160 [00:03<00:00, 37.47it/s]predict:  88%|███████████████████████████▎   | 141/160 [00:03<00:00, 37.45it/s]predict:  91%|████████████████████████████   | 145/160 [00:04<00:00, 37.41it/s]predict:  93%|████████████████████████████▊  | 149/160 [00:04<00:00, 37.71it/s]predict:  96%|█████████████████████████████▋ | 153/160 [00:04<00:00, 37.97it/s]predict:  98%|██████████████████████████████▍| 157/160 [00:04<00:00, 37.96it/s]predict: 100%|███████████████████████████████| 160/160 [00:04<00:00, 36.39it/s]
07-18 21:56:19, INFO     Predicted ['/home/cii/software/IsoApp/tomograms_wbp/EVN/TS_01_EVN_wbp-b2.mrc', '/home/cii/software/IsoApp/tomograms_wbp/ODD/TS_01_ODD_wbp-b2.mrc'] → denoise/corrected_n2n_unet-medium_TS_01_EVN_wbp-b2.mrc
Predict:  20%|██        | 1/5 [00:34<02:18, 34.61s/it]size restored (330, 522, 522)
/home/cii/software/IsoApp/tomograms_wbp/EVN/TS_03_EVN_wbp-b2.mrc
data_shape torch.Size([320, 1, 96, 96, 96])
predict:   0%|                                         | 0/160 [00:00<?, ?it/s]predict:   1%|▏                                | 1/160 [00:00<00:25,  6.22it/s]predict:   3%|█                                | 5/160 [00:00<00:07, 21.77it/s]predict:   6%|█▊                               | 9/160 [00:00<00:05, 28.76it/s]predict:   8%|██▌                             | 13/160 [00:00<00:04, 32.57it/s]predict:  11%|███▍                            | 17/160 [00:00<00:04, 34.57it/s]predict:  13%|████▏                           | 21/160 [00:00<00:03, 35.79it/s]predict:  16%|█████                           | 25/160 [00:00<00:03, 36.64it/s]predict:  18%|█████▊                          | 29/160 [00:00<00:03, 37.33it/s]predict:  21%|██████▌                         | 33/160 [00:00<00:03, 37.52it/s]predict:  23%|███████▍                        | 37/160 [00:01<00:03, 37.79it/s]predict:  26%|████████▏                       | 41/160 [00:01<00:03, 37.99it/s]predict:  28%|█████████                       | 45/160 [00:01<00:03, 38.24it/s]predict:  31%|█████████▊                      | 49/160 [00:01<00:02, 38.41it/s]predict:  33%|██████████▌                     | 53/160 [00:01<00:02, 38.59it/s]predict:  36%|███████████▍                    | 57/160 [00:01<00:02, 38.42it/s]predict:  38%|████████████▏                   | 61/160 [00:01<00:02, 37.90it/s]predict:  41%|█████████████                   | 65/160 [00:01<00:02, 38.23it/s]predict:  43%|█████████████▊                  | 69/160 [00:01<00:02, 38.45it/s]predict:  46%|██████████████▌                 | 73/160 [00:02<00:02, 38.40it/s]predict:  48%|███████████████▍                | 77/160 [00:02<00:02, 38.45it/s]predict:  51%|████████████████▏               | 81/160 [00:02<00:02, 38.28it/s]predict:  53%|█████████████████               | 85/160 [00:02<00:01, 38.39it/s]predict:  56%|█████████████████▊              | 89/160 [00:02<00:01, 38.48it/s]predict:  58%|██████████████████▌             | 93/160 [00:02<00:01, 38.70it/s]predict:  61%|███████████████████▍            | 97/160 [00:02<00:01, 38.66it/s]predict:  63%|███████████████████▌           | 101/160 [00:02<00:01, 38.64it/s]predict:  66%|████████████████████▎          | 105/160 [00:02<00:01, 38.72it/s]predict:  68%|█████████████████████          | 109/160 [00:02<00:01, 38.80it/s]predict:  71%|█████████████████████▉         | 113/160 [00:03<00:01, 38.89it/s]predict:  73%|██████████████████████▋        | 117/160 [00:03<00:01, 38.73it/s]predict:  76%|███████████████████████▍       | 121/160 [00:03<00:01, 38.70it/s]predict:  78%|████████████████████████▏      | 125/160 [00:03<00:00, 38.60it/s]predict:  81%|████████████████████████▉      | 129/160 [00:03<00:00, 38.58it/s]predict:  83%|█████████████████████████▊     | 133/160 [00:03<00:00, 38.73it/s]predict:  86%|██████████████████████████▌    | 137/160 [00:03<00:00, 38.75it/s]predict:  88%|███████████████████████████▎   | 141/160 [00:03<00:00, 38.77it/s]predict:  91%|████████████████████████████   | 145/160 [00:03<00:00, 38.86it/s]predict:  93%|████████████████████████████▊  | 149/160 [00:03<00:00, 38.84it/s]predict:  96%|█████████████████████████████▋ | 153/160 [00:04<00:00, 38.66it/s]predict:  98%|██████████████████████████████▍| 157/160 [00:04<00:00, 38.17it/s]predict: 100%|███████████████████████████████| 160/160 [00:04<00:00, 37.34it/s]
size restored (330, 522, 522)
/home/cii/software/IsoApp/tomograms_wbp/ODD/TS_03_ODD_wbp-b2.mrc
data_shape torch.Size([320, 1, 96, 96, 96])
predict:   0%|                                         | 0/160 [00:00<?, ?it/s]predict:   1%|▏                                | 1/160 [00:00<00:24,  6.54it/s]predict:   3%|█                                | 5/160 [00:00<00:06, 22.36it/s]predict:   6%|█▊                               | 9/160 [00:00<00:05, 29.22it/s]predict:   8%|██▌                             | 13/160 [00:00<00:04, 32.84it/s]predict:  11%|███▍                            | 17/160 [00:00<00:04, 34.90it/s]predict:  13%|████▏                           | 21/160 [00:00<00:03, 35.99it/s]predict:  16%|█████                           | 25/160 [00:00<00:03, 36.68it/s]predict:  18%|█████▊                          | 29/160 [00:00<00:03, 37.29it/s]predict:  21%|██████▌                         | 33/160 [00:00<00:03, 37.75it/s]predict:  23%|███████▍                        | 37/160 [00:01<00:03, 38.16it/s]predict:  26%|████████▏                       | 41/160 [00:01<00:03, 38.29it/s]predict:  28%|█████████                       | 45/160 [00:01<00:03, 38.13it/s]predict:  31%|█████████▊                      | 49/160 [00:01<00:02, 38.32it/s]predict:  33%|██████████▌                     | 53/160 [00:01<00:02, 38.09it/s]predict:  36%|███████████▍                    | 57/160 [00:01<00:02, 38.32it/s]predict:  38%|████████████▏                   | 61/160 [00:01<00:02, 38.42it/s]predict:  41%|█████████████                   | 65/160 [00:01<00:02, 38.56it/s]predict:  43%|█████████████▊                  | 69/160 [00:01<00:02, 38.64it/s]predict:  46%|██████████████▌                 | 73/160 [00:02<00:02, 38.65it/s]predict:  48%|███████████████▍                | 77/160 [00:02<00:02, 37.78it/s]predict:  51%|████████████████▏               | 81/160 [00:02<00:02, 37.51it/s]predict:  53%|█████████████████               | 85/160 [00:02<00:01, 37.67it/s]predict:  56%|█████████████████▊              | 89/160 [00:02<00:01, 37.96it/s]predict:  58%|██████████████████▌             | 93/160 [00:02<00:01, 38.23it/s]predict:  61%|███████████████████▍            | 97/160 [00:02<00:01, 38.48it/s]predict:  63%|███████████████████▌           | 101/160 [00:02<00:01, 38.46it/s]predict:  66%|████████████████████▎          | 105/160 [00:02<00:01, 37.75it/s]predict:  68%|█████████████████████          | 109/160 [00:02<00:01, 37.23it/s]predict:  71%|█████████████████████▉         | 113/160 [00:03<00:01, 36.85it/s]predict:  73%|██████████████████████▋        | 117/160 [00:03<00:01, 36.48it/s]predict:  76%|███████████████████████▍       | 121/160 [00:03<00:01, 36.71it/s]predict:  78%|████████████████████████▏      | 125/160 [00:03<00:00, 36.92it/s]predict:  81%|████████████████████████▉      | 129/160 [00:03<00:00, 37.30it/s]predict:  83%|█████████████████████████▊     | 133/160 [00:03<00:00, 37.71it/s]predict:  86%|██████████████████████████▌    | 137/160 [00:03<00:00, 37.34it/s]predict:  88%|███████████████████████████▎   | 141/160 [00:03<00:00, 37.21it/s]predict:  91%|████████████████████████████   | 145/160 [00:03<00:00, 36.68it/s]predict:  93%|████████████████████████████▊  | 149/160 [00:04<00:00, 36.36it/s]predict:  96%|█████████████████████████████▋ | 153/160 [00:04<00:00, 35.95it/s]predict:  98%|██████████████████████████████▍| 157/160 [00:04<00:00, 35.99it/s]predict: 100%|███████████████████████████████| 160/160 [00:04<00:00, 36.59it/s]
07-18 21:56:52, INFO     Predicted ['/home/cii/software/IsoApp/tomograms_wbp/EVN/TS_03_EVN_wbp-b2.mrc', '/home/cii/software/IsoApp/tomograms_wbp/ODD/TS_03_ODD_wbp-b2.mrc'] → denoise/corrected_n2n_unet-medium_TS_03_EVN_wbp-b2.mrc
Predict:  40%|████      | 2/5 [01:07<01:41, 33.77s/it]size restored (330, 522, 522)
/home/cii/software/IsoApp/tomograms_wbp/EVN/TS_43_EVN_wbp-b2.mrc
data_shape torch.Size([320, 1, 96, 96, 96])
predict:   0%|                                         | 0/160 [00:00<?, ?it/s]predict:   1%|▏                                | 1/160 [00:00<00:26,  6.10it/s]predict:   3%|█                                | 5/160 [00:00<00:07, 21.24it/s]predict:   6%|█▊                               | 9/160 [00:00<00:05, 28.32it/s]predict:   8%|██▌                             | 13/160 [00:00<00:04, 32.03it/s]predict:  11%|███▍                            | 17/160 [00:00<00:04, 33.91it/s]predict:  13%|████▏                           | 21/160 [00:00<00:03, 35.08it/s]predict:  16%|█████                           | 25/160 [00:00<00:03, 36.28it/s]predict:  18%|█████▊                          | 29/160 [00:00<00:03, 37.03it/s]predict:  21%|██████▌                         | 33/160 [00:01<00:03, 37.37it/s]predict:  23%|███████▍                        | 37/160 [00:01<00:03, 37.84it/s]predict:  26%|████████▏                       | 41/160 [00:01<00:03, 38.15it/s]predict:  28%|█████████                       | 45/160 [00:01<00:03, 38.07it/s]predict:  31%|█████████▊                      | 49/160 [00:01<00:02, 38.07it/s]predict:  33%|██████████▌                     | 53/160 [00:01<00:02, 38.25it/s]predict:  36%|███████████▍                    | 57/160 [00:01<00:02, 38.06it/s]predict:  38%|████████████▏                   | 61/160 [00:01<00:02, 38.07it/s]predict:  41%|█████████████                   | 65/160 [00:01<00:02, 38.34it/s]predict:  43%|█████████████▊                  | 69/160 [00:01<00:02, 37.83it/s]predict:  46%|██████████████▌                 | 73/160 [00:02<00:02, 37.45it/s]predict:  48%|███████████████▍                | 77/160 [00:02<00:02, 37.66it/s]predict:  51%|████████████████▏               | 81/160 [00:02<00:02, 37.82it/s]predict:  53%|█████████████████               | 85/160 [00:02<00:01, 37.77it/s]predict:  56%|█████████████████▊              | 89/160 [00:02<00:01, 38.06it/s]predict:  58%|██████████████████▌             | 93/160 [00:02<00:01, 38.31it/s]predict:  61%|███████████████████▍            | 97/160 [00:02<00:01, 38.50it/s]predict:  63%|███████████████████▌           | 101/160 [00:02<00:01, 38.59it/s]predict:  66%|████████████████████▎          | 105/160 [00:02<00:01, 38.43it/s]predict:  68%|█████████████████████          | 109/160 [00:02<00:01, 38.50it/s]predict:  71%|█████████████████████▉         | 113/160 [00:03<00:01, 38.56it/s]predict:  73%|██████████████████████▋        | 117/160 [00:03<00:01, 38.61it/s]predict:  76%|███████████████████████▍       | 121/160 [00:03<00:01, 38.69it/s]predict:  78%|████████████████████████▏      | 125/160 [00:03<00:00, 38.22it/s]predict:  81%|████████████████████████▉      | 129/160 [00:03<00:00, 38.30it/s]predict:  83%|█████████████████████████▊     | 133/160 [00:03<00:00, 38.44it/s]predict:  86%|██████████████████████████▌    | 137/160 [00:03<00:00, 38.34it/s]predict:  88%|███████████████████████████▎   | 141/160 [00:03<00:00, 38.37it/s]predict:  91%|████████████████████████████   | 145/160 [00:03<00:00, 38.50it/s]predict:  93%|████████████████████████████▊  | 149/160 [00:04<00:00, 38.28it/s]predict:  96%|█████████████████████████████▋ | 153/160 [00:04<00:00, 38.41it/s]predict:  98%|██████████████████████████████▍| 157/160 [00:04<00:00, 38.26it/s]predict: 100%|███████████████████████████████| 160/160 [00:04<00:00, 37.04it/s]
size restored (330, 522, 522)
/home/cii/software/IsoApp/tomograms_wbp/ODD/TS_43_ODD_wbp-b2.mrc
data_shape torch.Size([320, 1, 96, 96, 96])
predict:   0%|                                         | 0/160 [00:00<?, ?it/s]predict:   1%|▏                                | 1/160 [00:00<00:30,  5.29it/s]predict:   3%|█                                | 5/160 [00:00<00:07, 19.97it/s]predict:   6%|█▊                               | 9/160 [00:00<00:05, 27.03it/s]predict:   8%|██▌                             | 13/160 [00:00<00:04, 30.45it/s]predict:  11%|███▍                            | 17/160 [00:00<00:04, 32.47it/s]predict:  13%|████▏                           | 21/160 [00:00<00:04, 33.71it/s]predict:  16%|█████                           | 25/160 [00:00<00:03, 34.92it/s]predict:  18%|█████▊                          | 29/160 [00:00<00:03, 35.79it/s]predict:  21%|██████▌                         | 33/160 [00:01<00:03, 36.41it/s]predict:  23%|███████▍                        | 37/160 [00:01<00:03, 36.71it/s]predict:  26%|████████▏                       | 41/160 [00:01<00:03, 36.28it/s]predict:  28%|█████████                       | 45/160 [00:01<00:03, 36.61it/s]predict:  31%|█████████▊                      | 49/160 [00:01<00:03, 36.96it/s]predict:  33%|██████████▌                     | 53/160 [00:01<00:02, 37.12it/s]predict:  36%|███████████▍                    | 57/160 [00:01<00:02, 37.09it/s]predict:  38%|████████████▏                   | 61/160 [00:01<00:02, 36.89it/s]predict:  41%|█████████████                   | 65/160 [00:01<00:02, 36.73it/s]predict:  43%|█████████████▊                  | 69/160 [00:02<00:02, 36.73it/s]predict:  46%|██████████████▌                 | 73/160 [00:02<00:02, 37.33it/s]predict:  48%|███████████████▍                | 77/160 [00:02<00:02, 37.16it/s]predict:  51%|████████████████▏               | 81/160 [00:02<00:02, 37.16it/s]predict:  53%|█████████████████               | 85/160 [00:02<00:02, 37.29it/s]predict:  56%|█████████████████▊              | 89/160 [00:02<00:01, 36.89it/s]predict:  58%|██████████████████▌             | 93/160 [00:02<00:01, 36.66it/s]predict:  61%|███████████████████▍            | 97/160 [00:02<00:01, 36.69it/s]predict:  63%|███████████████████▌           | 101/160 [00:02<00:01, 36.58it/s]predict:  66%|████████████████████▎          | 105/160 [00:02<00:01, 36.59it/s]predict:  68%|█████████████████████          | 109/160 [00:03<00:01, 36.48it/s]predict:  71%|█████████████████████▉         | 113/160 [00:03<00:01, 36.75it/s]predict:  73%|██████████████████████▋        | 117/160 [00:03<00:01, 37.18it/s]predict:  76%|███████████████████████▍       | 121/160 [00:03<00:01, 37.07it/s]predict:  78%|████████████████████████▏      | 125/160 [00:03<00:00, 37.05it/s]predict:  81%|████████████████████████▉      | 129/160 [00:03<00:00, 37.24it/s]predict:  83%|█████████████████████████▊     | 133/160 [00:03<00:00, 36.88it/s]predict:  86%|██████████████████████████▌    | 137/160 [00:03<00:00, 37.06it/s]predict:  88%|███████████████████████████▎   | 141/160 [00:03<00:00, 36.99it/s]predict:  91%|████████████████████████████   | 145/160 [00:04<00:00, 36.75it/s]predict:  93%|████████████████████████████▊  | 149/160 [00:04<00:00, 36.71it/s]predict:  96%|█████████████████████████████▋ | 153/160 [00:04<00:00, 36.33it/s]predict:  98%|██████████████████████████████▍| 157/160 [00:04<00:00, 36.37it/s]predict: 100%|███████████████████████████████| 160/160 [00:04<00:00, 35.62it/s]
07-18 21:57:28, INFO     Predicted ['/home/cii/software/IsoApp/tomograms_wbp/EVN/TS_43_EVN_wbp-b2.mrc', '/home/cii/software/IsoApp/tomograms_wbp/ODD/TS_43_ODD_wbp-b2.mrc'] → denoise/corrected_n2n_unet-medium_TS_43_EVN_wbp-b2.mrc
Predict:  60%|██████    | 3/5 [01:43<01:08, 34.50s/it]size restored (330, 522, 522)
/home/cii/software/IsoApp/tomograms_wbp/EVN/TS_45_EVN_wbp-b2.mrc
data_shape torch.Size([320, 1, 96, 96, 96])
predict:   0%|                                         | 0/160 [00:00<?, ?it/s]predict:   1%|▏                                | 1/160 [00:00<00:24,  6.55it/s]predict:   3%|█                                | 5/160 [00:00<00:06, 22.31it/s]predict:   6%|█▊                               | 9/160 [00:00<00:05, 29.08it/s]predict:   8%|██▌                             | 13/160 [00:00<00:04, 32.67it/s]predict:  11%|███▍                            | 17/160 [00:00<00:04, 34.70it/s]predict:  13%|████▏                           | 21/160 [00:00<00:03, 36.02it/s]predict:  16%|█████                           | 25/160 [00:00<00:03, 36.95it/s]predict:  18%|█████▊                          | 29/160 [00:00<00:03, 37.52it/s]predict:  21%|██████▌                         | 33/160 [00:00<00:03, 37.69it/s]predict:  23%|███████▍                        | 37/160 [00:01<00:03, 38.09it/s]predict:  26%|████████▏                       | 41/160 [00:01<00:03, 38.29it/s]predict:  28%|█████████                       | 45/160 [00:01<00:03, 38.25it/s]predict:  31%|█████████▊                      | 49/160 [00:01<00:02, 38.40it/s]predict:  33%|██████████▌                     | 53/160 [00:01<00:02, 38.56it/s]predict:  36%|███████████▍                    | 57/160 [00:01<00:02, 38.32it/s]predict:  38%|████████████▏                   | 61/160 [00:01<00:02, 38.32it/s]predict:  41%|█████████████                   | 65/160 [00:01<00:02, 38.53it/s]predict:  43%|█████████████▊                  | 69/160 [00:01<00:02, 38.42it/s]predict:  46%|██████████████▌                 | 73/160 [00:02<00:02, 38.18it/s]predict:  48%|███████████████▍                | 77/160 [00:02<00:02, 38.23it/s]predict:  51%|████████████████▏               | 81/160 [00:02<00:02, 38.07it/s]predict:  53%|█████████████████               | 85/160 [00:02<00:01, 38.07it/s]predict:  56%|█████████████████▊              | 89/160 [00:02<00:01, 38.24it/s]predict:  58%|██████████████████▌             | 93/160 [00:02<00:01, 38.40it/s]predict:  61%|███████████████████▍            | 97/160 [00:02<00:01, 38.53it/s]predict:  63%|███████████████████▌           | 101/160 [00:02<00:01, 38.58it/s]predict:  66%|████████████████████▎          | 105/160 [00:02<00:01, 38.44it/s]predict:  68%|█████████████████████          | 109/160 [00:02<00:01, 38.25it/s]predict:  71%|█████████████████████▉         | 113/160 [00:03<00:01, 38.24it/s]predict:  73%|██████████████████████▋        | 117/160 [00:03<00:01, 38.29it/s]predict:  76%|███████████████████████▍       | 121/160 [00:03<00:01, 38.39it/s]predict:  78%|████████████████████████▏      | 125/160 [00:03<00:00, 38.18it/s]predict:  81%|████████████████████████▉      | 129/160 [00:03<00:00, 38.31it/s]predict:  83%|█████████████████████████▊     | 133/160 [00:03<00:00, 38.47it/s]predict:  86%|██████████████████████████▌    | 137/160 [00:03<00:00, 38.43it/s]predict:  88%|███████████████████████████▎   | 141/160 [00:03<00:00, 38.04it/s]predict:  91%|████████████████████████████   | 145/160 [00:03<00:00, 38.13it/s]predict:  93%|████████████████████████████▊  | 149/160 [00:04<00:00, 38.16it/s]predict:  96%|█████████████████████████████▋ | 153/160 [00:04<00:00, 38.22it/s]predict:  98%|██████████████████████████████▍| 157/160 [00:04<00:00, 38.03it/s]predict: 100%|███████████████████████████████| 160/160 [00:04<00:00, 37.24it/s]
size restored (330, 522, 522)
/home/cii/software/IsoApp/tomograms_wbp/ODD/TS_45_ODD_wbp-b2.mrc
data_shape torch.Size([320, 1, 96, 96, 96])
predict:   0%|                                         | 0/160 [00:00<?, ?it/s]predict:   1%|▏                                | 1/160 [00:00<00:25,  6.35it/s]predict:   3%|█                                | 5/160 [00:00<00:07, 21.96it/s]predict:   6%|█▊                               | 9/160 [00:00<00:05, 28.76it/s]predict:   8%|██▌                             | 13/160 [00:00<00:04, 32.18it/s]predict:  11%|███▍                            | 17/160 [00:00<00:04, 34.00it/s]predict:  13%|████▏                           | 21/160 [00:00<00:03, 35.49it/s]predict:  16%|█████                           | 25/160 [00:00<00:03, 36.55it/s]predict:  18%|█████▊                          | 29/160 [00:00<00:03, 37.26it/s]predict:  21%|██████▌                         | 33/160 [00:00<00:03, 37.48it/s]predict:  23%|███████▍                        | 37/160 [00:01<00:03, 37.74it/s]predict:  26%|████████▏                       | 41/160 [00:01<00:03, 36.94it/s]predict:  28%|█████████                       | 45/160 [00:01<00:03, 36.70it/s]predict:  31%|█████████▊                      | 49/160 [00:01<00:03, 36.26it/s]predict:  33%|██████████▌                     | 53/160 [00:01<00:02, 36.04it/s]predict:  36%|███████████▍                    | 57/160 [00:01<00:02, 35.96it/s]predict:  38%|████████████▏                   | 61/160 [00:01<00:02, 36.38it/s]predict:  41%|█████████████                   | 65/160 [00:01<00:02, 36.77it/s]predict:  43%|█████████████▊                  | 69/160 [00:01<00:02, 36.97it/s]predict:  46%|██████████████▌                 | 73/160 [00:02<00:02, 37.07it/s]predict:  48%|███████████████▍                | 77/160 [00:02<00:02, 37.03it/s]predict:  51%|████████████████▏               | 81/160 [00:02<00:02, 36.93it/s]predict:  53%|█████████████████               | 85/160 [00:02<00:02, 37.37it/s]predict:  56%|█████████████████▊              | 89/160 [00:02<00:01, 37.46it/s]predict:  58%|██████████████████▌             | 93/160 [00:02<00:01, 37.18it/s]predict:  61%|███████████████████▍            | 97/160 [00:02<00:01, 36.81it/s]predict:  63%|███████████████████▌           | 101/160 [00:02<00:01, 37.00it/s]predict:  66%|████████████████████▎          | 105/160 [00:02<00:01, 37.00it/s]predict:  68%|█████████████████████          | 109/160 [00:03<00:01, 36.89it/s]predict:  71%|█████████████████████▉         | 113/160 [00:03<00:01, 36.83it/s]predict:  73%|██████████████████████▋        | 117/160 [00:03<00:01, 36.65it/s]predict:  76%|███████████████████████▍       | 121/160 [00:03<00:01, 36.60it/s]predict:  78%|████████████████████████▏      | 125/160 [00:03<00:00, 36.71it/s]predict:  81%|████████████████████████▉      | 129/160 [00:03<00:00, 37.16it/s]predict:  83%|█████████████████████████▊     | 133/160 [00:03<00:00, 37.24it/s]predict:  86%|██████████████████████████▌    | 137/160 [00:03<00:00, 37.07it/s]predict:  88%|███████████████████████████▎   | 141/160 [00:03<00:00, 37.46it/s]predict:  91%|████████████████████████████   | 145/160 [00:04<00:00, 37.43it/s]predict:  93%|████████████████████████████▊  | 149/160 [00:04<00:00, 37.17it/s]predict:  96%|█████████████████████████████▋ | 153/160 [00:04<00:00, 37.34it/s]predict:  98%|██████████████████████████████▍| 157/160 [00:04<00:00, 37.11it/s]predict: 100%|███████████████████████████████| 160/160 [00:04<00:00, 36.10it/s]
07-18 21:58:01, INFO     Predicted ['/home/cii/software/IsoApp/tomograms_wbp/EVN/TS_45_EVN_wbp-b2.mrc', '/home/cii/software/IsoApp/tomograms_wbp/ODD/TS_45_ODD_wbp-b2.mrc'] → denoise/corrected_n2n_unet-medium_TS_45_EVN_wbp-b2.mrc
Predict:  80%|████████  | 4/5 [02:16<00:34, 34.14s/it]size restored (330, 522, 522)
/home/cii/software/IsoApp/tomograms_wbp/EVN/TS_54_EVN_wbp-b2.mrc
data_shape torch.Size([320, 1, 96, 96, 96])
predict:   0%|                                         | 0/160 [00:00<?, ?it/s]predict:   1%|▏                                | 1/160 [00:00<00:27,  5.84it/s]predict:   3%|█                                | 5/160 [00:00<00:07, 21.03it/s]predict:   6%|█▊                               | 9/160 [00:00<00:05, 28.13it/s]predict:   8%|██▌                             | 13/160 [00:00<00:04, 32.06it/s]predict:  11%|███▍                            | 17/160 [00:00<00:04, 34.11it/s]predict:  13%|████▏                           | 21/160 [00:00<00:03, 35.62it/s]predict:  16%|█████                           | 25/160 [00:00<00:03, 36.63it/s]predict:  18%|█████▊                          | 29/160 [00:00<00:03, 37.32it/s]predict:  21%|██████▌                         | 33/160 [00:01<00:03, 37.43it/s]predict:  23%|███████▍                        | 37/160 [00:01<00:03, 37.74it/s]predict:  26%|████████▏                       | 41/160 [00:01<00:03, 37.90it/s]predict:  28%|█████████                       | 45/160 [00:01<00:03, 37.81it/s]predict:  31%|█████████▊                      | 49/160 [00:01<00:02, 38.07it/s]predict:  33%|██████████▌                     | 53/160 [00:01<00:02, 38.36it/s]predict:  36%|███████████▍                    | 57/160 [00:01<00:02, 38.26it/s]predict:  38%|████████████▏                   | 61/160 [00:01<00:02, 38.15it/s]predict:  41%|█████████████                   | 65/160 [00:01<00:02, 38.40it/s]predict:  43%|█████████████▊                  | 69/160 [00:01<00:02, 38.59it/s]predict:  46%|██████████████▌                 | 73/160 [00:02<00:02, 38.71it/s]predict:  48%|███████████████▍                | 77/160 [00:02<00:02, 38.63it/s]predict:  51%|████████████████▏               | 81/160 [00:02<00:02, 38.59it/s]predict:  53%|█████████████████               | 85/160 [00:02<00:01, 38.60it/s]predict:  56%|█████████████████▊              | 89/160 [00:02<00:01, 38.44it/s]predict:  58%|██████████████████▌             | 93/160 [00:02<00:01, 38.58it/s]predict:  61%|███████████████████▍            | 97/160 [00:02<00:01, 38.70it/s]predict:  63%|███████████████████▌           | 101/160 [00:02<00:01, 38.76it/s]predict:  66%|████████████████████▎          | 105/160 [00:02<00:01, 38.77it/s]predict:  68%|█████████████████████          | 109/160 [00:02<00:01, 38.85it/s]predict:  71%|█████████████████████▉         | 113/160 [00:03<00:01, 38.94it/s]predict:  73%|██████████████████████▋        | 117/160 [00:03<00:01, 39.00it/s]predict:  76%|███████████████████████▍       | 121/160 [00:03<00:01, 38.72it/s]predict:  78%|████████████████████████▏      | 125/160 [00:03<00:00, 38.68it/s]predict:  81%|████████████████████████▉      | 129/160 [00:03<00:00, 38.62it/s]predict:  83%|█████████████████████████▊     | 133/160 [00:03<00:00, 38.77it/s]predict:  86%|██████████████████████████▌    | 137/160 [00:03<00:00, 38.61it/s]predict:  88%|███████████████████████████▎   | 141/160 [00:03<00:00, 38.46it/s]predict:  91%|████████████████████████████   | 145/160 [00:03<00:00, 38.64it/s]predict:  93%|████████████████████████████▊  | 149/160 [00:04<00:00, 38.71it/s]predict:  96%|█████████████████████████████▋ | 153/160 [00:04<00:00, 38.61it/s]predict:  98%|██████████████████████████████▍| 157/160 [00:04<00:00, 38.40it/s]predict: 100%|███████████████████████████████| 160/160 [00:04<00:00, 37.26it/s]
size restored (330, 522, 522)
/home/cii/software/IsoApp/tomograms_wbp/ODD/TS_54_ODD_wbp-b2.mrc
data_shape torch.Size([320, 1, 96, 96, 96])
predict:   0%|                                         | 0/160 [00:00<?, ?it/s]predict:   1%|▏                                | 1/160 [00:00<00:25,  6.28it/s]predict:   3%|█                                | 5/160 [00:00<00:07, 21.90it/s]predict:   6%|█▊                               | 9/160 [00:00<00:05, 28.85it/s]predict:   8%|██▌                             | 13/160 [00:00<00:04, 32.58it/s]predict:  11%|███▍                            | 17/160 [00:00<00:04, 34.64it/s]predict:  13%|████▏                           | 21/160 [00:00<00:03, 35.97it/s]predict:  16%|█████                           | 25/160 [00:00<00:03, 36.97it/s]predict:  18%|█████▊                          | 29/160 [00:00<00:03, 37.49it/s]predict:  21%|██████▌                         | 33/160 [00:00<00:03, 37.86it/s]predict:  23%|███████▍                        | 37/160 [00:01<00:03, 38.19it/s]predict:  26%|████████▏                       | 41/160 [00:01<00:03, 38.44it/s]predict:  28%|█████████                       | 45/160 [00:01<00:02, 38.45it/s]predict:  31%|█████████▊                      | 49/160 [00:01<00:02, 38.54it/s]predict:  33%|██████████▌                     | 53/160 [00:01<00:02, 38.53it/s]predict:  36%|███████████▍                    | 57/160 [00:01<00:02, 38.58it/s]predict:  38%|████████████▏                   | 61/160 [00:01<00:02, 38.61it/s]predict:  41%|█████████████                   | 65/160 [00:01<00:02, 38.72it/s]predict:  43%|█████████████▊                  | 69/160 [00:01<00:02, 38.76it/s]predict:  46%|██████████████▌                 | 73/160 [00:02<00:02, 38.77it/s]predict:  48%|███████████████▍                | 77/160 [00:02<00:02, 38.68it/s]predict:  51%|████████████████▏               | 81/160 [00:02<00:02, 38.57it/s]predict:  53%|█████████████████               | 85/160 [00:02<00:01, 38.56it/s]predict:  56%|█████████████████▊              | 89/160 [00:02<00:01, 38.57it/s]predict:  58%|██████████████████▌             | 93/160 [00:02<00:01, 38.68it/s]predict:  61%|███████████████████▍            | 97/160 [00:02<00:01, 38.82it/s]predict:  63%|███████████████████▌           | 101/160 [00:02<00:01, 38.88it/s]predict:  66%|████████████████████▎          | 105/160 [00:02<00:01, 38.90it/s]predict:  68%|█████████████████████          | 109/160 [00:02<00:01, 38.98it/s]predict:  71%|█████████████████████▉         | 113/160 [00:03<00:01, 38.92it/s]predict:  73%|██████████████████████▋        | 117/160 [00:03<00:01, 38.94it/s]predict:  76%|███████████████████████▍       | 121/160 [00:03<00:00, 39.01it/s]predict:  78%|████████████████████████▏      | 125/160 [00:03<00:00, 39.04it/s]predict:  81%|████████████████████████▉      | 129/160 [00:03<00:00, 39.05it/s]predict:  83%|█████████████████████████▊     | 133/160 [00:03<00:00, 39.05it/s]predict:  86%|██████████████████████████▌    | 137/160 [00:03<00:00, 38.84it/s]predict:  88%|███████████████████████████▎   | 141/160 [00:03<00:00, 38.77it/s]predict:  91%|████████████████████████████   | 145/160 [00:03<00:00, 38.60it/s]predict:  93%|████████████████████████████▊  | 149/160 [00:03<00:00, 38.62it/s]predict:  96%|█████████████████████████████▋ | 153/160 [00:04<00:00, 38.28it/s]predict:  98%|██████████████████████████████▍| 157/160 [00:04<00:00, 38.25it/s]predict: 100%|███████████████████████████████| 160/160 [00:04<00:00, 37.51it/s]
07-18 21:58:34, INFO     Predicted ['/home/cii/software/IsoApp/tomograms_wbp/EVN/TS_54_EVN_wbp-b2.mrc', '/home/cii/software/IsoApp/tomograms_wbp/ODD/TS_54_ODD_wbp-b2.mrc'] → denoise/corrected_n2n_unet-medium_TS_54_EVN_wbp-b2.mrc
Predict: 100%|██████████| 5/5 [02:49<00:00, 33.73s/it]Predict: 100%|██████████| 5/5 [02:49<00:00, 33.95s/it]
size restored (330, 522, 522)
Process exited with code 0
Command: isonet.py denoise --star_file tomograms.star --output_dir denoise --gpuID 0,1 --ncpus 16 --arch unet-medium --pretrained_model None --pretrained_model2 None --cube_size 96 --epochs 6 --input_column rlnTomoReconstructedTomogramHalf --batch_size None --acc_batches 1 --loss_func L2 --learning_rate 0.0003 --T_max 2 --learning_rate_min 0.0003 --compile_model False --mixed_precision True --CTF_mode None --isCTFflipped False --with_predict True --split_halves False --snrfalloff 0 --deconvstrength 1 --highpassnyquist 0.02
07-18 22:38:55, INFO     The denoise folder already exists, outputs will write into this folder
07-18 22:38:56, INFO     Port number: 43551
Total number of parameters: 23989825
Preprocess tomograms:   0%|                                                   | 0/5 [00:00<?, ?it/s]Preprocess tomograms:  20%|████████▌                                  | 1/5 [00:00<00:01,  2.79it/s]Preprocess tomograms:  40%|█████████████████▏                         | 2/5 [00:00<00:01,  2.71it/s]Preprocess tomograms:  60%|█████████████████████████▊                 | 3/5 [00:01<00:00,  2.66it/s]Preprocess tomograms:  80%|██████████████████████████████████▍        | 4/5 [00:01<00:00,  2.68it/s]Preprocess tomograms: 100%|███████████████████████████████████████████| 5/5 [00:01<00:00,  2.64it/s]Preprocess tomograms: 100%|███████████████████████████████████████████| 5/5 [00:01<00:00,  2.66it/s]
training tomograms for 2 epochs, remaining epochs 6
Epoch 1:   0%|                                       | 0/13 [00:00<?, ?batch/s]Epoch 1:   0%| | 0/13 [00:18<?, ?batch/s, Loss: 1.6586 | in_mw_loss: 1.6586 | oEpoch 1:   8%| | 1/13 [00:18<03:44, 18.73s/batch, Loss: 1.6586 | in_mw_loss: 1.Epoch 1:   8%| | 1/13 [00:18<03:44, 18.73s/batch, Loss: 1.6436 | in_mw_loss: 1.Epoch 1:  15%|▏| 2/13 [00:18<01:25,  7.79s/batch, Loss: 1.6436 | in_mw_loss: 1.Epoch 1:  15%|▏| 2/13 [00:18<01:25,  7.79s/batch, Loss: 1.3608 | in_mw_loss: 1.Epoch 1:  23%|▏| 3/13 [00:18<00:42,  4.29s/batch, Loss: 1.3608 | in_mw_loss: 1.Epoch 1:  23%|▏| 3/13 [00:19<00:42,  4.29s/batch, Loss: 1.2771 | in_mw_loss: 1.Epoch 1:  31%|▎| 4/13 [00:19<00:23,  2.65s/batch, Loss: 1.2771 | in_mw_loss: 1.Epoch 1:  31%|▎| 4/13 [00:19<00:23,  2.65s/batch, Loss: 1.1709 | in_mw_loss: 1.Epoch 1:  38%|▍| 5/13 [00:19<00:13,  1.74s/batch, Loss: 1.1709 | in_mw_loss: 1.Epoch 1:  38%|▍| 5/13 [00:19<00:30,  3.87s/batch, Loss: 1.1709 | in_mw_loss: 1.
Traceback (most recent call last):
  File "/home/cii/software/IsoNet2/IsoNet/bin/isonet.py", line 1080, in <module>
    exit(main())
         ~~~~^^
  File "/home/cii/software/IsoNet2/IsoNet/bin/isonet.py", line 1076, in main
    fire.Fire(ISONET)
    ~~~~~~~~~^^^^^^^^
  File "/home/cii/anaconda3/envs/torch_cuda12.6_glados_py3.13/lib/python3.13/site-packages/fire/core.py", line 135, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/home/cii/anaconda3/envs/torch_cuda12.6_glados_py3.13/lib/python3.13/site-packages/fire/core.py", line 468, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
                                ~~~~~~~~~~~~~~~~~~~^
        component,
        ^^^^^^^^^^
    ...<2 lines>...
        treatment='class' if is_class else 'routine',
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        target=component.__name__)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/cii/anaconda3/envs/torch_cuda12.6_glados_py3.13/lib/python3.13/site-packages/fire/core.py", line 684, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "/home/cii/software/IsoNet2/IsoNet/bin/isonet.py", line 604, in denoise
    network.train(training_params) #train based on init model and save new one as model_iter{num_iter}.h5
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/home/cii/software/IsoNet2/IsoNet/models/network.py", line 259, in train
    mp.spawn(ddp_train, args=(self.world_size, self.port_number, self.model, train_dataset, training_params), nprocs=self.world_size)
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/cii/anaconda3/envs/torch_cuda12.6_glados_py3.13/lib/python3.13/site-packages/torch/multiprocessing/spawn.py", line 340, in spawn
    return start_processes(fn, args, nprocs, join, daemon, start_method="spawn")
  File "/home/cii/anaconda3/envs/torch_cuda12.6_glados_py3.13/lib/python3.13/site-packages/torch/multiprocessing/spawn.py", line 296, in start_processes
    while not context.join():
              ~~~~~~~~~~~~^^
  File "/home/cii/anaconda3/envs/torch_cuda12.6_glados_py3.13/lib/python3.13/site-packages/torch/multiprocessing/spawn.py", line 144, in join
    ready = multiprocessing.connection.wait(
        self.sentinels.keys(),
        timeout=timeout,
    )
  File "/home/cii/anaconda3/envs/torch_cuda12.6_glados_py3.13/lib/python3.13/multiprocessing/connection.py", line 1148, in wait
    ready = selector.select(timeout)
  File "/home/cii/anaconda3/envs/torch_cuda12.6_glados_py3.13/lib/python3.13/selectors.py", line 398, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt
[rank0]:[W718 22:39:24.628201638 ProcessGroupNCCL.cpp:1496] Warning: WARNING: destroy_process_group() was not called before program exit, which can leak resources. For more info, please see https://pytorch.org/docs/stable/distributed.html#shutdown (function operator())
Process exited with code null
Command: isonet.py denoise --star_file tomograms.star --output_dir denoise --gpuID 0,1 --ncpus 16 --arch unet-medium --pretrained_model None --pretrained_model2 None --cube_size 96 --epochs 6 --input_column rlnTomoReconstructedTomogramHalf --batch_size None --acc_batches 1 --loss_func L2 --learning_rate 0.0003 --T_max 2 --learning_rate_min 0.0003 --compile_model False --mixed_precision True --CTF_mode None --isCTFflipped False --with_predict True --split_halves False --snrfalloff 0 --deconvstrength 1 --highpassnyquist 0.02
07-18 23:02:14, INFO     The denoise folder already exists, outputs will write into this folder
07-18 23:02:14, INFO     Port number: 60259
Total number of parameters: 23989825
Preprocess tomograms:   0%|                                                   | 0/5 [00:00<?, ?it/s]Preprocess tomograms:  20%|████████▌                                  | 1/5 [00:00<00:01,  2.71it/s]Preprocess tomograms:  40%|█████████████████▏                         | 2/5 [00:00<00:01,  2.76it/s]Preprocess tomograms:  60%|█████████████████████████▊                 | 3/5 [00:01<00:00,  2.81it/s]Preprocess tomograms:  80%|██████████████████████████████████▍        | 4/5 [00:01<00:00,  2.80it/s]Preprocess tomograms: 100%|███████████████████████████████████████████| 5/5 [00:01<00:00,  2.82it/s]Preprocess tomograms: 100%|███████████████████████████████████████████| 5/5 [00:01<00:00,  2.80it/s]
training tomograms for 2 epochs, remaining epochs 6
Epoch 1:   0%|                                       | 0/13 [00:00<?, ?batch/s]Epoch 1:   0%| | 0/13 [00:18<?, ?batch/s, Loss: 1.9614 | in_mw_loss: 1.9614 | oEpoch 1:   8%| | 1/13 [00:18<03:38, 18.20s/batch, Loss: 1.9614 | in_mw_loss: 1.Epoch 1:   8%| | 1/13 [00:18<03:38, 18.20s/batch, Loss: 1.6998 | in_mw_loss: 1.Epoch 1:  15%|▏| 2/13 [00:18<01:23,  7.58s/batch, Loss: 1.6998 | in_mw_loss: 1.Epoch 1:  15%|▏| 2/13 [00:18<01:23,  7.58s/batch, Loss: 1.3559 | in_mw_loss: 1.Epoch 1:  23%|▏| 3/13 [00:18<00:41,  4.18s/batch, Loss: 1.3559 | in_mw_loss: 1.Epoch 1:  23%|▏| 3/13 [00:18<00:41,  4.18s/batch, Loss: 1.3218 | in_mw_loss: 1.Epoch 1:  31%|▎| 4/13 [00:18<00:23,  2.58s/batch, Loss: 1.3218 | in_mw_loss: 1.Epoch 1:  31%|▎| 4/13 [00:18<00:23,  2.58s/batch, Loss: 1.2701 | in_mw_loss: 1.Epoch 1:  38%|▍| 5/13 [00:18<00:13,  1.69s/batch, Loss: 1.2701 | in_mw_loss: 1.Epoch 1:  38%|▍| 5/13 [00:18<00:13,  1.69s/batch, Loss: 1.2381 | in_mw_loss: 1.Epoch 1:  46%|▍| 6/13 [00:18<00:08,  1.16s/batch, Loss: 1.2381 | in_mw_loss: 1.Epoch 1:  46%|▍| 6/13 [00:18<00:08,  1.16s/batch, Loss: 1.2426 | in_mw_loss: 1.Epoch 1:  54%|▌| 7/13 [00:18<00:04,  1.21batch/s, Loss: 1.2426 | in_mw_loss: 1.Epoch 1:  54%|▌| 7/13 [00:19<00:04,  1.21batch/s, Loss: 1.1892 | in_mw_loss: 1.Epoch 1:  62%|▌| 8/13 [00:19<00:03,  1.66batch/s, Loss: 1.1892 | in_mw_loss: 1.Epoch 1:  62%|▌| 8/13 [00:19<00:03,  1.66batch/s, Loss: 1.1390 | in_mw_loss: 1.Epoch 1:  69%|▋| 9/13 [00:19<00:01,  2.21batch/s, Loss: 1.1390 | in_mw_loss: 1.Epoch 1:  69%|▋| 9/13 [00:19<00:01,  2.21batch/s, Loss: 1.2943 | in_mw_loss: 1.Epoch 1:  77%|▊| 10/13 [00:19<00:01,  2.84batch/s, Loss: 1.2943 | in_mw_loss: 1Epoch 1:  77%|▊| 10/13 [00:19<00:01,  2.84batch/s, Loss: 1.2163 | in_mw_loss: 1Epoch 1:  85%|▊| 11/13 [00:19<00:00,  3.53batch/s, Loss: 1.2163 | in_mw_loss: 1Epoch 1:  85%|▊| 11/13 [00:19<00:00,  3.53batch/s, Loss: 1.0679 | in_mw_loss: 1Epoch 1:  92%|▉| 12/13 [00:19<00:00,  4.23batch/s, Loss: 1.0679 | in_mw_loss: 1Epoch 1:  92%|▉| 12/13 [00:19<00:00,  4.23batch/s, Loss: 1.1092 | in_mw_loss: 1Epoch 1: 100%|█| 13/13 [00:19<00:00,  4.95batch/s, Loss: 1.1092 | in_mw_loss: 1Epoch 1: 100%|█| 13/13 [00:19<00:00,  1.52s/batch, Loss: 1.1092 | in_mw_loss: 1
Epoch [  1/  2], Loss: 1.3185, in_mw_loss: 1.3185, out_mw_loss: 1.3185, learning_rate: 3.0000e-04
Epoch 2:   0%|                                       | 0/13 [00:00<?, ?batch/s]Epoch 2:   0%| | 0/13 [00:00<?, ?batch/s, Loss: 1.1389 | in_mw_loss: 1.1389 | oEpoch 2:   8%| | 1/13 [00:00<00:03,  3.71batch/s, Loss: 1.1389 | in_mw_loss: 1.Epoch 2:   8%| | 1/13 [00:00<00:03,  3.71batch/s, Loss: 1.0997 | in_mw_loss: 1.Epoch 2:  15%|▏| 2/13 [00:00<00:02,  5.37batch/s, Loss: 1.0997 | in_mw_loss: 1.Epoch 2:  15%|▏| 2/13 [00:00<00:02,  5.37batch/s, Loss: 1.1748 | in_mw_loss: 1.Epoch 2:  23%|▏| 3/13 [00:00<00:01,  6.26batch/s, Loss: 1.1748 | in_mw_loss: 1.Epoch 2:  23%|▏| 3/13 [00:00<00:01,  6.26batch/s, Loss: 1.1084 | in_mw_loss: 1.Epoch 2:  31%|▎| 4/13 [00:00<00:01,  6.81batch/s, Loss: 1.1084 | in_mw_loss: 1.Epoch 2:  31%|▎| 4/13 [00:00<00:01,  6.81batch/s, Loss: 1.0560 | in_mw_loss: 1.Epoch 2:  38%|▍| 5/13 [00:00<00:01,  7.17batch/s, Loss: 1.0560 | in_mw_loss: 1.Epoch 2:  38%|▍| 5/13 [00:00<00:01,  7.17batch/s, Loss: 1.0917 | in_mw_loss: 1.Epoch 2:  46%|▍| 6/13 [00:00<00:00,  7.26batch/s, Loss: 1.0917 | in_mw_loss: 1.Epoch 2:  46%|▍| 6/13 [00:01<00:00,  7.26batch/s, Loss: 1.1367 | in_mw_loss: 1.Epoch 2:  54%|▌| 7/13 [00:01<00:00,  7.38batch/s, Loss: 1.1367 | in_mw_loss: 1.Epoch 2:  54%|▌| 7/13 [00:01<00:00,  7.38batch/s, Loss: 1.0326 | in_mw_loss: 1.Epoch 2:  62%|▌| 8/13 [00:01<00:00,  7.52batch/s, Loss: 1.0326 | in_mw_loss: 1.Epoch 2:  62%|▌| 8/13 [00:01<00:00,  7.52batch/s, Loss: 1.0426 | in_mw_loss: 1.Epoch 2:  69%|▋| 9/13 [00:01<00:00,  7.65batch/s, Loss: 1.0426 | in_mw_loss: 1.Epoch 2:  69%|▋| 9/13 [00:01<00:00,  7.65batch/s, Loss: 1.0473 | in_mw_loss: 1.Epoch 2:  77%|▊| 10/13 [00:01<00:00,  7.66batch/s, Loss: 1.0473 | in_mw_loss: 1Epoch 2:  77%|▊| 10/13 [00:01<00:00,  7.66batch/s, Loss: 1.0759 | in_mw_loss: 1Epoch 2:  85%|▊| 11/13 [00:01<00:00,  7.68batch/s, Loss: 1.0759 | in_mw_loss: 1Epoch 2:  85%|▊| 11/13 [00:01<00:00,  7.68batch/s, Loss: 1.1058 | in_mw_loss: 1Epoch 2:  92%|▉| 12/13 [00:01<00:00,  7.74batch/s, Loss: 1.1058 | in_mw_loss: 1Epoch 2:  92%|▉| 12/13 [00:01<00:00,  7.74batch/s, Loss: 1.0269 | in_mw_loss: 1Epoch 2: 100%|█| 13/13 [00:01<00:00,  7.36batch/s, Loss: 1.0269 | in_mw_loss: 1
Epoch [  2/  2], Loss: 1.0760, in_mw_loss: 1.0760, out_mw_loss: 1.0760, learning_rate: 3.0000e-04
data_shape torch.Size([320, 1, 96, 96, 96])
predict:   0%|                                         | 0/160 [00:00<?, ?it/s]predict:   1%|▏                                | 1/160 [00:00<00:25,  6.33it/s]predict:   3%|█                                | 5/160 [00:00<00:07, 21.75it/s]predict:   6%|█▊                               | 9/160 [00:00<00:05, 28.45it/s]predict:   8%|██▌                             | 13/160 [00:00<00:04, 32.19it/s]predict:  11%|███▍                            | 17/160 [00:00<00:04, 34.35it/s]predict:  13%|████▏                           | 21/160 [00:00<00:03, 35.37it/s]predict:  16%|█████                           | 25/160 [00:00<00:03, 36.17it/s]predict:  18%|█████▊                          | 29/160 [00:00<00:03, 36.93it/s]predict:  21%|██████▌                         | 33/160 [00:00<00:03, 37.25it/s]predict:  23%|███████▍                        | 37/160 [00:01<00:03, 37.26it/s]predict:  26%|████████▏                       | 41/160 [00:01<00:03, 37.05it/s]predict:  28%|█████████                       | 45/160 [00:01<00:03, 37.29it/s]predict:  31%|█████████▊                      | 49/160 [00:01<00:02, 37.52it/s]predict:  33%|██████████▌                     | 53/160 [00:01<00:02, 37.90it/s]predict:  36%|███████████▍                    | 57/160 [00:01<00:02, 38.16it/s]predict:  38%|████████████▏                   | 61/160 [00:01<00:02, 38.27it/s]predict:  41%|█████████████                   | 65/160 [00:01<00:02, 38.37it/s]predict:  43%|█████████████▊                  | 69/160 [00:01<00:02, 38.47it/s]predict:  46%|██████████████▌                 | 73/160 [00:02<00:02, 38.44it/s]predict:  48%|███████████████▍                | 77/160 [00:02<00:02, 38.41it/s]predict:  51%|████████████████▏               | 81/160 [00:02<00:02, 38.09it/s]predict:  53%|█████████████████               | 85/160 [00:02<00:01, 38.12it/s]predict:  56%|█████████████████▊              | 89/160 [00:02<00:01, 38.32it/s]predict:  58%|██████████████████▌             | 93/160 [00:02<00:01, 38.47it/s]predict:  61%|███████████████████▍            | 97/160 [00:02<00:01, 38.38it/s]predict:  63%|███████████████████▌           | 101/160 [00:02<00:01, 38.25it/s]predict:  66%|████████████████████▎          | 105/160 [00:02<00:01, 38.22it/s]predict:  68%|█████████████████████          | 109/160 [00:02<00:01, 38.29it/s]predict:  71%|█████████████████████▉         | 113/160 [00:03<00:01, 38.11it/s]predict:  73%|██████████████████████▋        | 117/160 [00:03<00:01, 38.18it/s]predict:  76%|███████████████████████▍       | 121/160 [00:03<00:01, 38.13it/s]predict:  78%|████████████████████████▏      | 125/160 [00:03<00:00, 38.26it/s]predict:  81%|████████████████████████▉      | 129/160 [00:03<00:00, 38.36it/s]predict:  83%|█████████████████████████▊     | 133/160 [00:03<00:00, 38.12it/s]predict:  86%|██████████████████████████▌    | 137/160 [00:03<00:00, 38.03it/s]predict:  88%|███████████████████████████▎   | 141/160 [00:03<00:00, 37.99it/s]predict:  91%|████████████████████████████   | 145/160 [00:03<00:00, 38.01it/s]predict:  93%|████████████████████████████▊  | 149/160 [00:04<00:00, 38.01it/s]predict:  96%|█████████████████████████████▋ | 153/160 [00:04<00:00, 37.90it/s]predict:  98%|██████████████████████████████▍| 157/160 [00:04<00:00, 37.83it/s]predict: 100%|███████████████████████████████| 160/160 [00:04<00:00, 36.95it/s]
size restored (330, 522, 522)
Saved slices and power spectrum for epoch 2 to 'denoise'
training tomograms for 2 epochs, remaining epochs 4
Epoch 1:   0%|                                       | 0/13 [00:00<?, ?batch/s]Epoch 1:   0%| | 0/13 [00:18<?, ?batch/s, Loss: 1.9614 | in_mw_loss: 1.9614 | oEpoch 1:   8%| | 1/13 [00:18<03:45, 18.78s/batch, Loss: 1.9614 | in_mw_loss: 1.Epoch 1:   8%| | 1/13 [00:18<03:45, 18.78s/batch, Loss: 1.6993 | in_mw_loss: 1.Epoch 1:  15%|▏| 2/13 [00:18<01:25,  7.81s/batch, Loss: 1.6993 | in_mw_loss: 1.Epoch 1:  15%|▏| 2/13 [00:19<01:25,  7.81s/batch, Loss: 1.3559 | in_mw_loss: 1.Epoch 1:  23%|▏| 3/13 [00:19<00:43,  4.30s/batch, Loss: 1.3559 | in_mw_loss: 1.Epoch 1:  23%|▏| 3/13 [00:19<00:43,  4.30s/batch, Loss: 1.3216 | in_mw_loss: 1.Epoch 1:  31%|▎| 4/13 [00:19<00:23,  2.66s/batch, Loss: 1.3216 | in_mw_loss: 1.Epoch 1:  31%|▎| 4/13 [00:19<00:23,  2.66s/batch, Loss: 1.2698 | in_mw_loss: 1.Epoch 1:  38%|▍| 5/13 [00:19<00:13,  1.74s/batch, Loss: 1.2698 | in_mw_loss: 1.Epoch 1:  38%|▍| 5/13 [00:19<00:13,  1.74s/batch, Loss: 1.2366 | in_mw_loss: 1.Epoch 1:  46%|▍| 6/13 [00:19<00:08,  1.19s/batch, Loss: 1.2366 | in_mw_loss: 1.Epoch 1:  46%|▍| 6/13 [00:19<00:08,  1.19s/batch, Loss: 1.2410 | in_mw_loss: 1.Epoch 1:  54%|▌| 7/13 [00:19<00:05,  1.18batch/s, Loss: 1.2410 | in_mw_loss: 1.Epoch 1:  54%|▌| 7/13 [00:19<00:05,  1.18batch/s, Loss: 1.1926 | in_mw_loss: 1.Epoch 1:  62%|▌| 8/13 [00:19<00:03,  1.62batch/s, Loss: 1.1926 | in_mw_loss: 1.Epoch 1:  62%|▌| 8/13 [00:19<00:03,  1.62batch/s, Loss: 1.1389 | in_mw_loss: 1.Epoch 1:  69%|▋| 9/13 [00:19<00:01,  2.14batch/s, Loss: 1.1389 | in_mw_loss: 1.Epoch 1:  69%|▋| 9/13 [00:19<00:01,  2.14batch/s, Loss: 1.2908 | in_mw_loss: 1.Epoch 1:  77%|▊| 10/13 [00:19<00:01,  2.75batch/s, Loss: 1.2908 | in_mw_loss: 1Epoch 1:  77%|▊| 10/13 [00:20<00:01,  2.75batch/s, Loss: 1.2193 | in_mw_loss: 1Epoch 1:  85%|▊| 11/13 [00:20<00:00,  3.42batch/s, Loss: 1.2193 | in_mw_loss: 1Epoch 1:  85%|▊| 11/13 [00:20<00:00,  3.42batch/s, Loss: 1.0681 | in_mw_loss: 1Epoch 1:  92%|▉| 12/13 [00:20<00:00,  4.11batch/s, Loss: 1.0681 | in_mw_loss: 1Epoch 1:  92%|▉| 12/13 [00:20<00:00,  4.11batch/s, Loss: 1.1107 | in_mw_loss: 1Epoch 1: 100%|█| 13/13 [00:20<00:00,  4.85batch/s, Loss: 1.1107 | in_mw_loss: 1Epoch 1: 100%|█| 13/13 [00:20<00:00,  1.56s/batch, Loss: 1.1107 | in_mw_loss: 1
Epoch [  1/  2], Loss: 1.3185, in_mw_loss: 1.3185, out_mw_loss: 1.3185, learning_rate: 3.0000e-04
Epoch 2:   0%|                                       | 0/13 [00:00<?, ?batch/s]Epoch 2:   0%| | 0/13 [00:00<?, ?batch/s, Loss: 1.1430 | in_mw_loss: 1.1430 | oEpoch 2:   8%| | 1/13 [00:00<00:02,  4.42batch/s, Loss: 1.1430 | in_mw_loss: 1.Epoch 2:   8%| | 1/13 [00:00<00:02,  4.42batch/s, Loss: 1.0995 | in_mw_loss: 1.Epoch 2:  15%|▏| 2/13 [00:00<00:01,  5.89batch/s, Loss: 1.0995 | in_mw_loss: 1.Epoch 2:  15%|▏| 2/13 [00:00<00:01,  5.89batch/s, Loss: 1.1698 | in_mw_loss: 1.Epoch 2:  23%|▏| 3/13 [00:00<00:01,  6.60batch/s, Loss: 1.1698 | in_mw_loss: 1.Epoch 2:  23%|▏| 3/13 [00:00<00:01,  6.60batch/s, Loss: 1.1095 | in_mw_loss: 1.Epoch 2:  31%|▎| 4/13 [00:00<00:01,  7.00batch/s, Loss: 1.1095 | in_mw_loss: 1.Epoch 2:  31%|▎| 4/13 [00:00<00:01,  7.00batch/s, Loss: 1.0558 | in_mw_loss: 1.Epoch 2:  38%|▍| 5/13 [00:00<00:01,  7.27batch/s, Loss: 1.0558 | in_mw_loss: 1.Epoch 2:  38%|▍| 5/13 [00:00<00:01,  7.27batch/s, Loss: 1.0930 | in_mw_loss: 1.Epoch 2:  46%|▍| 6/13 [00:00<00:00,  7.39batch/s, Loss: 1.0930 | in_mw_loss: 1.Epoch 2:  46%|▍| 6/13 [00:01<00:00,  7.39batch/s, Loss: 1.1396 | in_mw_loss: 1.Epoch 2:  54%|▌| 7/13 [00:01<00:00,  7.53batch/s, Loss: 1.1396 | in_mw_loss: 1.Epoch 2:  54%|▌| 7/13 [00:01<00:00,  7.53batch/s, Loss: 1.0329 | in_mw_loss: 1.Epoch 2:  62%|▌| 8/13 [00:01<00:00,  7.56batch/s, Loss: 1.0329 | in_mw_loss: 1.Epoch 2:  62%|▌| 8/13 [00:01<00:00,  7.56batch/s, Loss: 1.0452 | in_mw_loss: 1.Epoch 2:  69%|▋| 9/13 [00:01<00:00,  7.62batch/s, Loss: 1.0452 | in_mw_loss: 1.Epoch 2:  69%|▋| 9/13 [00:01<00:00,  7.62batch/s, Loss: 1.0470 | in_mw_loss: 1.Epoch 2:  77%|▊| 10/13 [00:01<00:00,  7.68batch/s, Loss: 1.0470 | in_mw_loss: 1Epoch 2:  77%|▊| 10/13 [00:01<00:00,  7.68batch/s, Loss: 1.0768 | in_mw_loss: 1Epoch 2:  85%|▊| 11/13 [00:01<00:00,  7.73batch/s, Loss: 1.0768 | in_mw_loss: 1Epoch 2:  85%|▊| 11/13 [00:01<00:00,  7.73batch/s, Loss: 1.1051 | in_mw_loss: 1Epoch 2:  92%|▉| 12/13 [00:01<00:00,  7.75batch/s, Loss: 1.1051 | in_mw_loss: 1Epoch 2:  92%|▉| 12/13 [00:01<00:00,  7.75batch/s, Loss: 1.0253 | in_mw_loss: 1Epoch 2: 100%|█| 13/13 [00:01<00:00,  7.51batch/s, Loss: 1.0253 | in_mw_loss: 1
Epoch [  2/  2], Loss: 1.0767, in_mw_loss: 1.0767, out_mw_loss: 1.0767, learning_rate: 3.0000e-04
data_shape torch.Size([320, 1, 96, 96, 96])
predict:   0%|                                         | 0/160 [00:00<?, ?it/s]predict:   1%|▏                                | 1/160 [00:00<00:25,  6.14it/s]predict:   3%|█                                | 5/160 [00:00<00:07, 21.43it/s]predict:   6%|█▊                               | 9/160 [00:00<00:05, 28.17it/s]predict:   8%|██▌                             | 13/160 [00:00<00:04, 31.79it/s]predict:  11%|███▍                            | 17/160 [00:00<00:04, 33.57it/s]predict:  13%|████▏                           | 21/160 [00:00<00:04, 34.74it/s]predict:  16%|█████                           | 25/160 [00:00<00:03, 35.74it/s]predict:  18%|█████▊                          | 29/160 [00:00<00:03, 35.93it/s]predict:  21%|██████▌                         | 33/160 [00:01<00:03, 36.43it/s]predict:  23%|███████▍                        | 37/160 [00:01<00:03, 36.62it/s]predict:  26%|████████▏                       | 41/160 [00:01<00:03, 36.97it/s]predict:  28%|█████████                       | 45/160 [00:01<00:03, 37.02it/s]predict:  31%|█████████▊                      | 49/160 [00:01<00:02, 37.01it/s]predict:  33%|██████████▌                     | 53/160 [00:01<00:02, 37.16it/s]predict:  36%|███████████▍                    | 57/160 [00:01<00:02, 37.33it/s]predict:  38%|████████████▏                   | 61/160 [00:01<00:02, 37.39it/s]predict:  41%|█████████████                   | 65/160 [00:01<00:02, 37.37it/s]predict:  43%|█████████████▊                  | 69/160 [00:01<00:02, 37.64it/s]predict:  46%|██████████████▌                 | 73/160 [00:02<00:02, 37.47it/s]predict:  48%|███████████████▍                | 77/160 [00:02<00:02, 37.32it/s]predict:  51%|████████████████▏               | 81/160 [00:02<00:02, 37.46it/s]predict:  53%|█████████████████               | 85/160 [00:02<00:01, 37.87it/s]predict:  56%|█████████████████▊              | 89/160 [00:02<00:01, 38.26it/s]predict:  58%|██████████████████▌             | 93/160 [00:02<00:01, 38.47it/s]predict:  61%|███████████████████▍            | 97/160 [00:02<00:01, 38.31it/s]predict:  63%|███████████████████▌           | 101/160 [00:02<00:01, 38.17it/s]predict:  66%|████████████████████▎          | 105/160 [00:02<00:01, 38.11it/s]predict:  68%|█████████████████████          | 109/160 [00:03<00:01, 38.34it/s]predict:  71%|█████████████████████▉         | 113/160 [00:03<00:01, 38.55it/s]predict:  73%|██████████████████████▋        | 117/160 [00:03<00:01, 38.38it/s]predict:  76%|███████████████████████▍       | 121/160 [00:03<00:01, 38.11it/s]predict:  78%|████████████████████████▏      | 125/160 [00:03<00:00, 38.46it/s]predict:  81%|████████████████████████▉      | 129/160 [00:03<00:00, 38.60it/s]predict:  83%|█████████████████████████▊     | 133/160 [00:03<00:00, 38.35it/s]predict:  86%|██████████████████████████▌    | 137/160 [00:03<00:00, 38.27it/s]predict:  88%|███████████████████████████▎   | 141/160 [00:03<00:00, 38.27it/s]predict:  91%|████████████████████████████   | 145/160 [00:03<00:00, 38.27it/s]predict:  93%|████████████████████████████▊  | 149/160 [00:04<00:00, 38.13it/s]predict:  96%|█████████████████████████████▋ | 153/160 [00:04<00:00, 37.98it/s]predict:  98%|██████████████████████████████▍| 157/160 [00:04<00:00, 38.01it/s]predict: 100%|███████████████████████████████| 160/160 [00:04<00:00, 36.68it/s]
size restored (330, 522, 522)
Saved slices and power spectrum for epoch 4 to 'denoise'
training tomograms for 2 epochs, remaining epochs 2
Epoch 1:   0%|                                       | 0/13 [00:00<?, ?batch/s]Epoch 1:   0%| | 0/13 [00:18<?, ?batch/s, Loss: 1.9604 | in_mw_loss: 1.9604 | oEpoch 1:   8%| | 1/13 [00:18<03:46, 18.89s/batch, Loss: 1.9604 | in_mw_loss: 1.Epoch 1:   8%| | 1/13 [00:19<03:46, 18.89s/batch, Loss: 1.6993 | in_mw_loss: 1.Epoch 1:  15%|▏| 2/13 [00:19<01:26,  7.85s/batch, Loss: 1.6993 | in_mw_loss: 1.Epoch 1:  15%|▏| 2/13 [00:19<01:26,  7.85s/batch, Loss: 1.3560 | in_mw_loss: 1.Epoch 1:  23%|▏| 3/13 [00:19<00:43,  4.33s/batch, Loss: 1.3560 | in_mw_loss: 1.Epoch 1:  23%|▏| 3/13 [00:19<00:43,  4.33s/batch, Loss: 1.3221 | in_mw_loss: 1.Epoch 1:  31%|▎| 4/13 [00:19<00:24,  2.67s/batch, Loss: 1.3221 | in_mw_loss: 1.Epoch 1:  31%|▎| 4/13 [00:19<00:24,  2.67s/batch, Loss: 1.2708 | in_mw_loss: 1.Epoch 1:  38%|▍| 5/13 [00:19<00:14,  1.75s/batch, Loss: 1.2708 | in_mw_loss: 1.Epoch 1:  38%|▍| 5/13 [00:19<00:14,  1.75s/batch, Loss: 1.2392 | in_mw_loss: 1.Epoch 1:  46%|▍| 6/13 [00:19<00:08,  1.20s/batch, Loss: 1.2392 | in_mw_loss: 1.Epoch 1:  46%|▍| 6/13 [00:19<00:08,  1.20s/batch, Loss: 1.2420 | in_mw_loss: 1.Epoch 1:  54%|▌| 7/13 [00:19<00:05,  1.18batch/s, Loss: 1.2420 | in_mw_loss: 1.Epoch 1:  54%|▌| 7/13 [00:19<00:05,  1.18batch/s, Loss: 1.1913 | in_mw_loss: 1.Epoch 1:  62%|▌| 8/13 [00:19<00:03,  1.61batch/s, Loss: 1.1913 | in_mw_loss: 1.Epoch 1:  62%|▌| 8/13 [00:19<00:03,  1.61batch/s, Loss: 1.1410 | in_mw_loss: 1.Epoch 1:  69%|▋| 9/13 [00:19<00:01,  2.14batch/s, Loss: 1.1410 | in_mw_loss: 1.Epoch 1:  69%|▋| 9/13 [00:20<00:01,  2.14batch/s, Loss: 1.2958 | in_mw_loss: 1.Epoch 1:  77%|▊| 10/13 [00:20<00:01,  2.76batch/s, Loss: 1.2958 | in_mw_loss: 1Epoch 1:  77%|▊| 10/13 [00:20<00:01,  2.76batch/s, Loss: 1.2165 | in_mw_loss: 1Epoch 1:  85%|▊| 11/13 [00:20<00:00,  3.45batch/s, Loss: 1.2165 | in_mw_loss: 1Epoch 1:  85%|▊| 11/13 [00:20<00:00,  3.45batch/s, Loss: 1.0690 | in_mw_loss: 1Epoch 1:  92%|▉| 12/13 [00:20<00:00,  4.11batch/s, Loss: 1.0690 | in_mw_loss: 1Epoch 1:  92%|▉| 12/13 [00:20<00:00,  4.11batch/s, Loss: 1.1106 | in_mw_loss: 1Epoch 1: 100%|█| 13/13 [00:20<00:00,  4.96batch/s, Loss: 1.1106 | in_mw_loss: 1Epoch 1: 100%|█| 13/13 [00:20<00:00,  1.57s/batch, Loss: 1.1106 | in_mw_loss: 1
Epoch [  1/  2], Loss: 1.3189, in_mw_loss: 1.3189, out_mw_loss: 1.3189, learning_rate: 3.0000e-04
Epoch 2:   0%|                                       | 0/13 [00:00<?, ?batch/s]Epoch 2:   0%| | 0/13 [00:00<?, ?batch/s, Loss: 1.1390 | in_mw_loss: 1.1390 | oEpoch 2:   8%| | 1/13 [00:00<00:02,  4.01batch/s, Loss: 1.1390 | in_mw_loss: 1.Epoch 2:   8%| | 1/13 [00:00<00:02,  4.01batch/s, Loss: 1.0953 | in_mw_loss: 1.Epoch 2:  15%|▏| 2/13 [00:00<00:01,  5.65batch/s, Loss: 1.0953 | in_mw_loss: 1.Epoch 2:  15%|▏| 2/13 [00:00<00:01,  5.65batch/s, Loss: 1.1725 | in_mw_loss: 1.Epoch 2:  23%|▏| 3/13 [00:00<00:01,  6.48batch/s, Loss: 1.1725 | in_mw_loss: 1.Epoch 2:  23%|▏| 3/13 [00:00<00:01,  6.48batch/s, Loss: 1.1087 | in_mw_loss: 1.Epoch 2:  31%|▎| 4/13 [00:00<00:01,  6.95batch/s, Loss: 1.1087 | in_mw_loss: 1.Epoch 2:  31%|▎| 4/13 [00:00<00:01,  6.95batch/s, Loss: 1.0557 | in_mw_loss: 1.Epoch 2:  38%|▍| 5/13 [00:00<00:01,  7.26batch/s, Loss: 1.0557 | in_mw_loss: 1.Epoch 2:  38%|▍| 5/13 [00:00<00:01,  7.26batch/s, Loss: 1.0935 | in_mw_loss: 1.Epoch 2:  46%|▍| 6/13 [00:00<00:00,  7.46batch/s, Loss: 1.0935 | in_mw_loss: 1.Epoch 2:  46%|▍| 6/13 [00:01<00:00,  7.46batch/s, Loss: 1.1398 | in_mw_loss: 1.Epoch 2:  54%|▌| 7/13 [00:01<00:00,  7.60batch/s, Loss: 1.1398 | in_mw_loss: 1.Epoch 2:  54%|▌| 7/13 [00:01<00:00,  7.60batch/s, Loss: 1.0357 | in_mw_loss: 1.Epoch 2:  62%|▌| 8/13 [00:01<00:00,  7.70batch/s, Loss: 1.0357 | in_mw_loss: 1.Epoch 2:  62%|▌| 8/13 [00:01<00:00,  7.70batch/s, Loss: 1.0427 | in_mw_loss: 1.Epoch 2:  69%|▋| 9/13 [00:01<00:00,  7.75batch/s, Loss: 1.0427 | in_mw_loss: 1.Epoch 2:  69%|▋| 9/13 [00:01<00:00,  7.75batch/s, Loss: 1.0468 | in_mw_loss: 1.Epoch 2:  77%|▊| 10/13 [00:01<00:00,  7.69batch/s, Loss: 1.0468 | in_mw_loss: 1Epoch 2:  77%|▊| 10/13 [00:01<00:00,  7.69batch/s, Loss: 1.0743 | in_mw_loss: 1Epoch 2:  85%|▊| 11/13 [00:01<00:00,  7.69batch/s, Loss: 1.0743 | in_mw_loss: 1Epoch 2:  85%|▊| 11/13 [00:01<00:00,  7.69batch/s, Loss: 1.1057 | in_mw_loss: 1Epoch 2:  92%|▉| 12/13 [00:01<00:00,  7.71batch/s, Loss: 1.1057 | in_mw_loss: 1Epoch 2:  92%|▉| 12/13 [00:01<00:00,  7.71batch/s, Loss: 1.0283 | in_mw_loss: 1Epoch 2: 100%|█| 13/13 [00:01<00:00,  7.48batch/s, Loss: 1.0283 | in_mw_loss: 1
Epoch [  2/  2], Loss: 1.0763, in_mw_loss: 1.0763, out_mw_loss: 1.0763, learning_rate: 3.0000e-04
data_shape torch.Size([320, 1, 96, 96, 96])
predict:   0%|                                         | 0/160 [00:00<?, ?it/s]predict:   1%|▏                                | 1/160 [00:00<00:25,  6.27it/s]predict:   3%|█                                | 5/160 [00:00<00:07, 21.91it/s]predict:   6%|█▊                               | 9/160 [00:00<00:05, 28.56it/s]predict:   8%|██▌                             | 13/160 [00:00<00:04, 32.29it/s]predict:  11%|███▍                            | 17/160 [00:00<00:04, 34.44it/s]predict:  13%|████▏                           | 21/160 [00:00<00:03, 35.97it/s]predict:  16%|█████                           | 25/160 [00:00<00:03, 36.99it/s]predict:  18%|█████▊                          | 29/160 [00:00<00:03, 37.60it/s]predict:  21%|██████▌                         | 33/160 [00:00<00:03, 37.97it/s]predict:  23%|███████▍                        | 37/160 [00:01<00:03, 38.25it/s]predict:  26%|████████▏                       | 41/160 [00:01<00:03, 38.32it/s]predict:  28%|█████████                       | 45/160 [00:01<00:02, 38.39it/s]predict:  31%|█████████▊                      | 49/160 [00:01<00:02, 38.47it/s]predict:  33%|██████████▌                     | 53/160 [00:01<00:02, 38.46it/s]predict:  36%|███████████▍                    | 57/160 [00:01<00:02, 38.19it/s]predict:  38%|████████████▏                   | 61/160 [00:01<00:02, 37.83it/s]predict:  41%|█████████████                   | 65/160 [00:01<00:02, 37.80it/s]predict:  43%|█████████████▊                  | 69/160 [00:01<00:02, 37.98it/s]predict:  46%|██████████████▌                 | 73/160 [00:02<00:02, 37.91it/s]predict:  48%|███████████████▍                | 77/160 [00:02<00:02, 37.79it/s]predict:  51%|████████████████▏               | 81/160 [00:02<00:02, 38.05it/s]predict:  53%|█████████████████               | 85/160 [00:02<00:01, 37.98it/s]predict:  56%|█████████████████▊              | 89/160 [00:02<00:01, 37.93it/s]predict:  58%|██████████████████▌             | 93/160 [00:02<00:01, 37.45it/s]predict:  61%|███████████████████▍            | 97/160 [00:02<00:01, 37.69it/s]predict:  63%|███████████████████▌           | 101/160 [00:02<00:01, 38.09it/s]predict:  66%|████████████████████▎          | 105/160 [00:02<00:01, 38.32it/s]predict:  68%|█████████████████████          | 109/160 [00:02<00:01, 38.52it/s]predict:  71%|█████████████████████▉         | 113/160 [00:03<00:01, 38.72it/s]predict:  73%|██████████████████████▋        | 117/160 [00:03<00:01, 38.74it/s]predict:  76%|███████████████████████▍       | 121/160 [00:03<00:01, 38.69it/s]predict:  78%|████████████████████████▏      | 125/160 [00:03<00:00, 38.69it/s]predict:  81%|████████████████████████▉      | 129/160 [00:03<00:00, 38.67it/s]predict:  83%|█████████████████████████▊     | 133/160 [00:03<00:00, 38.57it/s]predict:  86%|██████████████████████████▌    | 137/160 [00:03<00:00, 38.69it/s]predict:  88%|███████████████████████████▎   | 141/160 [00:03<00:00, 38.58it/s]predict:  91%|████████████████████████████   | 145/160 [00:03<00:00, 38.78it/s]predict:  93%|████████████████████████████▊  | 149/160 [00:04<00:00, 38.71it/s]predict:  96%|█████████████████████████████▋ | 153/160 [00:04<00:00, 38.29it/s]predict:  98%|██████████████████████████████▍| 157/160 [00:04<00:00, 38.29it/s]predict: 100%|███████████████████████████████| 160/160 [00:04<00:00, 37.19it/s]
07-18 23:04:40, INFO     Port number: 59773
07-18 23:04:40, INFO     Port number: 54093
size restored (330, 522, 522)
Saved slices and power spectrum for epoch 6 to 'denoise'
denoise/network_n2n_unet-medium_96_full.pt
Total number of parameters: 23989825
denoise/network_n2n_unet-medium_96_full.pt
Total number of parameters: 23989825
Predict:   0%|          | 0/5 [00:00<?, ?it/s]/home/cii/software/IsoApp/tomograms_wbp/EVN/TS_01_EVN_wbp-b2.mrc
data_shape torch.Size([320, 1, 96, 96, 96])
predict:   0%|                                         | 0/160 [00:00<?, ?it/s]predict:   1%|▏                                | 1/160 [00:00<00:25,  6.15it/s]predict:   3%|█                                | 5/160 [00:00<00:07, 21.60it/s]predict:   6%|█▊                               | 9/160 [00:00<00:05, 28.48it/s]predict:   8%|██▌                             | 13/160 [00:00<00:04, 31.76it/s]predict:  11%|███▍                            | 17/160 [00:00<00:04, 34.08it/s]predict:  13%|████▏                           | 21/160 [00:00<00:03, 35.55it/s]predict:  16%|█████                           | 25/160 [00:00<00:03, 36.33it/s]predict:  18%|█████▊                          | 29/160 [00:00<00:03, 37.03it/s]predict:  21%|██████▌                         | 33/160 [00:00<00:03, 37.31it/s]predict:  23%|███████▍                        | 37/160 [00:01<00:03, 37.29it/s]predict:  26%|████████▏                       | 41/160 [00:01<00:03, 37.66it/s]predict:  28%|█████████                       | 45/160 [00:01<00:03, 37.56it/s]predict:  31%|█████████▊                      | 49/160 [00:01<00:02, 37.60it/s]predict:  33%|██████████▌                     | 53/160 [00:01<00:02, 37.91it/s]predict:  36%|███████████▍                    | 57/160 [00:01<00:02, 38.03it/s]predict:  38%|████████████▏                   | 61/160 [00:01<00:02, 37.96it/s]predict:  41%|█████████████                   | 65/160 [00:01<00:02, 37.78it/s]predict:  43%|█████████████▊                  | 69/160 [00:01<00:02, 37.66it/s]predict:  46%|██████████████▌                 | 73/160 [00:02<00:02, 37.47it/s]predict:  48%|███████████████▍                | 77/160 [00:02<00:02, 37.46it/s]predict:  51%|████████████████▏               | 81/160 [00:02<00:02, 37.77it/s]predict:  53%|█████████████████               | 85/160 [00:02<00:01, 38.04it/s]predict:  56%|█████████████████▊              | 89/160 [00:02<00:01, 38.05it/s]predict:  58%|██████████████████▌             | 93/160 [00:02<00:01, 38.06it/s]predict:  61%|███████████████████▍            | 97/160 [00:02<00:01, 37.73it/s]predict:  63%|███████████████████▌           | 101/160 [00:02<00:01, 38.02it/s]predict:  66%|████████████████████▎          | 105/160 [00:02<00:01, 37.83it/s]predict:  68%|█████████████████████          | 109/160 [00:03<00:01, 37.85it/s]predict:  71%|█████████████████████▉         | 113/160 [00:03<00:01, 38.16it/s]predict:  73%|██████████████████████▋        | 117/160 [00:03<00:01, 38.37it/s]predict:  76%|███████████████████████▍       | 121/160 [00:03<00:01, 38.55it/s]predict:  78%|████████████████████████▏      | 125/160 [00:03<00:00, 38.51it/s]predict:  81%|████████████████████████▉      | 129/160 [00:03<00:00, 38.34it/s]predict:  83%|█████████████████████████▊     | 133/160 [00:03<00:00, 38.11it/s]predict:  86%|██████████████████████████▌    | 137/160 [00:03<00:00, 37.91it/s]predict:  88%|███████████████████████████▎   | 141/160 [00:03<00:00, 37.89it/s]predict:  91%|████████████████████████████   | 145/160 [00:03<00:00, 38.14it/s]predict:  93%|████████████████████████████▊  | 149/160 [00:04<00:00, 38.18it/s]predict:  96%|█████████████████████████████▋ | 153/160 [00:04<00:00, 38.27it/s]predict:  98%|██████████████████████████████▍| 157/160 [00:04<00:00, 38.44it/s]predict: 100%|███████████████████████████████| 160/160 [00:04<00:00, 36.89it/s]
size restored (330, 522, 522)
/home/cii/software/IsoApp/tomograms_wbp/ODD/TS_01_ODD_wbp-b2.mrc
data_shape torch.Size([320, 1, 96, 96, 96])
predict:   0%|                                         | 0/160 [00:00<?, ?it/s]predict:   1%|▏                                | 1/160 [00:00<00:24,  6.44it/s]predict:   3%|█                                | 5/160 [00:00<00:07, 22.04it/s]predict:   6%|█▊                               | 9/160 [00:00<00:05, 28.74it/s]predict:   8%|██▌                             | 13/160 [00:00<00:04, 32.21it/s]predict:  11%|███▍                            | 17/160 [00:00<00:04, 34.39it/s]predict:  13%|████▏                           | 21/160 [00:00<00:03, 35.68it/s]predict:  16%|█████                           | 25/160 [00:00<00:03, 36.65it/s]predict:  18%|█████▊                          | 29/160 [00:00<00:03, 37.26it/s]predict:  21%|██████▌                         | 33/160 [00:00<00:03, 37.57it/s]predict:  23%|███████▍                        | 37/160 [00:01<00:03, 37.75it/s]predict:  26%|████████▏                       | 41/160 [00:01<00:03, 37.59it/s]predict:  28%|█████████                       | 45/160 [00:01<00:03, 37.46it/s]predict:  31%|█████████▊                      | 49/160 [00:01<00:02, 37.65it/s]predict:  33%|██████████▌                     | 53/160 [00:01<00:02, 37.57it/s]predict:  36%|███████████▍                    | 57/160 [00:01<00:02, 37.77it/s]predict:  38%|████████████▏                   | 61/160 [00:01<00:02, 37.90it/s]predict:  41%|█████████████                   | 65/160 [00:01<00:02, 38.04it/s]predict:  43%|█████████████▊                  | 69/160 [00:01<00:02, 37.81it/s]predict:  46%|██████████████▌                 | 73/160 [00:02<00:02, 37.99it/s]predict:  48%|███████████████▍                | 77/160 [00:02<00:02, 37.84it/s]predict:  51%|████████████████▏               | 81/160 [00:02<00:02, 37.76it/s]predict:  53%|█████████████████               | 85/160 [00:02<00:01, 37.95it/s]predict:  56%|█████████████████▊              | 89/160 [00:02<00:01, 37.93it/s]predict:  58%|██████████████████▌             | 93/160 [00:02<00:01, 38.00it/s]predict:  61%|███████████████████▍            | 97/160 [00:02<00:01, 38.11it/s]predict:  63%|███████████████████▌           | 101/160 [00:02<00:01, 38.45it/s]predict:  66%|████████████████████▎          | 105/160 [00:02<00:01, 38.62it/s]predict:  68%|█████████████████████          | 109/160 [00:02<00:01, 38.70it/s]predict:  71%|█████████████████████▉         | 113/160 [00:03<00:01, 38.79it/s]predict:  73%|██████████████████████▋        | 117/160 [00:03<00:01, 38.47it/s]predict:  76%|███████████████████████▍       | 121/160 [00:03<00:01, 38.29it/s]predict:  78%|████████████████████████▏      | 125/160 [00:03<00:00, 38.44it/s]predict:  81%|████████████████████████▉      | 129/160 [00:03<00:00, 38.46it/s]predict:  83%|█████████████████████████▊     | 133/160 [00:03<00:00, 38.55it/s]predict:  86%|██████████████████████████▌    | 137/160 [00:03<00:00, 38.47it/s]predict:  88%|███████████████████████████▎   | 141/160 [00:03<00:00, 38.49it/s]predict:  91%|████████████████████████████   | 145/160 [00:03<00:00, 38.46it/s]predict:  93%|████████████████████████████▊  | 149/160 [00:04<00:00, 38.27it/s]predict:  96%|█████████████████████████████▋ | 153/160 [00:04<00:00, 38.07it/s]predict:  98%|██████████████████████████████▍| 157/160 [00:04<00:00, 38.22it/s]predict: 100%|███████████████████████████████| 160/160 [00:04<00:00, 37.06it/s]
07-18 23:05:13, INFO     Predicted ['/home/cii/software/IsoApp/tomograms_wbp/EVN/TS_01_EVN_wbp-b2.mrc', '/home/cii/software/IsoApp/tomograms_wbp/ODD/TS_01_ODD_wbp-b2.mrc'] → denoise/corrected_n2n_unet-medium_TS_01_EVN_wbp-b2.mrc
Predict:  20%|██        | 1/5 [00:33<02:13, 33.31s/it]size restored (330, 522, 522)
/home/cii/software/IsoApp/tomograms_wbp/EVN/TS_03_EVN_wbp-b2.mrc
data_shape torch.Size([320, 1, 96, 96, 96])
predict:   0%|                                         | 0/160 [00:00<?, ?it/s]predict:   1%|▏                                | 1/160 [00:00<00:24,  6.49it/s]predict:   3%|█                                | 5/160 [00:00<00:06, 22.18it/s]predict:   6%|█▊                               | 9/160 [00:00<00:05, 28.86it/s]predict:   8%|██▌                             | 13/160 [00:00<00:04, 32.15it/s]predict:  11%|███▍                            | 17/160 [00:00<00:04, 33.96it/s]predict:  13%|████▏                           | 21/160 [00:00<00:03, 35.21it/s]predict:  16%|█████                           | 25/160 [00:00<00:03, 36.34it/s]predict:  18%|█████▊                          | 29/160 [00:00<00:03, 37.04it/s]predict:  21%|██████▌                         | 33/160 [00:00<00:03, 37.45it/s]predict:  23%|███████▍                        | 37/160 [00:01<00:03, 37.32it/s]predict:  26%|████████▏                       | 41/160 [00:01<00:03, 37.23it/s]predict:  28%|█████████                       | 45/160 [00:01<00:03, 37.16it/s]predict:  31%|█████████▊                      | 49/160 [00:01<00:02, 37.26it/s]predict:  33%|██████████▌                     | 53/160 [00:01<00:02, 37.27it/s]predict:  36%|███████████▍                    | 57/160 [00:01<00:02, 37.40it/s]predict:  38%|████████████▏                   | 61/160 [00:01<00:02, 37.45it/s]predict:  41%|█████████████                   | 65/160 [00:01<00:02, 37.59it/s]predict:  43%|█████████████▊                  | 69/160 [00:01<00:02, 37.72it/s]predict:  46%|██████████████▌                 | 73/160 [00:02<00:02, 37.57it/s]predict:  48%|███████████████▍                | 77/160 [00:02<00:02, 37.65it/s]predict:  51%|████████████████▏               | 81/160 [00:02<00:02, 37.82it/s]predict:  53%|█████████████████               | 85/160 [00:02<00:01, 37.82it/s]predict:  56%|█████████████████▊              | 89/160 [00:02<00:01, 38.04it/s]predict:  58%|██████████████████▌             | 93/160 [00:02<00:01, 37.96it/s]predict:  61%|███████████████████▍            | 97/160 [00:02<00:01, 37.98it/s]predict:  63%|███████████████████▌           | 101/160 [00:02<00:01, 38.21it/s]predict:  66%|████████████████████▎          | 105/160 [00:02<00:01, 38.11it/s]predict:  68%|█████████████████████          | 109/160 [00:03<00:01, 38.10it/s]predict:  71%|█████████████████████▉         | 113/160 [00:03<00:01, 38.10it/s]predict:  73%|██████████████████████▋        | 117/160 [00:03<00:01, 37.94it/s]predict:  76%|███████████████████████▍       | 121/160 [00:03<00:01, 37.77it/s]predict:  78%|████████████████████████▏      | 125/160 [00:03<00:00, 37.85it/s]predict:  81%|████████████████████████▉      | 129/160 [00:03<00:00, 37.81it/s]predict:  83%|█████████████████████████▊     | 133/160 [00:03<00:00, 38.01it/s]predict:  86%|██████████████████████████▌    | 137/160 [00:03<00:00, 38.09it/s]predict:  88%|███████████████████████████▎   | 141/160 [00:03<00:00, 38.35it/s]predict:  91%|████████████████████████████   | 145/160 [00:03<00:00, 38.57it/s]predict:  93%|████████████████████████████▊  | 149/160 [00:04<00:00, 38.50it/s]predict:  96%|█████████████████████████████▋ | 153/160 [00:04<00:00, 38.61it/s]predict:  98%|██████████████████████████████▍| 157/160 [00:04<00:00, 38.64it/s]predict: 100%|███████████████████████████████| 160/160 [00:04<00:00, 36.89it/s]
size restored (330, 522, 522)
/home/cii/software/IsoApp/tomograms_wbp/ODD/TS_03_ODD_wbp-b2.mrc
data_shape torch.Size([320, 1, 96, 96, 96])
predict:   0%|                                         | 0/160 [00:00<?, ?it/s]predict:   1%|▏                                | 1/160 [00:00<00:24,  6.37it/s]predict:   3%|█                                | 5/160 [00:00<00:07, 21.92it/s]predict:   6%|█▊                               | 9/160 [00:00<00:05, 28.41it/s]predict:   8%|██▌                             | 13/160 [00:00<00:04, 31.66it/s]predict:  11%|███▍                            | 17/160 [00:00<00:04, 33.88it/s]predict:  13%|████▏                           | 21/160 [00:00<00:03, 35.34it/s]predict:  16%|█████                           | 25/160 [00:00<00:03, 35.61it/s]predict:  18%|█████▊                          | 29/160 [00:00<00:03, 36.48it/s]predict:  21%|██████▌                         | 33/160 [00:01<00:03, 36.66it/s]predict:  23%|███████▍                        | 37/160 [00:01<00:03, 36.94it/s]predict:  26%|████████▏                       | 41/160 [00:01<00:03, 36.88it/s]predict:  28%|█████████                       | 45/160 [00:01<00:03, 37.07it/s]predict:  31%|█████████▊                      | 49/160 [00:01<00:02, 37.12it/s]predict:  33%|██████████▌                     | 53/160 [00:01<00:02, 37.21it/s]predict:  36%|███████████▍                    | 57/160 [00:01<00:02, 37.36it/s]predict:  38%|████████████▏                   | 61/160 [00:01<00:02, 37.07it/s]predict:  41%|█████████████                   | 65/160 [00:01<00:02, 37.12it/s]predict:  43%|█████████████▊                  | 69/160 [00:01<00:02, 37.46it/s]predict:  46%|██████████████▌                 | 73/160 [00:02<00:02, 37.48it/s]predict:  48%|███████████████▍                | 77/160 [00:02<00:02, 37.36it/s]predict:  51%|████████████████▏               | 81/160 [00:02<00:02, 37.36it/s]predict:  53%|█████████████████               | 85/160 [00:02<00:02, 37.50it/s]predict:  56%|█████████████████▊              | 89/160 [00:02<00:01, 37.64it/s]predict:  58%|██████████████████▌             | 93/160 [00:02<00:01, 37.95it/s]predict:  61%|███████████████████▍            | 97/160 [00:02<00:01, 38.21it/s]predict:  63%|███████████████████▌           | 101/160 [00:02<00:01, 38.34it/s]predict:  66%|████████████████████▎          | 105/160 [00:02<00:01, 38.15it/s]predict:  68%|█████████████████████          | 109/160 [00:03<00:01, 38.03it/s]predict:  71%|█████████████████████▉         | 113/160 [00:03<00:01, 38.25it/s]predict:  73%|██████████████████████▋        | 117/160 [00:03<00:01, 38.27it/s]predict:  76%|███████████████████████▍       | 121/160 [00:03<00:01, 38.30it/s]predict:  78%|████████████████████████▏      | 125/160 [00:03<00:00, 38.13it/s]predict:  81%|████████████████████████▉      | 129/160 [00:03<00:00, 38.09it/s]predict:  83%|█████████████████████████▊     | 133/160 [00:03<00:00, 38.13it/s]predict:  86%|██████████████████████████▌    | 137/160 [00:03<00:00, 37.84it/s]predict:  88%|███████████████████████████▎   | 141/160 [00:03<00:00, 37.66it/s]predict:  91%|████████████████████████████   | 145/160 [00:03<00:00, 37.47it/s]predict:  93%|████████████████████████████▊  | 149/160 [00:04<00:00, 37.39it/s]predict:  96%|█████████████████████████████▋ | 153/160 [00:04<00:00, 37.64it/s]predict:  98%|██████████████████████████████▍| 157/160 [00:04<00:00, 37.78it/s]predict: 100%|███████████████████████████████| 160/160 [00:04<00:00, 36.59it/s]
07-18 23:05:46, INFO     Predicted ['/home/cii/software/IsoApp/tomograms_wbp/EVN/TS_03_EVN_wbp-b2.mrc', '/home/cii/software/IsoApp/tomograms_wbp/ODD/TS_03_ODD_wbp-b2.mrc'] → denoise/corrected_n2n_unet-medium_TS_03_EVN_wbp-b2.mrc
Predict:  40%|████      | 2/5 [01:06<01:39, 33.31s/it]size restored (330, 522, 522)
/home/cii/software/IsoApp/tomograms_wbp/EVN/TS_43_EVN_wbp-b2.mrc
data_shape torch.Size([320, 1, 96, 96, 96])
predict:   0%|                                         | 0/160 [00:00<?, ?it/s]predict:   1%|▏                                | 1/160 [00:00<00:25,  6.20it/s]predict:   3%|█                                | 5/160 [00:00<00:07, 21.50it/s]predict:   6%|█▊                               | 9/160 [00:00<00:05, 28.19it/s]predict:   8%|██▌                             | 13/160 [00:00<00:04, 31.82it/s]predict:  11%|███▍                            | 17/160 [00:00<00:04, 33.87it/s]predict:  13%|████▏                           | 21/160 [00:00<00:03, 35.07it/s]predict:  16%|█████                           | 25/160 [00:00<00:03, 35.92it/s]predict:  18%|█████▊                          | 29/160 [00:00<00:03, 36.55it/s]predict:  21%|██████▌                         | 33/160 [00:01<00:03, 36.83it/s]predict:  23%|███████▍                        | 37/160 [00:01<00:03, 36.99it/s]predict:  26%|████████▏                       | 41/160 [00:01<00:03, 37.39it/s]predict:  28%|█████████                       | 45/160 [00:01<00:03, 37.67it/s]predict:  31%|█████████▊                      | 49/160 [00:01<00:02, 37.71it/s]predict:  33%|██████████▌                     | 53/160 [00:01<00:02, 37.55it/s]predict:  36%|███████████▍                    | 57/160 [00:01<00:02, 37.15it/s]predict:  38%|████████████▏                   | 61/160 [00:01<00:02, 37.16it/s]predict:  41%|█████████████                   | 65/160 [00:01<00:02, 37.37it/s]predict:  43%|█████████████▊                  | 69/160 [00:01<00:02, 37.36it/s]predict:  46%|██████████████▌                 | 73/160 [00:02<00:02, 37.47it/s]predict:  48%|███████████████▍                | 77/160 [00:02<00:02, 37.47it/s]predict:  51%|████████████████▏               | 81/160 [00:02<00:02, 37.59it/s]predict:  53%|█████████████████               | 85/160 [00:02<00:01, 37.72it/s]predict:  56%|█████████████████▊              | 89/160 [00:02<00:01, 37.81it/s]predict:  58%|██████████████████▌             | 93/160 [00:02<00:01, 38.06it/s]predict:  61%|███████████████████▍            | 97/160 [00:02<00:01, 38.07it/s]predict:  63%|███████████████████▌           | 101/160 [00:02<00:01, 38.05it/s]predict:  66%|████████████████████▎          | 105/160 [00:02<00:01, 38.13it/s]predict:  68%|█████████████████████          | 109/160 [00:03<00:01, 38.11it/s]predict:  71%|█████████████████████▉         | 113/160 [00:03<00:01, 38.34it/s]predict:  73%|██████████████████████▋        | 117/160 [00:03<00:01, 38.07it/s]predict:  76%|███████████████████████▍       | 121/160 [00:03<00:01, 38.03it/s]predict:  78%|████████████████████████▏      | 125/160 [00:03<00:00, 38.07it/s]predict:  81%|████████████████████████▉      | 129/160 [00:03<00:00, 38.26it/s]predict:  83%|█████████████████████████▊     | 133/160 [00:03<00:00, 38.39it/s]predict:  86%|██████████████████████████▌    | 137/160 [00:03<00:00, 38.56it/s]predict:  88%|███████████████████████████▎   | 141/160 [00:03<00:00, 38.05it/s]predict:  91%|████████████████████████████   | 145/160 [00:03<00:00, 38.25it/s]predict:  93%|████████████████████████████▊  | 149/160 [00:04<00:00, 38.15it/s]predict:  96%|█████████████████████████████▋ | 153/160 [00:04<00:00, 38.32it/s]predict:  98%|██████████████████████████████▍| 157/160 [00:04<00:00, 38.50it/s]predict: 100%|███████████████████████████████| 160/160 [00:04<00:00, 36.76it/s]
size restored (330, 522, 522)
/home/cii/software/IsoApp/tomograms_wbp/ODD/TS_43_ODD_wbp-b2.mrc
data_shape torch.Size([320, 1, 96, 96, 96])
predict:   0%|                                         | 0/160 [00:00<?, ?it/s]predict:   1%|▏                                | 1/160 [00:00<00:25,  6.33it/s]predict:   3%|█                                | 5/160 [00:00<00:07, 21.95it/s]predict:   6%|█▊                               | 9/160 [00:00<00:05, 28.55it/s]predict:   8%|██▌                             | 13/160 [00:00<00:04, 32.31it/s]predict:  11%|███▍                            | 17/160 [00:00<00:04, 34.43it/s]predict:  13%|████▏                           | 21/160 [00:00<00:03, 35.71it/s]predict:  16%|█████                           | 25/160 [00:00<00:03, 35.70it/s]predict:  18%|█████▊                          | 29/160 [00:00<00:03, 36.20it/s]predict:  21%|██████▌                         | 33/160 [00:01<00:03, 36.32it/s]predict:  23%|███████▍                        | 37/160 [00:01<00:03, 36.36it/s]predict:  26%|████████▏                       | 41/160 [00:01<00:03, 36.62it/s]predict:  28%|█████████                       | 45/160 [00:01<00:03, 36.29it/s]predict:  31%|█████████▊                      | 49/160 [00:01<00:03, 36.72it/s]predict:  33%|██████████▌                     | 53/160 [00:01<00:02, 37.30it/s]predict:  36%|███████████▍                    | 57/160 [00:01<00:02, 37.35it/s]predict:  38%|████████████▏                   | 61/160 [00:01<00:02, 37.31it/s]predict:  41%|█████████████                   | 65/160 [00:01<00:02, 37.33it/s]predict:  43%|█████████████▊                  | 69/160 [00:01<00:02, 37.35it/s]predict:  46%|██████████████▌                 | 73/160 [00:02<00:02, 37.33it/s]predict:  48%|███████████████▍                | 77/160 [00:02<00:02, 37.25it/s]predict:  51%|████████████████▏               | 81/160 [00:02<00:02, 37.29it/s]predict:  53%|█████████████████               | 85/160 [00:02<00:02, 37.07it/s]predict:  56%|█████████████████▊              | 89/160 [00:02<00:01, 37.47it/s]predict:  58%|██████████████████▌             | 93/160 [00:02<00:01, 37.58it/s]predict:  61%|███████████████████▍            | 97/160 [00:02<00:01, 37.79it/s]predict:  63%|███████████████████▌           | 101/160 [00:02<00:01, 38.14it/s]predict:  66%|████████████████████▎          | 105/160 [00:02<00:01, 37.61it/s]predict:  68%|█████████████████████          | 109/160 [00:03<00:01, 37.07it/s]predict:  71%|█████████████████████▉         | 113/160 [00:03<00:01, 37.20it/s]predict:  73%|██████████████████████▋        | 117/160 [00:03<00:01, 37.28it/s]predict:  76%|███████████████████████▍       | 121/160 [00:03<00:01, 37.39it/s]predict:  78%|████████████████████████▏      | 125/160 [00:03<00:00, 37.63it/s]predict:  81%|████████████████████████▉      | 129/160 [00:03<00:00, 37.06it/s]predict:  83%|█████████████████████████▊     | 133/160 [00:03<00:00, 37.40it/s]predict:  86%|██████████████████████████▌    | 137/160 [00:03<00:00, 37.65it/s]predict:  88%|███████████████████████████▎   | 141/160 [00:03<00:00, 37.62it/s]predict:  91%|████████████████████████████   | 145/160 [00:03<00:00, 37.92it/s]predict:  93%|████████████████████████████▊  | 149/160 [00:04<00:00, 37.88it/s]predict:  96%|█████████████████████████████▋ | 153/160 [00:04<00:00, 38.05it/s]predict:  98%|██████████████████████████████▍| 157/160 [00:04<00:00, 37.93it/s]predict: 100%|███████████████████████████████| 160/160 [00:04<00:00, 36.39it/s]
07-18 23:06:20, INFO     Predicted ['/home/cii/software/IsoApp/tomograms_wbp/EVN/TS_43_EVN_wbp-b2.mrc', '/home/cii/software/IsoApp/tomograms_wbp/ODD/TS_43_ODD_wbp-b2.mrc'] → denoise/corrected_n2n_unet-medium_TS_43_EVN_wbp-b2.mrc
Predict:  60%|██████    | 3/5 [01:40<01:07, 33.66s/it]size restored (330, 522, 522)
/home/cii/software/IsoApp/tomograms_wbp/EVN/TS_45_EVN_wbp-b2.mrc
data_shape torch.Size([320, 1, 96, 96, 96])
predict:   0%|                                         | 0/160 [00:00<?, ?it/s]predict:   1%|▏                                | 1/160 [00:00<00:25,  6.17it/s]predict:   3%|█                                | 5/160 [00:00<00:07, 21.61it/s]predict:   6%|█▊                               | 9/160 [00:00<00:05, 28.30it/s]predict:   8%|██▌                             | 13/160 [00:00<00:04, 31.79it/s]predict:  11%|███▍                            | 17/160 [00:00<00:04, 33.70it/s]predict:  13%|████▏                           | 21/160 [00:00<00:03, 34.85it/s]predict:  16%|█████                           | 25/160 [00:00<00:03, 35.78it/s]predict:  18%|█████▊                          | 29/160 [00:00<00:03, 36.21it/s]predict:  21%|██████▌                         | 33/160 [00:01<00:03, 36.09it/s]predict:  23%|███████▍                        | 37/160 [00:01<00:03, 36.19it/s]predict:  26%|████████▏                       | 41/160 [00:01<00:03, 36.48it/s]predict:  28%|█████████                       | 45/160 [00:01<00:03, 37.04it/s]predict:  31%|█████████▊                      | 49/160 [00:01<00:02, 37.12it/s]predict:  33%|██████████▌                     | 53/160 [00:01<00:02, 37.10it/s]predict:  36%|███████████▍                    | 57/160 [00:01<00:02, 36.96it/s]predict:  38%|████████████▏                   | 61/160 [00:01<00:02, 37.35it/s]predict:  41%|█████████████                   | 65/160 [00:01<00:02, 37.21it/s]predict:  43%|█████████████▊                  | 69/160 [00:01<00:02, 37.08it/s]predict:  46%|██████████████▌                 | 73/160 [00:02<00:02, 36.98it/s]predict:  48%|███████████████▍                | 77/160 [00:02<00:02, 36.96it/s]predict:  51%|████████████████▏               | 81/160 [00:02<00:02, 37.21it/s]predict:  53%|█████████████████               | 85/160 [00:02<00:02, 37.44it/s]predict:  56%|█████████████████▊              | 89/160 [00:02<00:01, 37.61it/s]predict:  58%|██████████████████▌             | 93/160 [00:02<00:01, 37.86it/s]predict:  61%|███████████████████▍            | 97/160 [00:02<00:01, 38.01it/s]predict:  63%|███████████████████▌           | 101/160 [00:02<00:01, 37.78it/s]predict:  66%|████████████████████▎          | 105/160 [00:02<00:01, 37.67it/s]predict:  68%|█████████████████████          | 109/160 [00:03<00:01, 37.21it/s]predict:  71%|█████████████████████▉         | 113/160 [00:03<00:01, 37.14it/s]predict:  73%|██████████████████████▋        | 117/160 [00:03<00:01, 36.95it/s]predict:  76%|███████████████████████▍       | 121/160 [00:03<00:01, 37.15it/s]predict:  78%|████████████████████████▏      | 125/160 [00:03<00:00, 36.86it/s]predict:  81%|████████████████████████▉      | 129/160 [00:03<00:00, 37.12it/s]predict:  83%|█████████████████████████▊     | 133/160 [00:03<00:00, 37.12it/s]predict:  86%|██████████████████████████▌    | 137/160 [00:03<00:00, 37.40it/s]predict:  88%|███████████████████████████▎   | 141/160 [00:03<00:00, 37.33it/s]predict:  91%|████████████████████████████   | 145/160 [00:04<00:00, 37.48it/s]predict:  93%|████████████████████████████▊  | 149/160 [00:04<00:00, 37.27it/s]predict:  96%|█████████████████████████████▋ | 153/160 [00:04<00:00, 37.06it/s]predict:  98%|██████████████████████████████▍| 157/160 [00:04<00:00, 37.29it/s]predict: 100%|███████████████████████████████| 160/160 [00:04<00:00, 36.19it/s]
size restored (330, 522, 522)
/home/cii/software/IsoApp/tomograms_wbp/ODD/TS_45_ODD_wbp-b2.mrc
data_shape torch.Size([320, 1, 96, 96, 96])
predict:   0%|                                         | 0/160 [00:00<?, ?it/s]predict:   1%|▏                                | 1/160 [00:00<00:25,  6.25it/s]predict:   3%|█                                | 5/160 [00:00<00:07, 21.79it/s]predict:   6%|█▊                               | 9/160 [00:00<00:05, 28.60it/s]predict:   8%|██▌                             | 13/160 [00:00<00:04, 31.95it/s]predict:  11%|███▍                            | 17/160 [00:00<00:04, 33.77it/s]predict:  13%|████▏                           | 21/160 [00:00<00:03, 34.91it/s]predict:  16%|█████                           | 25/160 [00:00<00:03, 36.02it/s]predict:  18%|█████▊                          | 29/160 [00:00<00:03, 36.49it/s]predict:  21%|██████▌                         | 33/160 [00:01<00:03, 37.02it/s]predict:  23%|███████▍                        | 37/160 [00:01<00:03, 37.23it/s]predict:  26%|████████▏                       | 41/160 [00:01<00:03, 37.36it/s]predict:  28%|█████████                       | 45/160 [00:01<00:03, 37.28it/s]predict:  31%|█████████▊                      | 49/160 [00:01<00:02, 37.50it/s]predict:  33%|██████████▌                     | 53/160 [00:01<00:02, 37.71it/s]predict:  36%|███████████▍                    | 57/160 [00:01<00:02, 37.54it/s]predict:  38%|████████████▏                   | 61/160 [00:01<00:02, 37.50it/s]predict:  41%|█████████████                   | 65/160 [00:01<00:02, 37.68it/s]predict:  43%|█████████████▊                  | 69/160 [00:01<00:02, 37.70it/s]predict:  46%|██████████████▌                 | 73/160 [00:02<00:02, 37.60it/s]predict:  48%|███████████████▍                | 77/160 [00:02<00:02, 37.46it/s]predict:  51%|████████████████▏               | 81/160 [00:02<00:02, 37.72it/s]predict:  53%|█████████████████               | 85/160 [00:02<00:01, 37.82it/s]predict:  56%|█████████████████▊              | 89/160 [00:02<00:01, 37.80it/s]predict:  58%|██████████████████▌             | 93/160 [00:02<00:01, 37.65it/s]predict:  61%|███████████████████▍            | 97/160 [00:02<00:01, 37.26it/s]predict:  63%|███████████████████▌           | 101/160 [00:02<00:01, 37.25it/s]predict:  66%|████████████████████▎          | 105/160 [00:02<00:01, 37.63it/s]predict:  68%|█████████████████████          | 109/160 [00:03<00:01, 37.83it/s]predict:  71%|█████████████████████▉         | 113/160 [00:03<00:01, 37.85it/s]predict:  73%|██████████████████████▋        | 117/160 [00:03<00:01, 37.68it/s]predict:  76%|███████████████████████▍       | 121/160 [00:03<00:01, 37.47it/s]predict:  78%|████████████████████████▏      | 125/160 [00:03<00:00, 37.52it/s]predict:  81%|████████████████████████▉      | 129/160 [00:03<00:00, 37.56it/s]predict:  83%|█████████████████████████▊     | 133/160 [00:03<00:00, 36.92it/s]predict:  86%|██████████████████████████▌    | 137/160 [00:03<00:00, 36.94it/s]predict:  88%|███████████████████████████▎   | 141/160 [00:03<00:00, 37.04it/s]predict:  91%|████████████████████████████   | 145/160 [00:03<00:00, 37.24it/s]predict:  93%|████████████████████████████▊  | 149/160 [00:04<00:00, 37.57it/s]predict:  96%|█████████████████████████████▋ | 153/160 [00:04<00:00, 37.43it/s]predict:  98%|██████████████████████████████▍| 157/160 [00:04<00:00, 37.35it/s]predict: 100%|███████████████████████████████| 160/160 [00:04<00:00, 36.43it/s]
07-18 23:06:56, INFO     Predicted ['/home/cii/software/IsoApp/tomograms_wbp/EVN/TS_45_EVN_wbp-b2.mrc', '/home/cii/software/IsoApp/tomograms_wbp/ODD/TS_45_ODD_wbp-b2.mrc'] → denoise/corrected_n2n_unet-medium_TS_45_EVN_wbp-b2.mrc
Predict:  80%|████████  | 4/5 [02:16<00:34, 34.58s/it]size restored (330, 522, 522)
/home/cii/software/IsoApp/tomograms_wbp/EVN/TS_54_EVN_wbp-b2.mrc
data_shape torch.Size([320, 1, 96, 96, 96])
predict:   0%|                                         | 0/160 [00:00<?, ?it/s]predict:   1%|▏                                | 1/160 [00:00<00:26,  6.02it/s]predict:   3%|█                                | 5/160 [00:00<00:07, 21.20it/s]predict:   6%|█▊                               | 9/160 [00:00<00:05, 27.96it/s]predict:   8%|██▌                             | 13/160 [00:00<00:04, 31.61it/s]predict:  11%|███▍                            | 17/160 [00:00<00:04, 33.40it/s]predict:  13%|████▏                           | 21/160 [00:00<00:04, 34.68it/s]predict:  16%|█████                           | 25/160 [00:00<00:03, 35.66it/s]predict:  18%|█████▊                          | 29/160 [00:00<00:03, 36.46it/s]predict:  21%|██████▌                         | 33/160 [00:01<00:03, 37.03it/s]predict:  23%|███████▍                        | 37/160 [00:01<00:03, 37.31it/s]predict:  26%|████████▏                       | 41/160 [00:01<00:03, 37.40it/s]predict:  28%|█████████                       | 45/160 [00:01<00:03, 37.34it/s]predict:  31%|█████████▊                      | 49/160 [00:01<00:02, 37.25it/s]predict:  33%|██████████▌                     | 53/160 [00:01<00:02, 37.24it/s]predict:  36%|███████████▍                    | 57/160 [00:01<00:02, 37.45it/s]predict:  38%|████████████▏                   | 61/160 [00:01<00:02, 37.44it/s]predict:  41%|█████████████                   | 65/160 [00:01<00:02, 37.43it/s]predict:  43%|█████████████▊                  | 69/160 [00:01<00:02, 37.33it/s]predict:  46%|██████████████▌                 | 73/160 [00:02<00:02, 37.56it/s]predict:  48%|███████████████▍                | 77/160 [00:02<00:02, 37.38it/s]predict:  51%|████████████████▏               | 81/160 [00:02<00:02, 37.18it/s]predict:  53%|█████████████████               | 85/160 [00:02<00:02, 37.18it/s]predict:  56%|█████████████████▊              | 89/160 [00:02<00:01, 37.29it/s]predict:  58%|██████████████████▌             | 93/160 [00:02<00:01, 37.49it/s]predict:  61%|███████████████████▍            | 97/160 [00:02<00:01, 37.84it/s]predict:  63%|███████████████████▌           | 101/160 [00:02<00:01, 37.94it/s]predict:  66%|████████████████████▎          | 105/160 [00:02<00:01, 37.76it/s]predict:  68%|█████████████████████          | 109/160 [00:03<00:01, 37.72it/s]predict:  71%|█████████████████████▉         | 113/160 [00:03<00:01, 37.81it/s]predict:  73%|██████████████████████▋        | 117/160 [00:03<00:01, 37.58it/s]predict:  76%|███████████████████████▍       | 121/160 [00:03<00:01, 37.77it/s]predict:  78%|████████████████████████▏      | 125/160 [00:03<00:00, 37.94it/s]predict:  81%|████████████████████████▉      | 129/160 [00:03<00:00, 38.02it/s]predict:  83%|█████████████████████████▊     | 133/160 [00:03<00:00, 38.03it/s]predict:  86%|██████████████████████████▌    | 137/160 [00:03<00:00, 37.39it/s]predict:  88%|███████████████████████████▎   | 141/160 [00:03<00:00, 37.20it/s]predict:  91%|████████████████████████████   | 145/160 [00:03<00:00, 37.22it/s]predict:  93%|████████████████████████████▊  | 149/160 [00:04<00:00, 37.19it/s]predict:  96%|█████████████████████████████▋ | 153/160 [00:04<00:00, 37.50it/s]predict:  98%|██████████████████████████████▍| 157/160 [00:04<00:00, 37.45it/s]predict: 100%|███████████████████████████████| 160/160 [00:04<00:00, 36.40it/s]
size restored (330, 522, 522)
/home/cii/software/IsoApp/tomograms_wbp/ODD/TS_54_ODD_wbp-b2.mrc
data_shape torch.Size([320, 1, 96, 96, 96])
predict:   0%|                                         | 0/160 [00:00<?, ?it/s]predict:   1%|▏                                | 1/160 [00:00<00:25,  6.29it/s]predict:   3%|█                                | 5/160 [00:00<00:07, 21.68it/s]predict:   6%|█▊                               | 9/160 [00:00<00:05, 28.31it/s]predict:   8%|██▌                             | 13/160 [00:00<00:04, 32.06it/s]predict:  11%|███▍                            | 17/160 [00:00<00:04, 34.20it/s]predict:  13%|████▏                           | 21/160 [00:00<00:03, 35.45it/s]predict:  16%|█████                           | 25/160 [00:00<00:03, 35.94it/s]predict:  18%|█████▊                          | 29/160 [00:00<00:03, 36.39it/s]predict:  21%|██████▌                         | 33/160 [00:01<00:03, 36.67it/s]predict:  23%|███████▍                        | 37/160 [00:01<00:03, 37.14it/s]predict:  26%|████████▏                       | 41/160 [00:01<00:03, 37.48it/s]predict:  28%|█████████                       | 45/160 [00:01<00:03, 37.69it/s]predict:  31%|█████████▊                      | 49/160 [00:01<00:02, 37.59it/s]predict:  33%|██████████▌                     | 53/160 [00:01<00:02, 37.46it/s]predict:  36%|███████████▍                    | 57/160 [00:01<00:02, 37.68it/s]predict:  38%|████████████▏                   | 61/160 [00:01<00:02, 37.60it/s]predict:  41%|█████████████                   | 65/160 [00:01<00:02, 37.46it/s]predict:  43%|█████████████▊                  | 69/160 [00:01<00:02, 37.65it/s]predict:  46%|██████████████▌                 | 73/160 [00:02<00:02, 37.76it/s]predict:  48%|███████████████▍                | 77/160 [00:02<00:02, 37.73it/s]predict:  51%|████████████████▏               | 81/160 [00:02<00:02, 37.52it/s]predict:  53%|█████████████████               | 85/160 [00:02<00:01, 37.60it/s]predict:  56%|█████████████████▊              | 89/160 [00:02<00:01, 37.78it/s]predict:  58%|██████████████████▌             | 93/160 [00:02<00:01, 38.07it/s]predict:  61%|███████████████████▍            | 97/160 [00:02<00:01, 38.23it/s]predict:  63%|███████████████████▌           | 101/160 [00:02<00:01, 38.09it/s]predict:  66%|████████████████████▎          | 105/160 [00:02<00:01, 38.05it/s]predict:  68%|█████████████████████          | 109/160 [00:03<00:01, 38.31it/s]predict:  71%|█████████████████████▉         | 113/160 [00:03<00:01, 38.47it/s]predict:  73%|██████████████████████▋        | 117/160 [00:03<00:01, 37.92it/s]predict:  76%|███████████████████████▍       | 121/160 [00:03<00:01, 37.86it/s]predict:  78%|████████████████████████▏      | 125/160 [00:03<00:00, 37.82it/s]predict:  81%|████████████████████████▉      | 129/160 [00:03<00:00, 37.86it/s]predict:  83%|█████████████████████████▊     | 133/160 [00:03<00:00, 37.71it/s]predict:  86%|██████████████████████████▌    | 137/160 [00:03<00:00, 37.89it/s]predict:  88%|███████████████████████████▎   | 141/160 [00:03<00:00, 37.65it/s]predict:  91%|████████████████████████████   | 145/160 [00:03<00:00, 37.70it/s]predict:  93%|████████████████████████████▊  | 149/160 [00:04<00:00, 37.70it/s]predict:  96%|█████████████████████████████▋ | 153/160 [00:04<00:00, 37.68it/s]predict:  98%|██████████████████████████████▍| 157/160 [00:04<00:00, 37.75it/s]predict: 100%|███████████████████████████████| 160/160 [00:04<00:00, 36.69it/s]
07-18 23:07:32, INFO     Predicted ['/home/cii/software/IsoApp/tomograms_wbp/EVN/TS_54_EVN_wbp-b2.mrc', '/home/cii/software/IsoApp/tomograms_wbp/ODD/TS_54_ODD_wbp-b2.mrc'] → denoise/corrected_n2n_unet-medium_TS_54_EVN_wbp-b2.mrc
Predict: 100%|██████████| 5/5 [02:52<00:00, 34.87s/it]Predict: 100%|██████████| 5/5 [02:52<00:00, 34.41s/it]
size restored (330, 522, 522)
Process exited with code 0
Command: isonet.py denoise --star_file tomograms.star --output_dir denoise --gpuID 0,1 --ncpus 16 --arch unet-medium --pretrained_model None --pretrained_model2 None --cube_size 96 --epochs 6 --input_column rlnTomoReconstructedTomogramHalf --batch_size None --acc_batches 1 --loss_func L2 --learning_rate 0.0003 --T_max 2 --learning_rate_min 0.0003 --compile_model False --mixed_precision True --CTF_mode None --isCTFflipped False --with_predict True --split_halves False --snrfalloff 0 --deconvstrength 1 --highpassnyquist 0.02
07-19 12:28:59, INFO     The denoise folder already exists, outputs will write into this folder
07-19 12:29:00, INFO     Port number: 33229
Total number of parameters: 23989825
Preprocess tomograms:   0%|                                                   | 0/5 [00:00<?, ?it/s]Preprocess tomograms:  20%|████████▌                                  | 1/5 [00:00<00:01,  2.50it/s]Preprocess tomograms:  40%|█████████████████▏                         | 2/5 [00:00<00:01,  2.51it/s]Preprocess tomograms:  60%|█████████████████████████▊                 | 3/5 [00:01<00:00,  2.58it/s]Preprocess tomograms:  80%|██████████████████████████████████▍        | 4/5 [00:01<00:00,  2.59it/s]Preprocess tomograms: 100%|███████████████████████████████████████████| 5/5 [00:01<00:00,  2.56it/s]Preprocess tomograms: 100%|███████████████████████████████████████████| 5/5 [00:01<00:00,  2.56it/s]
training tomograms for 2 epochs, remaining epochs 6
Epoch 1:   0%|                                       | 0/13 [00:00<?, ?batch/s]Epoch 1:   0%| | 0/13 [00:20<?, ?batch/s, Loss: 1.9452 | in_mw_loss: 1.9452 | oEpoch 1:   8%| | 1/13 [00:20<04:01, 20.15s/batch, Loss: 1.9452 | in_mw_loss: 1.Epoch 1:   8%| | 1/13 [00:20<04:01, 20.15s/batch, Loss: 1.5873 | in_mw_loss: 1.Epoch 1:  15%|▏| 2/13 [00:20<01:32,  8.37s/batch, Loss: 1.5873 | in_mw_loss: 1.Epoch 1:  15%|▏| 2/13 [00:20<01:32,  8.37s/batch, Loss: 1.3863 | in_mw_loss: 1.Epoch 1:  23%|▏| 3/13 [00:20<00:46,  4.61s/batch, Loss: 1.3863 | in_mw_loss: 1.Epoch 1:  23%|▏| 3/13 [00:20<00:46,  4.61s/batch, Loss: 1.2553 | in_mw_loss: 1.Epoch 1:  31%|▎| 4/13 [00:20<00:25,  2.84s/batch, Loss: 1.2553 | in_mw_loss: 1.Epoch 1:  31%|▎| 4/13 [00:20<00:25,  2.84s/batch, Loss: 1.1588 | in_mw_loss: 1.Epoch 1:  38%|▍| 5/13 [00:20<00:14,  1.86s/batch, Loss: 1.1588 | in_mw_loss: 1.Epoch 1:  38%|▍| 5/13 [00:20<00:14,  1.86s/batch, Loss: 1.2914 | in_mw_loss: 1.Epoch 1:  46%|▍| 6/13 [00:20<00:08,  1.27s/batch, Loss: 1.2914 | in_mw_loss: 1.Epoch 1:  46%|▍| 6/13 [00:20<00:08,  1.27s/batch, Loss: 1.0798 | in_mw_loss: 1.Epoch 1:  54%|▌| 7/13 [00:20<00:05,  1.11batch/s, Loss: 1.0798 | in_mw_loss: 1.Epoch 1:  54%|▌| 7/13 [00:21<00:05,  1.11batch/s, Loss: 1.1277 | in_mw_loss: 1.Epoch 1:  62%|▌| 8/13 [00:21<00:03,  1.52batch/s, Loss: 1.1277 | in_mw_loss: 1.Epoch 1:  62%|▌| 8/13 [00:21<00:03,  1.52batch/s, Loss: 1.1211 | in_mw_loss: 1.Epoch 1:  69%|▋| 9/13 [00:21<00:01,  2.04batch/s, Loss: 1.1211 | in_mw_loss: 1.Epoch 1:  69%|▋| 9/13 [00:21<00:01,  2.04batch/s, Loss: 1.1690 | in_mw_loss: 1.Epoch 1:  77%|▊| 10/13 [00:21<00:01,  2.64batch/s, Loss: 1.1690 | in_mw_loss: 1Epoch 1:  77%|▊| 10/13 [00:21<00:01,  2.64batch/s, Loss: 1.2018 | in_mw_loss: 1Epoch 1:  85%|▊| 11/13 [00:21<00:00,  3.31batch/s, Loss: 1.2018 | in_mw_loss: 1Epoch 1:  85%|▊| 11/13 [00:21<00:00,  3.31batch/s, Loss: 1.0770 | in_mw_loss: 1Epoch 1:  92%|▉| 12/13 [00:21<00:00,  4.02batch/s, Loss: 1.0770 | in_mw_loss: 1Epoch 1:  92%|▉| 12/13 [00:21<00:00,  4.02batch/s, Loss: 1.0880 | in_mw_loss: 1Epoch 1: 100%|█| 13/13 [00:21<00:00,  4.81batch/s, Loss: 1.0880 | in_mw_loss: 1Epoch 1: 100%|█| 13/13 [00:21<00:00,  1.67s/batch, Loss: 1.0880 | in_mw_loss: 1
Epoch [  1/  2], Loss: 1.2867, in_mw_loss: 1.2867, out_mw_loss: 1.2867, learning_rate: 3.0000e-04
Epoch 2:   0%|                                       | 0/13 [00:00<?, ?batch/s]Epoch 2:   0%| | 0/13 [00:00<?, ?batch/s, Loss: 1.1465 | in_mw_loss: 1.1465 | oEpoch 2:   8%| | 1/13 [00:00<00:02,  4.27batch/s, Loss: 1.1465 | in_mw_loss: 1.Epoch 2:   8%| | 1/13 [00:00<00:02,  4.27batch/s, Loss: 1.0645 | in_mw_loss: 1.Epoch 2:  15%|▏| 2/13 [00:00<00:01,  5.81batch/s, Loss: 1.0645 | in_mw_loss: 1.Epoch 2:  15%|▏| 2/13 [00:00<00:01,  5.81batch/s, Loss: 1.1245 | in_mw_loss: 1.Epoch 2:  23%|▏| 3/13 [00:00<00:01,  6.56batch/s, Loss: 1.1245 | in_mw_loss: 1.Epoch 2:  23%|▏| 3/13 [00:00<00:01,  6.56batch/s, Loss: 1.1411 | in_mw_loss: 1.Epoch 2:  31%|▎| 4/13 [00:00<00:01,  6.96batch/s, Loss: 1.1411 | in_mw_loss: 1.Epoch 2:  31%|▎| 4/13 [00:00<00:01,  6.96batch/s, Loss: 1.0710 | in_mw_loss: 1.Epoch 2:  38%|▍| 5/13 [00:00<00:01,  7.23batch/s, Loss: 1.0710 | in_mw_loss: 1.Epoch 2:  38%|▍| 5/13 [00:00<00:01,  7.23batch/s, Loss: 1.1375 | in_mw_loss: 1.Epoch 2:  46%|▍| 6/13 [00:00<00:00,  7.45batch/s, Loss: 1.1375 | in_mw_loss: 1.Epoch 2:  46%|▍| 6/13 [00:01<00:00,  7.45batch/s, Loss: 1.1249 | in_mw_loss: 1.Epoch 2:  54%|▌| 7/13 [00:01<00:00,  7.57batch/s, Loss: 1.1249 | in_mw_loss: 1.Epoch 2:  54%|▌| 7/13 [00:01<00:00,  7.57batch/s, Loss: 1.0276 | in_mw_loss: 1.Epoch 2:  62%|▌| 8/13 [00:01<00:00,  7.62batch/s, Loss: 1.0276 | in_mw_loss: 1.Epoch 2:  62%|▌| 8/13 [00:01<00:00,  7.62batch/s, Loss: 1.0633 | in_mw_loss: 1.Epoch 2:  69%|▋| 9/13 [00:01<00:00,  7.66batch/s, Loss: 1.0633 | in_mw_loss: 1.Epoch 2:  69%|▋| 9/13 [00:01<00:00,  7.66batch/s, Loss: 1.0119 | in_mw_loss: 1.Epoch 2:  77%|▊| 10/13 [00:01<00:00,  7.70batch/s, Loss: 1.0119 | in_mw_loss: 1Epoch 2:  77%|▊| 10/13 [00:01<00:00,  7.70batch/s, Loss: 1.0118 | in_mw_loss: 1Epoch 2:  85%|▊| 11/13 [00:01<00:00,  7.71batch/s, Loss: 1.0118 | in_mw_loss: 1Epoch 2:  85%|▊| 11/13 [00:01<00:00,  7.71batch/s, Loss: 1.0564 | in_mw_loss: 1Epoch 2:  92%|▉| 12/13 [00:01<00:00,  7.70batch/s, Loss: 1.0564 | in_mw_loss: 1Epoch 2:  92%|▉| 12/13 [00:01<00:00,  7.70batch/s, Loss: 1.0000 | in_mw_loss: 1Epoch 2: 100%|█| 13/13 [00:01<00:00,  7.48batch/s, Loss: 1.0000 | in_mw_loss: 1
Epoch [  2/  2], Loss: 1.0684, in_mw_loss: 1.0684, out_mw_loss: 1.0684, learning_rate: 3.0000e-04
data_shape torch.Size([320, 1, 96, 96, 96])
predict:   0%|                                         | 0/160 [00:00<?, ?it/s]predict:   1%|▏                                | 1/160 [00:00<00:25,  6.18it/s]predict:   3%|█                                | 5/160 [00:00<00:07, 21.74it/s]predict:   6%|█▊                               | 9/160 [00:00<00:05, 28.74it/s]predict:   8%|██▌                             | 13/160 [00:00<00:04, 32.44it/s]predict:  11%|███▍                            | 17/160 [00:00<00:04, 34.43it/s]predict:  13%|████▏                           | 21/160 [00:00<00:03, 35.65it/s]predict:  16%|█████                           | 25/160 [00:00<00:03, 36.37it/s]predict:  18%|█████▊                          | 29/160 [00:00<00:03, 37.00it/s]predict:  21%|██████▌                         | 33/160 [00:00<00:03, 37.33it/s]predict:  23%|███████▍                        | 37/160 [00:01<00:03, 37.66it/s]predict:  26%|████████▏                       | 41/160 [00:01<00:03, 37.99it/s]predict:  28%|█████████                       | 45/160 [00:01<00:03, 38.20it/s]predict:  31%|█████████▊                      | 49/160 [00:01<00:02, 37.82it/s]predict:  33%|██████████▌                     | 53/160 [00:01<00:02, 37.80it/s]predict:  36%|███████████▍                    | 57/160 [00:01<00:02, 37.75it/s]predict:  38%|████████████▏                   | 61/160 [00:01<00:02, 37.66it/s]predict:  41%|█████████████                   | 65/160 [00:01<00:02, 37.37it/s]predict:  43%|█████████████▊                  | 69/160 [00:01<00:02, 37.39it/s]predict:  46%|██████████████▌                 | 73/160 [00:02<00:02, 37.60it/s]predict:  48%|███████████████▍                | 77/160 [00:02<00:02, 37.79it/s]predict:  51%|████████████████▏               | 81/160 [00:02<00:02, 37.59it/s]predict:  53%|█████████████████               | 85/160 [00:02<00:01, 37.58it/s]predict:  56%|█████████████████▊              | 89/160 [00:02<00:01, 37.83it/s]predict:  58%|██████████████████▌             | 93/160 [00:02<00:01, 38.05it/s]predict:  61%|███████████████████▍            | 97/160 [00:02<00:01, 37.92it/s]predict:  63%|███████████████████▌           | 101/160 [00:02<00:01, 37.74it/s]predict:  66%|████████████████████▎          | 105/160 [00:02<00:01, 37.78it/s]predict:  68%|█████████████████████          | 109/160 [00:03<00:01, 37.64it/s]predict:  71%|█████████████████████▉         | 113/160 [00:03<00:01, 37.47it/s]predict:  73%|██████████████████████▋        | 117/160 [00:03<00:01, 37.47it/s]predict:  76%|███████████████████████▍       | 121/160 [00:03<00:01, 37.41it/s]predict:  78%|████████████████████████▏      | 125/160 [00:03<00:00, 37.67it/s]predict:  81%|████████████████████████▉      | 129/160 [00:03<00:00, 37.98it/s]predict:  83%|█████████████████████████▊     | 133/160 [00:03<00:00, 38.14it/s]predict:  86%|██████████████████████████▌    | 137/160 [00:03<00:00, 38.32it/s]predict:  88%|███████████████████████████▎   | 141/160 [00:03<00:00, 38.40it/s]predict:  91%|████████████████████████████   | 145/160 [00:03<00:00, 38.55it/s]predict:  93%|████████████████████████████▊  | 149/160 [00:04<00:00, 38.44it/s]predict:  96%|█████████████████████████████▋ | 153/160 [00:04<00:00, 38.45it/s]predict:  98%|██████████████████████████████▍| 157/160 [00:04<00:00, 38.14it/s]predict: 100%|███████████████████████████████| 160/160 [00:04<00:00, 36.84it/s]
size restored (330, 522, 522)
Saved slices and power spectrum for epoch 2 to 'denoise'
training tomograms for 2 epochs, remaining epochs 4
Epoch 1:   0%|                                       | 0/13 [00:00<?, ?batch/s]Epoch 1:   0%| | 0/13 [00:19<?, ?batch/s, Loss: 1.9452 | in_mw_loss: 1.9452 | oEpoch 1:   8%| | 1/13 [00:19<03:56, 19.74s/batch, Loss: 1.9452 | in_mw_loss: 1.Epoch 1:   8%| | 1/13 [00:19<03:56, 19.74s/batch, Loss: 1.5872 | in_mw_loss: 1.Epoch 1:  15%|▏| 2/13 [00:19<01:30,  8.21s/batch, Loss: 1.5872 | in_mw_loss: 1.Epoch 1:  15%|▏| 2/13 [00:20<01:30,  8.21s/batch, Loss: 1.3862 | in_mw_loss: 1.Epoch 1:  23%|▏| 3/13 [00:20<00:45,  4.53s/batch, Loss: 1.3862 | in_mw_loss: 1.Epoch 1:  23%|▏| 3/13 [00:20<00:45,  4.53s/batch, Loss: 1.2556 | in_mw_loss: 1.Epoch 1:  31%|▎| 4/13 [00:20<00:25,  2.79s/batch, Loss: 1.2556 | in_mw_loss: 1.Epoch 1:  31%|▎| 4/13 [00:20<00:25,  2.79s/batch, Loss: 1.1587 | in_mw_loss: 1.Epoch 1:  38%|▍| 5/13 [00:20<00:14,  1.83s/batch, Loss: 1.1587 | in_mw_loss: 1.Epoch 1:  38%|▍| 5/13 [00:20<00:14,  1.83s/batch, Loss: 1.2920 | in_mw_loss: 1.Epoch 1:  46%|▍| 6/13 [00:20<00:08,  1.25s/batch, Loss: 1.2920 | in_mw_loss: 1.Epoch 1:  46%|▍| 6/13 [00:20<00:08,  1.25s/batch, Loss: 1.0803 | in_mw_loss: 1.Epoch 1:  54%|▌| 7/13 [00:20<00:05,  1.13batch/s, Loss: 1.0803 | in_mw_loss: 1.Epoch 1:  54%|▌| 7/13 [00:20<00:05,  1.13batch/s, Loss: 1.1295 | in_mw_loss: 1.Epoch 1:  62%|▌| 8/13 [00:20<00:03,  1.55batch/s, Loss: 1.1295 | in_mw_loss: 1.Epoch 1:  62%|▌| 8/13 [00:20<00:03,  1.55batch/s, Loss: 1.1214 | in_mw_loss: 1.Epoch 1:  69%|▋| 9/13 [00:20<00:01,  2.07batch/s, Loss: 1.1214 | in_mw_loss: 1.Epoch 1:  69%|▋| 9/13 [00:20<00:01,  2.07batch/s, Loss: 1.1694 | in_mw_loss: 1.Epoch 1:  77%|▊| 10/13 [00:20<00:01,  2.67batch/s, Loss: 1.1694 | in_mw_loss: 1Epoch 1:  77%|▊| 10/13 [00:21<00:01,  2.67batch/s, Loss: 1.2009 | in_mw_loss: 1Epoch 1:  85%|▊| 11/13 [00:21<00:00,  3.33batch/s, Loss: 1.2009 | in_mw_loss: 1Epoch 1:  85%|▊| 11/13 [00:21<00:00,  3.33batch/s, Loss: 1.0774 | in_mw_loss: 1Epoch 1:  92%|▉| 12/13 [00:21<00:00,  4.01batch/s, Loss: 1.0774 | in_mw_loss: 1Epoch 1:  92%|▉| 12/13 [00:21<00:00,  4.01batch/s, Loss: 1.0878 | in_mw_loss: 1Epoch 1: 100%|█| 13/13 [00:21<00:00,  4.57batch/s, Loss: 1.0878 | in_mw_loss: 1Epoch 1: 100%|█| 13/13 [00:21<00:00,  1.64s/batch, Loss: 1.0878 | in_mw_loss: 1
Epoch [  1/  2], Loss: 1.2867, in_mw_loss: 1.2867, out_mw_loss: 1.2867, learning_rate: 3.0000e-04
Epoch 2:   0%|                                       | 0/13 [00:00<?, ?batch/s]Epoch 2:   0%| | 0/13 [00:00<?, ?batch/s, Loss: 1.1460 | in_mw_loss: 1.1460 | oEpoch 2:   8%| | 1/13 [00:00<00:03,  3.41batch/s, Loss: 1.1460 | in_mw_loss: 1.Epoch 2:   8%| | 1/13 [00:00<00:03,  3.41batch/s, Loss: 1.0645 | in_mw_loss: 1.Epoch 2:  15%|▏| 2/13 [00:00<00:02,  5.06batch/s, Loss: 1.0645 | in_mw_loss: 1.Epoch 2:  15%|▏| 2/13 [00:00<00:02,  5.06batch/s, Loss: 1.1231 | in_mw_loss: 1.Epoch 2:  23%|▏| 3/13 [00:00<00:01,  5.98batch/s, Loss: 1.1231 | in_mw_loss: 1.Epoch 2:  23%|▏| 3/13 [00:00<00:01,  5.98batch/s, Loss: 1.1420 | in_mw_loss: 1.Epoch 2:  31%|▎| 4/13 [00:00<00:01,  6.43batch/s, Loss: 1.1420 | in_mw_loss: 1.Epoch 2:  31%|▎| 4/13 [00:00<00:01,  6.43batch/s, Loss: 1.0712 | in_mw_loss: 1.Epoch 2:  38%|▍| 5/13 [00:00<00:01,  6.84batch/s, Loss: 1.0712 | in_mw_loss: 1.Epoch 2:  38%|▍| 5/13 [00:00<00:01,  6.84batch/s, Loss: 1.1360 | in_mw_loss: 1.Epoch 2:  46%|▍| 6/13 [00:00<00:00,  7.10batch/s, Loss: 1.1360 | in_mw_loss: 1.Epoch 2:  46%|▍| 6/13 [00:01<00:00,  7.10batch/s, Loss: 1.1238 | in_mw_loss: 1.Epoch 2:  54%|▌| 7/13 [00:01<00:00,  7.27batch/s, Loss: 1.1238 | in_mw_loss: 1.Epoch 2:  54%|▌| 7/13 [00:01<00:00,  7.27batch/s, Loss: 1.0274 | in_mw_loss: 1.Epoch 2:  62%|▌| 8/13 [00:01<00:00,  7.39batch/s, Loss: 1.0274 | in_mw_loss: 1.Epoch 2:  62%|▌| 8/13 [00:01<00:00,  7.39batch/s, Loss: 1.0652 | in_mw_loss: 1.Epoch 2:  69%|▋| 9/13 [00:01<00:00,  7.45batch/s, Loss: 1.0652 | in_mw_loss: 1.Epoch 2:  69%|▋| 9/13 [00:01<00:00,  7.45batch/s, Loss: 1.0106 | in_mw_loss: 1.Epoch 2:  77%|▊| 10/13 [00:01<00:00,  7.51batch/s, Loss: 1.0106 | in_mw_loss: 1Epoch 2:  77%|▊| 10/13 [00:01<00:00,  7.51batch/s, Loss: 1.0101 | in_mw_loss: 1Epoch 2:  85%|▊| 11/13 [00:01<00:00,  7.59batch/s, Loss: 1.0101 | in_mw_loss: 1Epoch 2:  85%|▊| 11/13 [00:01<00:00,  7.59batch/s, Loss: 1.0542 | in_mw_loss: 1Epoch 2:  92%|▉| 12/13 [00:01<00:00,  7.64batch/s, Loss: 1.0542 | in_mw_loss: 1Epoch 2:  92%|▉| 12/13 [00:01<00:00,  7.64batch/s, Loss: 1.0000 | in_mw_loss: 1Epoch 2: 100%|█| 13/13 [00:01<00:00,  7.15batch/s, Loss: 1.0000 | in_mw_loss: 1
Epoch [  2/  2], Loss: 1.0682, in_mw_loss: 1.0682, out_mw_loss: 1.0682, learning_rate: 3.0000e-04
data_shape torch.Size([320, 1, 96, 96, 96])
predict:   0%|                                         | 0/160 [00:00<?, ?it/s]predict:   1%|▏                                | 1/160 [00:00<00:26,  6.01it/s]predict:   3%|█                                | 5/160 [00:00<00:07, 21.19it/s]predict:   6%|█▊                               | 9/160 [00:00<00:05, 27.82it/s]predict:   8%|██▌                             | 13/160 [00:00<00:04, 31.52it/s]predict:  11%|███▍                            | 17/160 [00:00<00:04, 33.84it/s]predict:  13%|████▏                           | 21/160 [00:00<00:03, 35.28it/s]predict:  16%|█████                           | 25/160 [00:00<00:03, 36.39it/s]predict:  18%|█████▊                          | 29/160 [00:00<00:03, 37.08it/s]predict:  21%|██████▌                         | 33/160 [00:01<00:03, 37.65it/s]predict:  23%|███████▍                        | 37/160 [00:01<00:03, 37.88it/s]predict:  26%|████████▏                       | 41/160 [00:01<00:03, 37.83it/s]predict:  28%|█████████                       | 45/160 [00:01<00:03, 38.11it/s]predict:  31%|█████████▊                      | 49/160 [00:01<00:02, 38.34it/s]predict:  33%|██████████▌                     | 53/160 [00:01<00:02, 38.44it/s]predict:  36%|███████████▍                    | 57/160 [00:01<00:02, 38.28it/s]predict:  38%|████████████▏                   | 61/160 [00:01<00:02, 38.40it/s]predict:  41%|█████████████                   | 65/160 [00:01<00:02, 38.23it/s]predict:  43%|█████████████▊                  | 69/160 [00:01<00:02, 38.20it/s]predict:  46%|██████████████▌                 | 73/160 [00:02<00:02, 38.39it/s]predict:  48%|███████████████▍                | 77/160 [00:02<00:02, 38.50it/s]predict:  51%|████████████████▏               | 81/160 [00:02<00:02, 38.55it/s]predict:  53%|█████████████████               | 85/160 [00:02<00:01, 38.43it/s]predict:  56%|█████████████████▊              | 89/160 [00:02<00:01, 38.39it/s]predict:  58%|██████████████████▌             | 93/160 [00:02<00:01, 38.40it/s]predict:  61%|███████████████████▍            | 97/160 [00:02<00:01, 38.31it/s]predict:  63%|███████████████████▌           | 101/160 [00:02<00:01, 38.29it/s]predict:  66%|████████████████████▎          | 105/160 [00:02<00:01, 38.28it/s]predict:  68%|█████████████████████          | 109/160 [00:02<00:01, 38.17it/s]predict:  71%|█████████████████████▉         | 113/160 [00:03<00:01, 38.25it/s]predict:  73%|██████████████████████▋        | 117/160 [00:03<00:01, 38.25it/s]predict:  76%|███████████████████████▍       | 121/160 [00:03<00:01, 38.28it/s]predict:  78%|████████████████████████▏      | 125/160 [00:03<00:00, 38.38it/s]predict:  81%|████████████████████████▉      | 129/160 [00:03<00:00, 38.38it/s]predict:  83%|█████████████████████████▊     | 133/160 [00:03<00:00, 38.43it/s]predict:  86%|██████████████████████████▌    | 137/160 [00:03<00:00, 38.49it/s]predict:  88%|███████████████████████████▎   | 141/160 [00:03<00:00, 38.48it/s]predict:  91%|████████████████████████████   | 145/160 [00:03<00:00, 38.49it/s]predict:  93%|████████████████████████████▊  | 149/160 [00:04<00:00, 38.52it/s]predict:  96%|█████████████████████████████▋ | 153/160 [00:04<00:00, 38.64it/s]predict:  98%|██████████████████████████████▍| 157/160 [00:04<00:00, 38.54it/s]predict: 100%|███████████████████████████████| 160/160 [00:04<00:00, 37.13it/s]
size restored (330, 522, 522)
Saved slices and power spectrum for epoch 4 to 'denoise'
training tomograms for 2 epochs, remaining epochs 2
Epoch 1:   0%|                                       | 0/13 [00:00<?, ?batch/s]Epoch 1:   0%| | 0/13 [00:19<?, ?batch/s, Loss: 1.9448 | in_mw_loss: 1.9448 | oEpoch 1:   8%| | 1/13 [00:19<03:55, 19.66s/batch, Loss: 1.9448 | in_mw_loss: 1.Epoch 1:   8%| | 1/13 [00:19<03:55, 19.66s/batch, Loss: 1.5866 | in_mw_loss: 1.Epoch 1:  15%|▏| 2/13 [00:19<01:29,  8.17s/batch, Loss: 1.5866 | in_mw_loss: 1.Epoch 1:  15%|▏| 2/13 [00:19<01:29,  8.17s/batch, Loss: 1.3852 | in_mw_loss: 1.Epoch 1:  23%|▏| 3/13 [00:19<00:45,  4.50s/batch, Loss: 1.3852 | in_mw_loss: 1.Epoch 1:  23%|▏| 3/13 [00:20<00:45,  4.50s/batch, Loss: 1.2551 | in_mw_loss: 1.Epoch 1:  31%|▎| 4/13 [00:20<00:25,  2.78s/batch, Loss: 1.2551 | in_mw_loss: 1.Epoch 1:  31%|▎| 4/13 [00:20<00:25,  2.78s/batch, Loss: 1.1588 | in_mw_loss: 1.Epoch 1:  38%|▍| 5/13 [00:20<00:14,  1.82s/batch, Loss: 1.1588 | in_mw_loss: 1.Epoch 1:  38%|▍| 5/13 [00:20<00:14,  1.82s/batch, Loss: 1.2911 | in_mw_loss: 1.Epoch 1:  46%|▍| 6/13 [00:20<00:08,  1.25s/batch, Loss: 1.2911 | in_mw_loss: 1.Epoch 1:  46%|▍| 6/13 [00:20<00:08,  1.25s/batch, Loss: 1.0801 | in_mw_loss: 1.Epoch 1:  54%|▌| 7/13 [00:20<00:05,  1.13batch/s, Loss: 1.0801 | in_mw_loss: 1.Epoch 1:  54%|▌| 7/13 [00:20<00:05,  1.13batch/s, Loss: 1.1270 | in_mw_loss: 1.Epoch 1:  62%|▌| 8/13 [00:20<00:03,  1.56batch/s, Loss: 1.1270 | in_mw_loss: 1.Epoch 1:  62%|▌| 8/13 [00:20<00:03,  1.56batch/s, Loss: 1.1213 | in_mw_loss: 1.Epoch 1:  69%|▋| 9/13 [00:20<00:01,  2.08batch/s, Loss: 1.1213 | in_mw_loss: 1.Epoch 1:  69%|▋| 9/13 [00:20<00:01,  2.08batch/s, Loss: 1.1706 | in_mw_loss: 1.Epoch 1:  77%|▊| 10/13 [00:20<00:01,  2.68batch/s, Loss: 1.1706 | in_mw_loss: 1Epoch 1:  77%|▊| 10/13 [00:20<00:01,  2.68batch/s, Loss: 1.1994 | in_mw_loss: 1Epoch 1:  85%|▊| 11/13 [00:20<00:00,  3.34batch/s, Loss: 1.1994 | in_mw_loss: 1Epoch 1:  85%|▊| 11/13 [00:21<00:00,  3.34batch/s, Loss: 1.0787 | in_mw_loss: 1Epoch 1:  92%|▉| 12/13 [00:21<00:00,  4.05batch/s, Loss: 1.0787 | in_mw_loss: 1Epoch 1:  92%|▉| 12/13 [00:21<00:00,  4.05batch/s, Loss: 1.0882 | in_mw_loss: 1Epoch 1: 100%|█| 13/13 [00:21<00:00,  4.85batch/s, Loss: 1.0882 | in_mw_loss: 1Epoch 1: 100%|█| 13/13 [00:21<00:00,  1.63s/batch, Loss: 1.0882 | in_mw_loss: 1
Epoch [  1/  2], Loss: 1.2864, in_mw_loss: 1.2864, out_mw_loss: 1.2864, learning_rate: 3.0000e-04
Epoch 2:   0%|                                       | 0/13 [00:00<?, ?batch/s]Epoch 2:   0%| | 0/13 [00:00<?, ?batch/s, Loss: 1.1428 | in_mw_loss: 1.1428 | oEpoch 2:   8%| | 1/13 [00:00<00:02,  4.41batch/s, Loss: 1.1428 | in_mw_loss: 1.Epoch 2:   8%| | 1/13 [00:00<00:02,  4.41batch/s, Loss: 1.0616 | in_mw_loss: 1.Epoch 2:  15%|▏| 2/13 [00:00<00:01,  5.93batch/s, Loss: 1.0616 | in_mw_loss: 1.Epoch 2:  15%|▏| 2/13 [00:00<00:01,  5.93batch/s, Loss: 1.1248 | in_mw_loss: 1.Epoch 2:  23%|▏| 3/13 [00:00<00:01,  6.62batch/s, Loss: 1.1248 | in_mw_loss: 1.Epoch 2:  23%|▏| 3/13 [00:00<00:01,  6.62batch/s, Loss: 1.1403 | in_mw_loss: 1.Epoch 2:  31%|▎| 4/13 [00:00<00:01,  6.99batch/s, Loss: 1.1403 | in_mw_loss: 1.Epoch 2:  31%|▎| 4/13 [00:00<00:01,  6.99batch/s, Loss: 1.0718 | in_mw_loss: 1.Epoch 2:  38%|▍| 5/13 [00:00<00:01,  7.21batch/s, Loss: 1.0718 | in_mw_loss: 1.Epoch 2:  38%|▍| 5/13 [00:00<00:01,  7.21batch/s, Loss: 1.1375 | in_mw_loss: 1.Epoch 2:  46%|▍| 6/13 [00:00<00:00,  7.38batch/s, Loss: 1.1375 | in_mw_loss: 1.Epoch 2:  46%|▍| 6/13 [00:01<00:00,  7.38batch/s, Loss: 1.1249 | in_mw_loss: 1.Epoch 2:  54%|▌| 7/13 [00:01<00:00,  7.47batch/s, Loss: 1.1249 | in_mw_loss: 1.Epoch 2:  54%|▌| 7/13 [00:01<00:00,  7.47batch/s, Loss: 1.0281 | in_mw_loss: 1.Epoch 2:  62%|▌| 8/13 [00:01<00:00,  7.54batch/s, Loss: 1.0281 | in_mw_loss: 1.Epoch 2:  62%|▌| 8/13 [00:01<00:00,  7.54batch/s, Loss: 1.0625 | in_mw_loss: 1.Epoch 2:  69%|▋| 9/13 [00:01<00:00,  7.57batch/s, Loss: 1.0625 | in_mw_loss: 1.Epoch 2:  69%|▋| 9/13 [00:01<00:00,  7.57batch/s, Loss: 1.0123 | in_mw_loss: 1.Epoch 2:  77%|▊| 10/13 [00:01<00:00,  7.57batch/s, Loss: 1.0123 | in_mw_loss: 1Epoch 2:  77%|▊| 10/13 [00:01<00:00,  7.57batch/s, Loss: 1.0131 | in_mw_loss: 1Epoch 2:  85%|▊| 11/13 [00:01<00:00,  7.60batch/s, Loss: 1.0131 | in_mw_loss: 1Epoch 2:  85%|▊| 11/13 [00:01<00:00,  7.60batch/s, Loss: 1.0560 | in_mw_loss: 1Epoch 2:  92%|▉| 12/13 [00:01<00:00,  7.51batch/s, Loss: 1.0560 | in_mw_loss: 1Epoch 2:  92%|▉| 12/13 [00:01<00:00,  7.51batch/s, Loss: 1.0004 | in_mw_loss: 1Epoch 2: 100%|█| 13/13 [00:01<00:00,  7.43batch/s, Loss: 1.0004 | in_mw_loss: 1
Epoch [  2/  2], Loss: 1.0684, in_mw_loss: 1.0684, out_mw_loss: 1.0684, learning_rate: 3.0000e-04
data_shape torch.Size([320, 1, 96, 96, 96])
predict:   0%|                                         | 0/160 [00:00<?, ?it/s]predict:   1%|▏                                | 1/160 [00:00<00:23,  6.70it/s]predict:   3%|█                                | 5/160 [00:00<00:06, 22.25it/s]predict:   6%|█▊                               | 9/160 [00:00<00:05, 28.94it/s]predict:   8%|██▌                             | 13/160 [00:00<00:04, 32.55it/s]predict:  11%|███▍                            | 17/160 [00:00<00:04, 34.59it/s]predict:  13%|████▏                           | 21/160 [00:00<00:03, 35.92it/s]predict:  16%|█████                           | 25/160 [00:00<00:03, 36.48it/s]predict:  18%|█████▊                          | 29/160 [00:00<00:03, 37.00it/s]predict:  21%|██████▌                         | 33/160 [00:00<00:03, 37.50it/s]predict:  23%|███████▍                        | 37/160 [00:01<00:03, 37.89it/s]predict:  26%|████████▏                       | 41/160 [00:01<00:03, 38.24it/s]predict:  28%|█████████                       | 45/160 [00:01<00:02, 38.49it/s]predict:  31%|█████████▊                      | 49/160 [00:01<00:02, 38.66it/s]predict:  33%|██████████▌                     | 53/160 [00:01<00:02, 38.86it/s]predict:  36%|███████████▍                    | 57/160 [00:01<00:02, 38.97it/s]predict:  38%|████████████▏                   | 61/160 [00:01<00:02, 39.05it/s]predict:  41%|█████████████                   | 65/160 [00:01<00:02, 38.70it/s]predict:  43%|█████████████▊                  | 69/160 [00:01<00:02, 38.60it/s]predict:  46%|██████████████▌                 | 73/160 [00:02<00:02, 38.59it/s]predict:  48%|███████████████▍                | 77/160 [00:02<00:02, 38.40it/s]predict:  51%|████████████████▏               | 81/160 [00:02<00:02, 38.26it/s]predict:  53%|█████████████████               | 85/160 [00:02<00:01, 38.14it/s]predict:  56%|█████████████████▊              | 89/160 [00:02<00:01, 38.26it/s]predict:  58%|██████████████████▌             | 93/160 [00:02<00:01, 38.46it/s]predict:  61%|███████████████████▍            | 97/160 [00:02<00:01, 38.71it/s]predict:  63%|███████████████████▌           | 101/160 [00:02<00:01, 38.65it/s]predict:  66%|████████████████████▎          | 105/160 [00:02<00:01, 38.50it/s]predict:  68%|█████████████████████          | 109/160 [00:02<00:01, 38.62it/s]predict:  71%|█████████████████████▉         | 113/160 [00:03<00:01, 38.62it/s]predict:  73%|██████████████████████▋        | 117/160 [00:03<00:01, 38.69it/s]predict:  76%|███████████████████████▍       | 121/160 [00:03<00:01, 38.54it/s]predict:  78%|████████████████████████▏      | 125/160 [00:03<00:00, 38.26it/s]predict:  81%|████████████████████████▉      | 129/160 [00:03<00:00, 38.43it/s]predict:  83%|█████████████████████████▊     | 133/160 [00:03<00:00, 38.61it/s]predict:  86%|██████████████████████████▌    | 137/160 [00:03<00:00, 38.78it/s]predict:  88%|███████████████████████████▎   | 141/160 [00:03<00:00, 38.72it/s]predict:  91%|████████████████████████████   | 145/160 [00:03<00:00, 38.46it/s]predict:  93%|████████████████████████████▊  | 149/160 [00:03<00:00, 38.47it/s]predict:  96%|█████████████████████████████▋ | 153/160 [00:04<00:00, 38.61it/s]predict:  98%|██████████████████████████████▍| 157/160 [00:04<00:00, 38.52it/s]predict: 100%|███████████████████████████████| 160/160 [00:04<00:00, 37.43it/s]
07-19 12:31:37, INFO     Port number: 50219
07-19 12:31:37, INFO     Port number: 34897
size restored (330, 522, 522)
Saved slices and power spectrum for epoch 6 to 'denoise'
denoise/network_n2n_unet-medium_96_full.pt
Total number of parameters: 23989825
denoise/network_n2n_unet-medium_96_full.pt
Total number of parameters: 23989825
Predict:   0%|          | 0/5 [00:00<?, ?it/s]/home/cii/software/IsoApp/tomograms_wbp/EVN/TS_01_EVN_wbp-b2.mrc
data_shape torch.Size([320, 1, 96, 96, 96])
predict:   0%|                                         | 0/160 [00:00<?, ?it/s]predict:   1%|▏                                | 1/160 [00:00<00:24,  6.37it/s]predict:   3%|█                                | 5/160 [00:00<00:07, 21.93it/s]predict:   6%|█▊                               | 9/160 [00:00<00:05, 28.42it/s]predict:   8%|██▌                             | 13/160 [00:00<00:04, 31.57it/s]predict:  11%|███▍                            | 17/160 [00:00<00:04, 33.81it/s]predict:  13%|████▏                           | 21/160 [00:00<00:03, 35.21it/s]predict:  16%|█████                           | 25/160 [00:00<00:03, 36.20it/s]predict:  18%|█████▊                          | 29/160 [00:00<00:03, 36.69it/s]predict:  21%|██████▌                         | 33/160 [00:01<00:03, 37.21it/s]predict:  23%|███████▍                        | 37/160 [00:01<00:03, 37.67it/s]predict:  26%|████████▏                       | 41/160 [00:01<00:03, 37.92it/s]predict:  28%|█████████                       | 45/160 [00:01<00:03, 37.71it/s]predict:  31%|█████████▊                      | 49/160 [00:01<00:02, 37.69it/s]predict:  33%|██████████▌                     | 53/160 [00:01<00:02, 37.47it/s]predict:  36%|███████████▍                    | 57/160 [00:01<00:02, 37.57it/s]predict:  38%|████████████▏                   | 61/160 [00:01<00:02, 37.63it/s]predict:  41%|█████████████                   | 65/160 [00:01<00:02, 37.98it/s]predict:  43%|█████████████▊                  | 69/160 [00:01<00:02, 38.01it/s]predict:  46%|██████████████▌                 | 73/160 [00:02<00:02, 38.02it/s]predict:  48%|███████████████▍                | 77/160 [00:02<00:02, 37.68it/s]predict:  51%|████████████████▏               | 81/160 [00:02<00:02, 37.78it/s]predict:  53%|█████████████████               | 85/160 [00:02<00:01, 37.70it/s]predict:  56%|█████████████████▊              | 89/160 [00:02<00:01, 37.67it/s]predict:  58%|██████████████████▌             | 93/160 [00:02<00:01, 37.83it/s]predict:  61%|███████████████████▍            | 97/160 [00:02<00:01, 37.75it/s]predict:  63%|███████████████████▌           | 101/160 [00:02<00:01, 37.90it/s]predict:  66%|████████████████████▎          | 105/160 [00:02<00:01, 38.04it/s]predict:  68%|█████████████████████          | 109/160 [00:03<00:01, 38.14it/s]predict:  71%|█████████████████████▉         | 113/160 [00:03<00:01, 38.00it/s]predict:  73%|██████████████████████▋        | 117/160 [00:03<00:01, 37.98it/s]predict:  76%|███████████████████████▍       | 121/160 [00:03<00:01, 37.89it/s]predict:  78%|████████████████████████▏      | 125/160 [00:03<00:00, 37.77it/s]predict:  81%|████████████████████████▉      | 129/160 [00:03<00:00, 37.94it/s]predict:  83%|█████████████████████████▊     | 133/160 [00:03<00:00, 37.94it/s]predict:  86%|██████████████████████████▌    | 137/160 [00:03<00:00, 38.09it/s]predict:  88%|███████████████████████████▎   | 141/160 [00:03<00:00, 38.40it/s]predict:  91%|████████████████████████████   | 145/160 [00:03<00:00, 38.37it/s]predict:  93%|████████████████████████████▊  | 149/160 [00:04<00:00, 38.54it/s]predict:  96%|█████████████████████████████▋ | 153/160 [00:04<00:00, 38.27it/s]predict:  98%|██████████████████████████████▍| 157/160 [00:04<00:00, 38.40it/s]predict: 100%|███████████████████████████████| 160/160 [00:04<00:00, 36.86it/s]
size restored (330, 522, 522)
/home/cii/software/IsoApp/tomograms_wbp/ODD/TS_01_ODD_wbp-b2.mrc
data_shape torch.Size([320, 1, 96, 96, 96])
predict:   0%|                                         | 0/160 [00:00<?, ?it/s]predict:   1%|▏                                | 1/160 [00:00<00:23,  6.66it/s]predict:   3%|█                                | 5/160 [00:00<00:06, 22.27it/s]predict:   6%|█▊                               | 9/160 [00:00<00:05, 28.66it/s]predict:   8%|██▌                             | 13/160 [00:00<00:04, 32.24it/s]predict:  11%|███▍                            | 17/160 [00:00<00:04, 34.44it/s]predict:  13%|████▏                           | 21/160 [00:00<00:03, 35.66it/s]predict:  16%|█████                           | 25/160 [00:00<00:03, 35.53it/s]predict:  18%|█████▊                          | 29/160 [00:00<00:03, 35.80it/s]predict:  21%|██████▌                         | 33/160 [00:01<00:03, 36.03it/s]predict:  23%|███████▍                        | 37/160 [00:01<00:03, 36.52it/s]predict:  26%|████████▏                       | 41/160 [00:01<00:03, 36.88it/s]predict:  28%|█████████                       | 45/160 [00:01<00:03, 36.88it/s]predict:  31%|█████████▊                      | 49/160 [00:01<00:03, 36.67it/s]predict:  33%|██████████▌                     | 53/160 [00:01<00:02, 37.28it/s]predict:  36%|███████████▍                    | 57/160 [00:01<00:02, 37.40it/s]predict:  38%|████████████▏                   | 61/160 [00:01<00:02, 37.83it/s]predict:  41%|█████████████                   | 65/160 [00:01<00:02, 37.85it/s]predict:  43%|█████████████▊                  | 69/160 [00:01<00:02, 38.03it/s]predict:  46%|██████████████▌                 | 73/160 [00:02<00:02, 37.91it/s]predict:  48%|███████████████▍                | 77/160 [00:02<00:02, 37.92it/s]predict:  51%|████████████████▏               | 81/160 [00:02<00:02, 37.41it/s]predict:  53%|█████████████████               | 85/160 [00:02<00:02, 37.48it/s]predict:  56%|█████████████████▊              | 89/160 [00:02<00:01, 37.86it/s]predict:  58%|██████████████████▌             | 93/160 [00:02<00:01, 37.82it/s]predict:  61%|███████████████████▍            | 97/160 [00:02<00:01, 37.80it/s]predict:  63%|███████████████████▌           | 101/160 [00:02<00:01, 38.03it/s]predict:  66%|████████████████████▎          | 105/160 [00:02<00:01, 38.10it/s]predict:  68%|█████████████████████          | 109/160 [00:03<00:01, 37.93it/s]predict:  71%|█████████████████████▉         | 113/160 [00:03<00:01, 37.95it/s]predict:  73%|██████████████████████▋        | 117/160 [00:03<00:01, 38.01it/s]predict:  76%|███████████████████████▍       | 121/160 [00:03<00:01, 38.05it/s]predict:  78%|████████████████████████▏      | 125/160 [00:03<00:00, 38.22it/s]predict:  81%|████████████████████████▉      | 129/160 [00:03<00:00, 38.17it/s]predict:  83%|█████████████████████████▊     | 133/160 [00:03<00:00, 38.24it/s]predict:  86%|██████████████████████████▌    | 137/160 [00:03<00:00, 38.18it/s]predict:  88%|███████████████████████████▎   | 141/160 [00:03<00:00, 38.38it/s]predict:  91%|████████████████████████████   | 145/160 [00:03<00:00, 38.51it/s]predict:  93%|████████████████████████████▊  | 149/160 [00:04<00:00, 38.21it/s]predict:  96%|█████████████████████████████▋ | 153/160 [00:04<00:00, 37.85it/s]predict:  98%|██████████████████████████████▍| 157/160 [00:04<00:00, 37.76it/s]predict: 100%|███████████████████████████████| 160/160 [00:04<00:00, 36.70it/s]
07-19 12:32:12, INFO     Predicted ['/home/cii/software/IsoApp/tomograms_wbp/EVN/TS_01_EVN_wbp-b2.mrc', '/home/cii/software/IsoApp/tomograms_wbp/ODD/TS_01_ODD_wbp-b2.mrc'] → denoise/corrected_n2n_unet-medium_TS_01_EVN_wbp-b2.mrc
Predict:  20%|██        | 1/5 [00:35<02:22, 35.58s/it]size restored (330, 522, 522)
/home/cii/software/IsoApp/tomograms_wbp/EVN/TS_03_EVN_wbp-b2.mrc
data_shape torch.Size([320, 1, 96, 96, 96])
predict:   0%|                                         | 0/160 [00:00<?, ?it/s]predict:   1%|▏                                | 1/160 [00:00<00:25,  6.32it/s]predict:   3%|█                                | 5/160 [00:00<00:07, 21.66it/s]predict:   6%|█▊                               | 9/160 [00:00<00:05, 28.20it/s]predict:   8%|██▌                             | 13/160 [00:00<00:04, 31.86it/s]predict:  11%|███▍                            | 17/160 [00:00<00:04, 34.29it/s]predict:  13%|████▏                           | 21/160 [00:00<00:03, 35.60it/s]predict:  16%|█████                           | 25/160 [00:00<00:03, 36.45it/s]predict:  18%|█████▊                          | 29/160 [00:00<00:03, 36.93it/s]predict:  21%|██████▌                         | 33/160 [00:00<00:03, 37.16it/s]predict:  23%|███████▍                        | 37/160 [00:01<00:03, 37.69it/s]predict:  26%|████████▏                       | 41/160 [00:01<00:03, 37.79it/s]predict:  28%|█████████                       | 45/160 [00:01<00:03, 37.98it/s]predict:  31%|█████████▊                      | 49/160 [00:01<00:02, 38.05it/s]predict:  33%|██████████▌                     | 53/160 [00:01<00:02, 38.13it/s]predict:  36%|███████████▍                    | 57/160 [00:01<00:02, 37.77it/s]predict:  38%|████████████▏                   | 61/160 [00:01<00:02, 37.61it/s]predict:  41%|█████████████                   | 65/160 [00:01<00:02, 37.54it/s]predict:  43%|█████████████▊                  | 69/160 [00:01<00:02, 37.45it/s]predict:  46%|██████████████▌                 | 73/160 [00:02<00:02, 37.36it/s]predict:  48%|███████████████▍                | 77/160 [00:02<00:02, 37.63it/s]predict:  51%|████████████████▏               | 81/160 [00:02<00:02, 37.67it/s]predict:  53%|█████████████████               | 85/160 [00:02<00:01, 37.72it/s]predict:  56%|█████████████████▊              | 89/160 [00:02<00:01, 37.32it/s]predict:  58%|██████████████████▌             | 93/160 [00:02<00:01, 37.59it/s]predict:  61%|███████████████████▍            | 97/160 [00:02<00:01, 37.81it/s]predict:  63%|███████████████████▌           | 101/160 [00:02<00:01, 37.97it/s]predict:  66%|████████████████████▎          | 105/160 [00:02<00:01, 38.11it/s]predict:  68%|█████████████████████          | 109/160 [00:03<00:01, 38.06it/s]predict:  71%|█████████████████████▉         | 113/160 [00:03<00:01, 37.84it/s]predict:  73%|██████████████████████▋        | 117/160 [00:03<00:01, 37.76it/s]predict:  76%|███████████████████████▍       | 121/160 [00:03<00:01, 37.71it/s]predict:  78%|████████████████████████▏      | 125/160 [00:03<00:00, 37.61it/s]predict:  81%|████████████████████████▉      | 129/160 [00:03<00:00, 37.85it/s]predict:  83%|█████████████████████████▊     | 133/160 [00:03<00:00, 37.52it/s]predict:  86%|██████████████████████████▌    | 137/160 [00:03<00:00, 37.43it/s]predict:  88%|███████████████████████████▎   | 141/160 [00:03<00:00, 37.73it/s]predict:  91%|████████████████████████████   | 145/160 [00:03<00:00, 37.61it/s]predict:  93%|████████████████████████████▊  | 149/160 [00:04<00:00, 37.60it/s]predict:  96%|█████████████████████████████▋ | 153/160 [00:04<00:00, 37.55it/s]predict:  98%|██████████████████████████████▍| 157/160 [00:04<00:00, 37.56it/s]predict: 100%|███████████████████████████████| 160/160 [00:04<00:00, 36.66it/s]
size restored (330, 522, 522)
/home/cii/software/IsoApp/tomograms_wbp/ODD/TS_03_ODD_wbp-b2.mrc
data_shape torch.Size([320, 1, 96, 96, 96])
predict:   0%|                                         | 0/160 [00:00<?, ?it/s]predict:   1%|▏                                | 1/160 [00:00<00:24,  6.49it/s]predict:   3%|█                                | 5/160 [00:00<00:06, 22.28it/s]predict:   6%|█▊                               | 9/160 [00:00<00:05, 28.91it/s]predict:   8%|██▌                             | 13/160 [00:00<00:04, 32.22it/s]predict:  11%|███▍                            | 17/160 [00:00<00:04, 34.13it/s]predict:  13%|████▏                           | 21/160 [00:00<00:03, 35.65it/s]predict:  16%|█████                           | 25/160 [00:00<00:03, 36.81it/s]predict:  18%|█████▊                          | 29/160 [00:00<00:03, 37.30it/s]predict:  21%|██████▌                         | 33/160 [00:00<00:03, 37.74it/s]predict:  23%|███████▍                        | 37/160 [00:01<00:03, 38.02it/s]predict:  26%|████████▏                       | 41/160 [00:01<00:03, 38.39it/s]predict:  28%|█████████                       | 45/160 [00:01<00:02, 38.41it/s]predict:  31%|█████████▊                      | 49/160 [00:01<00:02, 38.37it/s]predict:  33%|██████████▌                     | 53/160 [00:01<00:02, 38.18it/s]predict:  36%|███████████▍                    | 57/160 [00:01<00:02, 37.89it/s]predict:  38%|████████████▏                   | 61/160 [00:01<00:02, 37.76it/s]predict:  41%|█████████████                   | 65/160 [00:01<00:02, 37.83it/s]predict:  43%|█████████████▊                  | 69/160 [00:01<00:02, 37.85it/s]predict:  46%|██████████████▌                 | 73/160 [00:02<00:02, 37.98it/s]predict:  48%|███████████████▍                | 77/160 [00:02<00:02, 38.08it/s]predict:  51%|████████████████▏               | 81/160 [00:02<00:02, 38.11it/s]predict:  53%|█████████████████               | 85/160 [00:02<00:01, 38.13it/s]predict:  56%|█████████████████▊              | 89/160 [00:02<00:01, 38.02it/s]predict:  58%|██████████████████▌             | 93/160 [00:02<00:01, 37.71it/s]predict:  61%|███████████████████▍            | 97/160 [00:02<00:01, 37.91it/s]predict:  63%|███████████████████▌           | 101/160 [00:02<00:01, 38.20it/s]predict:  66%|████████████████████▎          | 105/160 [00:02<00:01, 38.23it/s]predict:  68%|█████████████████████          | 109/160 [00:02<00:01, 38.22it/s]predict:  71%|█████████████████████▉         | 113/160 [00:03<00:01, 38.21it/s]predict:  73%|██████████████████████▋        | 117/160 [00:03<00:01, 38.41it/s]predict:  76%|███████████████████████▍       | 121/160 [00:03<00:01, 38.39it/s]predict:  78%|████████████████████████▏      | 125/160 [00:03<00:00, 38.34it/s]predict:  81%|████████████████████████▉      | 129/160 [00:03<00:00, 38.53it/s]predict:  83%|█████████████████████████▊     | 133/160 [00:03<00:00, 38.55it/s]predict:  86%|██████████████████████████▌    | 137/160 [00:03<00:00, 38.42it/s]predict:  88%|███████████████████████████▎   | 141/160 [00:03<00:00, 38.56it/s]predict:  91%|████████████████████████████   | 145/160 [00:03<00:00, 38.61it/s]predict:  93%|████████████████████████████▊  | 149/160 [00:04<00:00, 38.26it/s]predict:  96%|█████████████████████████████▋ | 153/160 [00:04<00:00, 38.32it/s]predict:  98%|██████████████████████████████▍| 157/160 [00:04<00:00, 38.49it/s]predict: 100%|███████████████████████████████| 160/160 [00:04<00:00, 37.17it/s]
Predict:  20%|██        | 1/5 [01:10<04:43, 70.83s/it]
size restored (330, 522, 522)
Traceback (most recent call last):
  File "/home/cii/software/IsoNet2/IsoNet/bin/isonet.py", line 1080, in <module>
    exit(main())
         ~~~~^^
  File "/home/cii/software/IsoNet2/IsoNet/bin/isonet.py", line 1076, in main
    fire.Fire(ISONET)
    ~~~~~~~~~^^^^^^^^
  File "/home/cii/anaconda3/envs/torch_cuda12.6_glados_py3.13/lib/python3.13/site-packages/fire/core.py", line 135, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/home/cii/anaconda3/envs/torch_cuda12.6_glados_py3.13/lib/python3.13/site-packages/fire/core.py", line 468, in _Fire
    component, remaining_args = _CallAndUpdateTrace(
                                ~~~~~~~~~~~~~~~~~~~^
        component,
        ^^^^^^^^^^
    ...<2 lines>...
        treatment='class' if is_class else 'routine',
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        target=component.__name__)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/cii/anaconda3/envs/torch_cuda12.6_glados_py3.13/lib/python3.13/site-packages/fire/core.py", line 684, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "/home/cii/software/IsoNet2/IsoNet/bin/isonet.py", line 620, in denoise
    self.predict(star_file=star_file, model=model_file, output_dir=output_dir, gpuID=gpuID, \
    ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
                 correct_CTF=correct_CTF,isCTFflipped=isCTFflipped)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/cii/software/IsoNet2/IsoNet/bin/isonet.py", line 396, in predict
    process_tomograms(
    ~~~~~~~~~~~~~~~~~^
        star_path=star_file,
        ^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
        row_processor=predict_row
        ^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/cii/software/IsoNet2/IsoNet/utils/utils.py", line 15, in process_tomograms
    row_processor(i, row, new_star)
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/cii/software/IsoNet2/IsoNet/bin/isonet.py", line 378, in predict_row
    out_data.append(network.predict_map(
                    ~~~~~~~~~~~~~~~~~~~^
        tomo_vol, output_dir,
        ^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        F_mask=F_mask
        ^^^^^^^^^^^^^
    ))
    ^
  File "/home/cii/software/IsoNet2/IsoNet/models/network.py", line 333, in predict_map
    outData=reform_ins.restore(outData)
  File "/home/cii/software/IsoNet2/IsoNet/utils/toTile.py", line 87, in restore
    restored[i*self.cubesize:(i+1)*self.cubesize+self.edge_depth*2,
    ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        j*self.cubesize:(j+1)*self.cubesize+self.edge_depth*2,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        k*self.cubesize:(k+1)*self.cubesize+self.edge_depth*2] \
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
Process exited with code null
